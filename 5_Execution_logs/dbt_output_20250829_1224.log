[0m17:27:20.431762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1186fb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a3279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a327b10>]}


============================== 17:27:20.434143 | f66b76d9-a7d9-451b-9662-d7a4d248e4f4 ==============================
[0m17:27:20.434143 [info ] [MainThread]: Running with dbt=1.10.9
[0m17:27:20.434374 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'target_path': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select tag:allianz_dbt_assignment', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'profiles_dir': '/Users/vijaypalanichamy/.dbt', 'fail_fast': 'False', 'static_parser': 'True', 'warn_error': 'None', 'log_path': '/Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'log_format': 'default', 'no_print': 'None', 'printer_width': '80', 'write_json': 'True', 'partial_parse': 'True'}
[0m17:27:20.646157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11923f230>]}
[0m17:27:20.665181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cdef9b0>]}
[0m17:27:20.665622 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:27:20.706374 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m17:27:20.706706 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:27:20.706950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ce98850>]}
[0m17:27:21.166276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d2b54f0>]}
[0m17:27:21.198444 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/manifest.json
[0m17:27:21.199440 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/semantic_manifest.json
[0m17:27:21.209632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d348e50>]}
[0m17:27:21.209795 [info ] [MainThread]: Found 15 models, 32 data tests, 3 sources, 479 macros
[0m17:27:21.209913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e56fee0>]}
[0m17:27:21.210709 [info ] [MainThread]: 
[0m17:27:21.210839 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:27:21.210927 [info ] [MainThread]: 
[0m17:27:21.211093 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:27:21.212759 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_allianz'
[0m17:27:21.236234 [debug] [ThreadPool]: Using snowflake connection "list_allianz"
[0m17:27:21.236410 [debug] [ThreadPool]: On list_allianz: show terse schemas in database allianz
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz"} */
[0m17:27:21.236498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:23.817444 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.581 seconds
[0m17:27:23.819699 [debug] [ThreadPool]: On list_allianz: Close
[0m17:27:23.903632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_allianz, now list_allianz_stage)
[0m17:27:23.904480 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_allianz_datavault'
[0m17:27:23.920471 [debug] [ThreadPool]: Using snowflake connection "list_allianz_datavault"
[0m17:27:23.922332 [debug] [ThreadPool]: Using snowflake connection "list_allianz_stage"
[0m17:27:23.922589 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_allianz_validation'
[0m17:27:23.922741 [debug] [ThreadPool]: On list_allianz_datavault: show objects in allianz.datavault
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz_datavault"} */;
[0m17:27:23.922979 [debug] [ThreadPool]: On list_allianz_stage: show objects in allianz.stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz_stage"} */;
[0m17:27:23.924472 [debug] [ThreadPool]: Using snowflake connection "list_allianz_validation"
[0m17:27:23.924701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:23.924895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:27:23.925082 [debug] [ThreadPool]: On list_allianz_validation: show objects in allianz.validation
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz_validation"} */;
[0m17:27:23.925785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:26.265911 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.340 seconds
[0m17:27:26.266669 [debug] [ThreadPool]: On list_allianz_validation: Close
[0m17:27:26.416689 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 2.492 seconds
[0m17:27:26.418222 [debug] [ThreadPool]: On list_allianz_datavault: Close
[0m17:27:26.570366 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.645 seconds
[0m17:27:26.573262 [debug] [ThreadPool]: On list_allianz_stage: Close
[0m17:27:26.661992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e5d9010>]}
[0m17:27:26.667452 [debug] [Thread-6 (]: Began running node model.dbt_project.sat_product_discount_v0
[0m17:27:26.667906 [debug] [Thread-3 (]: Began running node model.dbt_project.sat_customer_v0
[0m17:27:26.668236 [debug] [Thread-4 (]: Began running node model.dbt_project.sat_orders_v0
[0m17:27:26.668538 [debug] [Thread-5 (]: Began running node model.dbt_project.sat_product_category_v0
[0m17:27:26.668847 [debug] [Thread-7 (]: Began running node model.dbt_project.sat_product_v0
[0m17:27:26.669131 [debug] [Thread-1 (]: Began running node model.dbt_project.sat_customer_profession_v0
[0m17:27:26.669383 [debug] [Thread-2 (]: Began running node model.dbt_project.sat_customer_spending_v0
[0m17:27:26.669909 [info ] [Thread-6 (]: 6 of 10 START sql incremental model datavault.sat_product_discount_v0 .......... [RUN]
[0m17:27:26.670353 [info ] [Thread-3 (]: 3 of 10 START sql incremental model datavault.sat_customer_v0 .................. [RUN]
[0m17:27:26.670769 [info ] [Thread-4 (]: 4 of 10 START sql incremental model datavault.sat_orders_v0 .................... [RUN]
[0m17:27:26.671127 [info ] [Thread-5 (]: 5 of 10 START sql incremental model datavault.sat_product_category_v0 .......... [RUN]
[0m17:27:26.671482 [info ] [Thread-7 (]: 7 of 10 START sql incremental model datavault.sat_product_v0 ................... [RUN]
[0m17:27:26.671901 [info ] [Thread-1 (]: 1 of 10 START sql incremental model datavault.sat_customer_profession_v0 ....... [RUN]
[0m17:27:26.672297 [info ] [Thread-2 (]: 2 of 10 START sql incremental model datavault.sat_customer_spending_v0 ......... [RUN]
[0m17:27:26.672797 [debug] [Thread-6 (]: Acquiring new snowflake connection 'model.dbt_project.sat_product_discount_v0'
[0m17:27:26.673127 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_allianz_validation, now model.dbt_project.sat_customer_v0)
[0m17:27:26.673437 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_project.sat_orders_v0'
[0m17:27:26.673784 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.dbt_project.sat_product_category_v0'
[0m17:27:26.674081 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.dbt_project.sat_product_v0'
[0m17:27:26.674308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_allianz_stage, now model.dbt_project.sat_customer_profession_v0)
[0m17:27:26.674531 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_allianz_datavault, now model.dbt_project.sat_customer_spending_v0)
[0m17:27:26.674786 [debug] [Thread-6 (]: Began compiling node model.dbt_project.sat_product_discount_v0
[0m17:27:26.675097 [debug] [Thread-3 (]: Began compiling node model.dbt_project.sat_customer_v0
[0m17:27:26.675562 [debug] [Thread-4 (]: Began compiling node model.dbt_project.sat_orders_v0
[0m17:27:26.675864 [debug] [Thread-5 (]: Began compiling node model.dbt_project.sat_product_category_v0
[0m17:27:26.676140 [debug] [Thread-7 (]: Began compiling node model.dbt_project.sat_product_v0
[0m17:27:26.676405 [debug] [Thread-1 (]: Began compiling node model.dbt_project.sat_customer_profession_v0
[0m17:27:26.676895 [debug] [Thread-2 (]: Began compiling node model.dbt_project.sat_customer_spending_v0
[0m17:27:26.685617 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.sat_customer_v0"
[0m17:27:26.687929 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.sat_orders_v0"
[0m17:27:26.690005 [debug] [Thread-6 (]: Writing injected SQL for node "model.dbt_project.sat_product_discount_v0"
[0m17:27:26.691955 [debug] [Thread-5 (]: Writing injected SQL for node "model.dbt_project.sat_product_category_v0"
[0m17:27:26.694350 [debug] [Thread-7 (]: Writing injected SQL for node "model.dbt_project.sat_product_v0"
[0m17:27:26.695923 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.sat_customer_profession_v0"
[0m17:27:26.697360 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.sat_customer_spending_v0"
[0m17:27:26.698549 [debug] [Thread-5 (]: Began executing node model.dbt_project.sat_product_category_v0
[0m17:27:26.711137 [debug] [Thread-4 (]: Began executing node model.dbt_project.sat_orders_v0
[0m17:27:26.729633 [debug] [Thread-1 (]: Began executing node model.dbt_project.sat_customer_profession_v0
[0m17:27:26.731607 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:27:26.731759 [debug] [Thread-7 (]: Began executing node model.dbt_project.sat_product_v0
[0m17:27:26.732487 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:27:26.732637 [debug] [Thread-3 (]: Began executing node model.dbt_project.sat_customer_v0
[0m17:27:26.735659 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:27:26.735806 [debug] [Thread-6 (]: Began executing node model.dbt_project.sat_product_discount_v0
[0m17:27:26.735920 [debug] [Thread-2 (]: Began executing node model.dbt_project.sat_customer_spending_v0
[0m17:27:26.736054 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: select * from (
        

with source_data as (
    select distinct
        CAST(SHA2_BINARY(order_id) as BINARY(32)) as order_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(source || order_id || quantity || amount) as BINARY(32)) as DV_HASH_DIFF
        , order_id
        , quantity
        , amount
    from 
        allianz.stage.stg_sap_orders_v0
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
[0m17:27:26.737257 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:27:26.737405 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: select * from (
        

with source_data as (
    select distinct
        CAST(SHA2_BINARY(product_id || source || category_name) as BINARY(32)) as product_category_hk
        , CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , category_name
    from 
        allianz.stage.stg_product_v0      
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
[0m17:27:26.738757 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:27:26.738929 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: select * from (
        

with source_data as (
    select distinct
        CAST(SHA2_BINARY(customer_id || source || profession || annual_income_inr || work_experience) as BINARY(32)) as customer_profession_hk
        , CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , profession
        , CASE
            WHEN lower(profession) IS NULL THEN 'UNKNOWN'
            WHEN lower(profession) IN ('doctor','healthcare') THEN 'HIGH'
            WHEN lower(profession) IN ('artist','homemaker') THEN 'MEDIUM'
            ELSE 'LOW'
        END as risk_category
        , annual_income_inr
        , CASE
            WHEN annual_income_inr BETWEEN       0 and   100000 THEN 'LOW'
            WHEN annual_income_inr BETWEEN  100001 and  1000000 THEN 'MEDIUM'
            WHEN annual_income_inr BETWEEN 1000001 and 10000000 THEN 'HIGH'
            WHEN annual_income_inr > 10000000 THEN 'HNI'
            ELSE 'NA'
        END as annual_income_bucket
        , work_experience
    from 
        allianz.stage.stg_customer_v0
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
[0m17:27:26.740225 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:27:26.741426 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:27:26.741569 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:27:26.741704 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: select * from (
        

with source_data as (
    select distinct
        CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(source || product_id || product_name || product_description || product_sizes || brand_name) as BINARY(32)) as DV_HASH_DIFF
        , product_id
        , product_name
        , product_description
        , product_sizes
        , brand_name
    from 
        allianz.stage.stg_product_v0
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
[0m17:27:26.741854 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m17:27:26.742004 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: select * from (
        

with source_data as (
    select distinct
        CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(source || gender || age || family_size) as BINARY(32)) as DV_HASH_DIFF
        , customer_id
        , gender
        , age
        , family_size
    from 
        allianz.stage.stg_customer_v0
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
[0m17:27:26.742129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:26.742252 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: select * from (
        

with source_data as (
    select distinct
        CAST(SHA2_BINARY(product_id || source || discount_name) as BINARY(32)) as product_discount_hk
        , CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
        , SYSDATE()  as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , discount_name
        , CAST( LEFT( discount_name , POSITION( '%' IN discount_name)-1 ) as NUMBER(38,2)) as discount_percentage
    from 
        allianz.stage.stg_product_v0
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
[0m17:27:26.742390 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: select * from (
        

with source_data as (
    select
        CAST(SHA2_BINARY(customer_id || source || spending_score) as BINARY(32)) as customer_spending_hk
        , CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , spending_score
        , CASE
            WHEN spending_score BETWEEN 0 and 25 THEN '00-25'
            WHEN spending_score BETWEEN 26 and 50 THEN '26-50'
            WHEN spending_score BETWEEN 51 and 75 THEN '51-75'
            WHEN spending_score BETWEEN 76 and 100 THEN '76-100'
            ELSE 'NA'
        END as spending_bucket
    from 
        allianz.stage.stg_customer_v0
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
[0m17:27:26.742568 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m17:27:26.742971 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:27:26.743330 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m17:27:26.743985 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:27:27.192637 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.450 seconds
[0m17:27:27.203082 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:27:27.203397 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: select * from (
        select
    
      
    cast(null as binary)
     as customer_profession_hk, 
      
    cast(null as binary)
     as customer_hk, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE, 
      
    cast(null as TEXT)
     as profession, 
      
    cast(null as TEXT)
     as risk_category, 
      
    cast(null as integer)
     as annual_income_inr, 
      
    cast(null as TEXT)
     as annual_income_bucket, 
      
    cast(null as integer)
     as work_experience
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
[0m17:27:27.204234 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.461 seconds
[0m17:27:27.205199 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:27:27.205590 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: select * from (
        select
    
      
    cast(null as binary)
     as customer_hk, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE, 
      
    cast(null as binary)
     as DV_HASH_DIFF, 
      
    cast(null as integer)
     as customer_id, 
      
    cast(null as TEXT)
     as gender, 
      
    cast(null as integer)
     as age, 
      
    cast(null as integer)
     as family_size
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
[0m17:27:27.211426 [debug] [Thread-7 (]: SQL status: SUCCESS 0 in 0.469 seconds
[0m17:27:27.212446 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:27:27.212659 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: select * from (
        select
    
      
    cast(null as binary)
     as product_hk, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE, 
      
    cast(null as binary)
     as DV_HASH_DIFF, 
      
    cast(null as TEXT)
     as product_id, 
      
    cast(null as TEXT)
     as product_name, 
      
    cast(null as TEXT)
     as product_description, 
      
    cast(null as TEXT)
     as product_sizes, 
      
    cast(null as TEXT)
     as brand_name
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
[0m17:27:27.284013 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.078 seconds
[0m17:27:27.284700 [debug] [Thread-7 (]: SQL status: SUCCESS 0 in 0.072 seconds
[0m17:27:27.289820 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:27:27.291066 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:27:27.291527 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: create or replace  temporary view allianz.datavault.sat_customer_v0__dbt_tmp
  
  
  
  
  as (
    

with source_data as (
    select distinct
        CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(source || gender || age || family_size) as BINARY(32)) as DV_HASH_DIFF
        , customer_id
        , gender
        , age
        , family_size
    from 
        allianz.stage.stg_customer_v0
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */;
[0m17:27:27.291821 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: create or replace  temporary view allianz.datavault.sat_product_v0__dbt_tmp
  
  
  
  
  as (
    

with source_data as (
    select distinct
        CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(source || product_id || product_name || product_description || product_sizes || brand_name) as BINARY(32)) as DV_HASH_DIFF
        , product_id
        , product_name
        , product_description
        , product_sizes
        , brand_name
    from 
        allianz.stage.stg_product_v0
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */;
[0m17:27:27.306161 [debug] [Thread-4 (]: SQL status: SUCCESS 0 in 0.565 seconds
[0m17:27:27.307128 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:27:27.307354 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: select * from (
        select
    
      
    cast(null as binary)
     as order_hk, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE, 
      
    cast(null as binary)
     as DV_HASH_DIFF, 
      
    cast(null as integer)
     as order_id, 
      
    cast(null as integer)
     as quantity, 
      
    cast(null as integer)
     as amount
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
[0m17:27:27.328152 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.124 seconds
[0m17:27:27.329625 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:27:27.329865 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: create or replace  temporary view allianz.datavault.sat_customer_profession_v0__dbt_tmp
  
  
  
  
  as (
    

with source_data as (
    select distinct
        CAST(SHA2_BINARY(customer_id || source || profession || annual_income_inr || work_experience) as BINARY(32)) as customer_profession_hk
        , CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , profession
        , CASE
            WHEN lower(profession) IS NULL THEN 'UNKNOWN'
            WHEN lower(profession) IN ('doctor','healthcare') THEN 'HIGH'
            WHEN lower(profession) IN ('artist','homemaker') THEN 'MEDIUM'
            ELSE 'LOW'
        END as risk_category
        , annual_income_inr
        , CASE
            WHEN annual_income_inr BETWEEN       0 and   100000 THEN 'LOW'
            WHEN annual_income_inr BETWEEN  100001 and  1000000 THEN 'MEDIUM'
            WHEN annual_income_inr BETWEEN 1000001 and 10000000 THEN 'HIGH'
            WHEN annual_income_inr > 10000000 THEN 'HNI'
            ELSE 'NA'
        END as annual_income_bucket
        , work_experience
    from 
        allianz.stage.stg_customer_v0
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */;
[0m17:27:27.370056 [debug] [Thread-4 (]: SQL status: SUCCESS 0 in 0.062 seconds
[0m17:27:27.371476 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:27:27.371901 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: create or replace  temporary view allianz.datavault.sat_orders_v0__dbt_tmp
  
  
  
  
  as (
    

with source_data as (
    select distinct
        CAST(SHA2_BINARY(order_id) as BINARY(32)) as order_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(source || order_id || quantity || amount) as BINARY(32)) as DV_HASH_DIFF
        , order_id
        , quantity
        , amount
    from 
        allianz.stage.stg_sap_orders_v0
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */;
[0m17:27:27.431697 [debug] [Thread-6 (]: SQL status: SUCCESS 0 in 0.688 seconds
[0m17:27:27.433787 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:27:27.434319 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: select * from (
        select
    
      
    cast(null as binary)
     as product_discount_hk, 
      
    cast(null as binary)
     as product_hk, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE, 
      
    cast(null as TEXT)
     as discount_name, 
      
    cast(null as number(38,2))
     as discount_percentage
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
[0m17:27:27.477892 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 0.185 seconds
[0m17:27:27.479128 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.149 seconds
[0m17:27:27.491522 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:27:27.494721 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:27:27.495181 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: describe table allianz.datavault.sat_product_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
[0m17:27:27.495508 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: describe table allianz.datavault.sat_customer_profession_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
[0m17:27:27.509107 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.765 seconds
[0m17:27:27.510540 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:27:27.510853 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: select * from (
        select
    
      
    cast(null as binary)
     as customer_spending_hk, 
      
    cast(null as binary)
     as customer_hk, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE, 
      
    cast(null as integer)
     as spending_score, 
      
    cast(null as TEXT)
     as spending_bucket
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
[0m17:27:27.517386 [debug] [Thread-5 (]: SQL status: SUCCESS 0 in 0.775 seconds
[0m17:27:27.518501 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:27:27.518800 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: select * from (
        select
    
      
    cast(null as binary)
     as product_category_hk, 
      
    cast(null as binary)
     as product_hk, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE, 
      
    cast(null as TEXT)
     as category_name
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
[0m17:27:27.550440 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.178 seconds
[0m17:27:27.553194 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:27:27.553489 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: describe table allianz.datavault.sat_orders_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
[0m17:27:27.558277 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.266 seconds
[0m17:27:27.558822 [debug] [Thread-6 (]: SQL status: SUCCESS 0 in 0.124 seconds
[0m17:27:27.560434 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:27:27.561457 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:27:27.561654 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: describe table allianz.datavault.sat_customer_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
[0m17:27:27.561855 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: create or replace  temporary view allianz.datavault.sat_product_discount_v0__dbt_tmp
  
  
  
  
  as (
    

with source_data as (
    select distinct
        CAST(SHA2_BINARY(product_id || source || discount_name) as BINARY(32)) as product_discount_hk
        , CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
        , SYSDATE()  as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , discount_name
        , CAST( LEFT( discount_name , POSITION( '%' IN discount_name)-1 ) as NUMBER(38,2)) as discount_percentage
    from 
        allianz.stage.stg_product_v0
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */;
[0m17:27:27.579678 [debug] [Thread-5 (]: SQL status: SUCCESS 0 in 0.061 seconds
[0m17:27:27.580182 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.069 seconds
[0m17:27:27.581228 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:27:27.582407 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:27:27.582615 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: create or replace  temporary view allianz.datavault.sat_product_category_v0__dbt_tmp
  
  
  
  
  as (
    

with source_data as (
    select distinct
        CAST(SHA2_BINARY(product_id || source || category_name) as BINARY(32)) as product_category_hk
        , CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , category_name
    from 
        allianz.stage.stg_product_v0      
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */;
[0m17:27:27.582852 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: create or replace  temporary view allianz.datavault.sat_customer_spending_v0__dbt_tmp
  
  
  
  
  as (
    

with source_data as (
    select
        CAST(SHA2_BINARY(customer_id || source || spending_score) as BINARY(32)) as customer_spending_hk
        , CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , spending_score
        , CASE
            WHEN spending_score BETWEEN 0 and 25 THEN '00-25'
            WHEN spending_score BETWEEN 26 and 50 THEN '26-50'
            WHEN spending_score BETWEEN 51 and 75 THEN '51-75'
            WHEN spending_score BETWEEN 76 and 100 THEN '76-100'
            ELSE 'NA'
        END as spending_bucket
    from 
        allianz.stage.stg_customer_v0
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */;
[0m17:27:27.593773 [debug] [Thread-7 (]: SQL status: SUCCESS 9 in 0.098 seconds
[0m17:27:27.599063 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:27:27.599312 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: describe table allianz.datavault.sat_product_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
[0m17:27:27.600580 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.104 seconds
[0m17:27:27.602620 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:27:27.602863 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: describe table allianz.datavault.sat_customer_profession_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
[0m17:27:27.641090 [debug] [Thread-4 (]: SQL status: SUCCESS 7 in 0.087 seconds
[0m17:27:27.643484 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:27:27.643703 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: describe table allianz.datavault.sat_orders_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
[0m17:27:27.677421 [debug] [Thread-3 (]: SQL status: SUCCESS 8 in 0.115 seconds
[0m17:27:27.679797 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:27:27.680074 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: describe table allianz.datavault.sat_customer_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
[0m17:27:27.681335 [debug] [Thread-7 (]: SQL status: SUCCESS 9 in 0.082 seconds
[0m17:27:27.691246 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:27:27.691828 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: describe table allianz.datavault.sat_product_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
[0m17:27:27.693418 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.090 seconds
[0m17:27:27.695397 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:27:27.695810 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: describe table allianz.datavault.sat_customer_profession_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
[0m17:27:27.707646 [debug] [Thread-4 (]: SQL status: SUCCESS 7 in 0.064 seconds
[0m17:27:27.707999 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.146 seconds
[0m17:27:27.709537 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:27:27.710778 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:27:27.710937 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: describe table allianz.datavault.sat_orders_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
[0m17:27:27.711084 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: describe table allianz.datavault.sat_product_discount_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
[0m17:27:27.762811 [debug] [Thread-3 (]: SQL status: SUCCESS 8 in 0.082 seconds
[0m17:27:27.764773 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:27:27.764989 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: describe table allianz.datavault.sat_customer_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
[0m17:27:27.773294 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.077 seconds
[0m17:27:27.775428 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:27:27.775655 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: describe table "ALLIANZ"."DATAVAULT"."SAT_CUSTOMER_PROFESSION_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
[0m17:27:27.778420 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.195 seconds
[0m17:27:27.779717 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:27:27.779914 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: describe table allianz.datavault.sat_customer_spending_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
[0m17:27:27.780548 [debug] [Thread-7 (]: SQL status: SUCCESS 9 in 0.089 seconds
[0m17:27:27.782184 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:27:27.782630 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: describe table "ALLIANZ"."DATAVAULT"."SAT_PRODUCT_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
[0m17:27:27.786978 [debug] [Thread-4 (]: SQL status: SUCCESS 7 in 0.076 seconds
[0m17:27:27.788594 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:27:27.788780 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: describe table "ALLIANZ"."DATAVAULT"."SAT_ORDERS_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
[0m17:27:27.791464 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.208 seconds
[0m17:27:27.792707 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:27:27.792880 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: describe table allianz.datavault.sat_product_category_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
[0m17:27:27.813556 [debug] [Thread-6 (]: SQL status: SUCCESS 6 in 0.102 seconds
[0m17:27:27.815365 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:27:27.815547 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: describe table allianz.datavault.sat_product_discount_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
[0m17:27:27.827295 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.051 seconds
[0m17:27:27.831668 [debug] [Thread-1 (]: 
    In "ALLIANZ"."DATAVAULT"."SAT_CUSTOMER_PROFESSION_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:27:27.843249 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.sat_customer_profession_v0"
[0m17:27:27.843814 [debug] [Thread-3 (]: SQL status: SUCCESS 8 in 0.079 seconds
[0m17:27:27.845281 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:27:27.845438 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: describe table "ALLIANZ"."DATAVAULT"."SAT_CUSTOMER_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
[0m17:27:27.845748 [debug] [Thread-7 (]: SQL status: SUCCESS 9 in 0.063 seconds
[0m17:27:27.846717 [debug] [Thread-7 (]: 
    In "ALLIANZ"."DATAVAULT"."SAT_PRODUCT_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:27:27.847152 [debug] [Thread-7 (]: Writing runtime sql for node "model.dbt_project.sat_product_v0"
[0m17:27:27.848154 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:27:27.848602 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:27:27.848729 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */;
[0m17:27:27.848924 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */;
[0m17:27:27.853598 [debug] [Thread-4 (]: SQL status: SUCCESS 7 in 0.065 seconds
[0m17:27:27.854316 [debug] [Thread-4 (]: 
    In "ALLIANZ"."DATAVAULT"."SAT_ORDERS_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:27:27.854712 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.sat_orders_v0"
[0m17:27:27.855420 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:27:27.855532 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */;
[0m17:27:27.859084 [debug] [Thread-5 (]: SQL status: SUCCESS 5 in 0.066 seconds
[0m17:27:27.860375 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:27:27.860498 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: describe table allianz.datavault.sat_product_category_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
[0m17:27:27.884239 [debug] [Thread-6 (]: SQL status: SUCCESS 6 in 0.069 seconds
[0m17:27:27.885482 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:27:27.885795 [debug] [Thread-2 (]: SQL status: SUCCESS 6 in 0.106 seconds
[0m17:27:27.885936 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: describe table allianz.datavault.sat_product_discount_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
[0m17:27:27.887169 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:27:27.887703 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: describe table allianz.datavault.sat_customer_spending_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
[0m17:27:27.923135 [debug] [Thread-3 (]: SQL status: SUCCESS 8 in 0.077 seconds
[0m17:27:27.924360 [debug] [Thread-3 (]: 
    In "ALLIANZ"."DATAVAULT"."SAT_CUSTOMER_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:27:27.925021 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.sat_customer_v0"
[0m17:27:27.925902 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:27:27.926074 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */;
[0m17:27:27.930815 [debug] [Thread-5 (]: SQL status: SUCCESS 5 in 0.070 seconds
[0m17:27:27.932387 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:27:27.932580 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: describe table allianz.datavault.sat_product_category_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
[0m17:27:27.943310 [debug] [Thread-2 (]: SQL status: SUCCESS 6 in 0.055 seconds
[0m17:27:27.945071 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:27:27.945249 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: describe table allianz.datavault.sat_customer_spending_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
[0m17:27:27.959973 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m17:27:27.960150 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:27:27.960328 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: merge into allianz.datavault.sat_customer_profession_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.sat_customer_profession_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.customer_profession_hk = DBT_INTERNAL_DEST.customer_profession_hk
                )

    
    when matched then update set
        "CUSTOMER_PROFESSION_HK" = DBT_INTERNAL_SOURCE."CUSTOMER_PROFESSION_HK","CUSTOMER_HK" = DBT_INTERNAL_SOURCE."CUSTOMER_HK","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE","PROFESSION" = DBT_INTERNAL_SOURCE."PROFESSION","RISK_CATEGORY" = DBT_INTERNAL_SOURCE."RISK_CATEGORY","ANNUAL_INCOME_INR" = DBT_INTERNAL_SOURCE."ANNUAL_INCOME_INR","ANNUAL_INCOME_BUCKET" = DBT_INTERNAL_SOURCE."ANNUAL_INCOME_BUCKET","WORK_EXPERIENCE" = DBT_INTERNAL_SOURCE."WORK_EXPERIENCE"
    

    when not matched then insert
        ("CUSTOMER_PROFESSION_HK", "CUSTOMER_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "PROFESSION", "RISK_CATEGORY", "ANNUAL_INCOME_INR", "ANNUAL_INCOME_BUCKET", "WORK_EXPERIENCE")
    values
        ("CUSTOMER_PROFESSION_HK", "CUSTOMER_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "PROFESSION", "RISK_CATEGORY", "ANNUAL_INCOME_INR", "ANNUAL_INCOME_BUCKET", "WORK_EXPERIENCE")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */;
[0m17:27:27.960928 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 0.112 seconds
[0m17:27:27.961219 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:27:27.961560 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: merge into allianz.datavault.sat_product_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.sat_product_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.product_hk = DBT_INTERNAL_DEST.product_hk
                ) and (
                    DBT_INTERNAL_SOURCE.DV_HASH_DIFF = DBT_INTERNAL_DEST.DV_HASH_DIFF
                )

    
    when matched then update set
        "PRODUCT_HK" = DBT_INTERNAL_SOURCE."PRODUCT_HK","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE","DV_HASH_DIFF" = DBT_INTERNAL_SOURCE."DV_HASH_DIFF","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRODUCT_NAME" = DBT_INTERNAL_SOURCE."PRODUCT_NAME","PRODUCT_DESCRIPTION" = DBT_INTERNAL_SOURCE."PRODUCT_DESCRIPTION","PRODUCT_SIZES" = DBT_INTERNAL_SOURCE."PRODUCT_SIZES","BRAND_NAME" = DBT_INTERNAL_SOURCE."BRAND_NAME"
    

    when not matched then insert
        ("PRODUCT_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "DV_HASH_DIFF", "PRODUCT_ID", "PRODUCT_NAME", "PRODUCT_DESCRIPTION", "PRODUCT_SIZES", "BRAND_NAME")
    values
        ("PRODUCT_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "DV_HASH_DIFF", "PRODUCT_ID", "PRODUCT_NAME", "PRODUCT_DESCRIPTION", "PRODUCT_SIZES", "BRAND_NAME")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */;
[0m17:27:27.964121 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.108 seconds
[0m17:27:27.964308 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:27:27.964480 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: merge into allianz.datavault.sat_orders_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.sat_orders_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_hk = DBT_INTERNAL_DEST.order_hk
                ) and (
                    DBT_INTERNAL_SOURCE.DV_HASH_DIFF = DBT_INTERNAL_DEST.DV_HASH_DIFF
                )

    
    when matched then update set
        "ORDER_HK" = DBT_INTERNAL_SOURCE."ORDER_HK","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE","DV_HASH_DIFF" = DBT_INTERNAL_SOURCE."DV_HASH_DIFF","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","AMOUNT" = DBT_INTERNAL_SOURCE."AMOUNT"
    

    when not matched then insert
        ("ORDER_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "DV_HASH_DIFF", "ORDER_ID", "QUANTITY", "AMOUNT")
    values
        ("ORDER_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "DV_HASH_DIFF", "ORDER_ID", "QUANTITY", "AMOUNT")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */;
[0m17:27:27.968746 [debug] [Thread-6 (]: SQL status: SUCCESS 6 in 0.081 seconds
[0m17:27:27.970311 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:27:27.970492 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: describe table "ALLIANZ"."DATAVAULT"."SAT_PRODUCT_DISCOUNT_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
[0m17:27:28.003354 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.077 seconds
[0m17:27:28.003573 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:27:28.003785 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: merge into allianz.datavault.sat_customer_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.sat_customer_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.customer_hk = DBT_INTERNAL_DEST.customer_hk
                ) and (
                    DBT_INTERNAL_SOURCE.DV_HASH_DIFF = DBT_INTERNAL_DEST.DV_HASH_DIFF
                )

    
    when matched then update set
        "CUSTOMER_HK" = DBT_INTERNAL_SOURCE."CUSTOMER_HK","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE","DV_HASH_DIFF" = DBT_INTERNAL_SOURCE."DV_HASH_DIFF","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","GENDER" = DBT_INTERNAL_SOURCE."GENDER","AGE" = DBT_INTERNAL_SOURCE."AGE","FAMILY_SIZE" = DBT_INTERNAL_SOURCE."FAMILY_SIZE"
    

    when not matched then insert
        ("CUSTOMER_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "DV_HASH_DIFF", "CUSTOMER_ID", "GENDER", "AGE", "FAMILY_SIZE")
    values
        ("CUSTOMER_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "DV_HASH_DIFF", "CUSTOMER_ID", "GENDER", "AGE", "FAMILY_SIZE")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */;
[0m17:27:28.014621 [debug] [Thread-5 (]: SQL status: SUCCESS 5 in 0.082 seconds
[0m17:27:28.016928 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:27:28.017440 [debug] [Thread-2 (]: SQL status: SUCCESS 6 in 0.072 seconds
[0m17:27:28.017695 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: describe table "ALLIANZ"."DATAVAULT"."SAT_PRODUCT_CATEGORY_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
[0m17:27:28.019485 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:27:28.020018 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: describe table "ALLIANZ"."DATAVAULT"."SAT_CUSTOMER_SPENDING_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
[0m17:27:28.026294 [debug] [Thread-6 (]: SQL status: SUCCESS 6 in 0.056 seconds
[0m17:27:28.027445 [debug] [Thread-6 (]: 
    In "ALLIANZ"."DATAVAULT"."SAT_PRODUCT_DISCOUNT_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:27:28.028111 [debug] [Thread-6 (]: Writing runtime sql for node "model.dbt_project.sat_product_discount_v0"
[0m17:27:28.029008 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:27:28.029198 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */;
[0m17:27:28.130738 [debug] [Thread-5 (]: SQL status: SUCCESS 5 in 0.111 seconds
[0m17:27:28.132435 [debug] [Thread-5 (]: 
    In "ALLIANZ"."DATAVAULT"."SAT_PRODUCT_CATEGORY_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:27:28.133146 [debug] [Thread-5 (]: Writing runtime sql for node "model.dbt_project.sat_product_category_v0"
[0m17:27:28.134116 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:27:28.134332 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */;
[0m17:27:28.137987 [debug] [Thread-2 (]: SQL status: SUCCESS 6 in 0.118 seconds
[0m17:27:28.139151 [debug] [Thread-2 (]: 
    In "ALLIANZ"."DATAVAULT"."SAT_CUSTOMER_SPENDING_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:27:28.139756 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.sat_customer_spending_v0"
[0m17:27:28.140776 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:27:28.141097 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */;
[0m17:27:28.142580 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.113 seconds
[0m17:27:28.142882 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:27:28.143193 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: merge into allianz.datavault.sat_product_discount_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.sat_product_discount_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.product_discount_hk = DBT_INTERNAL_DEST.product_discount_hk
                )

    
    when matched then update set
        "PRODUCT_DISCOUNT_HK" = DBT_INTERNAL_SOURCE."PRODUCT_DISCOUNT_HK","PRODUCT_HK" = DBT_INTERNAL_SOURCE."PRODUCT_HK","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE","DISCOUNT_NAME" = DBT_INTERNAL_SOURCE."DISCOUNT_NAME","DISCOUNT_PERCENTAGE" = DBT_INTERNAL_SOURCE."DISCOUNT_PERCENTAGE"
    

    when not matched then insert
        ("PRODUCT_DISCOUNT_HK", "PRODUCT_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "DISCOUNT_NAME", "DISCOUNT_PERCENTAGE")
    values
        ("PRODUCT_DISCOUNT_HK", "PRODUCT_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "DISCOUNT_NAME", "DISCOUNT_PERCENTAGE")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */;
[0m17:27:28.206185 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.072 seconds
[0m17:27:28.206371 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:27:28.206498 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: merge into allianz.datavault.sat_product_category_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.sat_product_category_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.product_category_hk = DBT_INTERNAL_DEST.product_category_hk
                )

    
    when matched then update set
        "PRODUCT_CATEGORY_HK" = DBT_INTERNAL_SOURCE."PRODUCT_CATEGORY_HK","PRODUCT_HK" = DBT_INTERNAL_SOURCE."PRODUCT_HK","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE","CATEGORY_NAME" = DBT_INTERNAL_SOURCE."CATEGORY_NAME"
    

    when not matched then insert
        ("PRODUCT_CATEGORY_HK", "PRODUCT_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "CATEGORY_NAME")
    values
        ("PRODUCT_CATEGORY_HK", "PRODUCT_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "CATEGORY_NAME")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */;
[0m17:27:28.242994 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.102 seconds
[0m17:27:28.243126 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:27:28.243256 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: merge into allianz.datavault.sat_customer_spending_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.sat_customer_spending_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.customer_spending_hk = DBT_INTERNAL_DEST.customer_spending_hk
                )

    
    when matched then update set
        "CUSTOMER_SPENDING_HK" = DBT_INTERNAL_SOURCE."CUSTOMER_SPENDING_HK","CUSTOMER_HK" = DBT_INTERNAL_SOURCE."CUSTOMER_HK","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE","SPENDING_SCORE" = DBT_INTERNAL_SOURCE."SPENDING_SCORE","SPENDING_BUCKET" = DBT_INTERNAL_SOURCE."SPENDING_BUCKET"
    

    when not matched then insert
        ("CUSTOMER_SPENDING_HK", "CUSTOMER_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "SPENDING_SCORE", "SPENDING_BUCKET")
    values
        ("CUSTOMER_SPENDING_HK", "CUSTOMER_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "SPENDING_SCORE", "SPENDING_BUCKET")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */;
[0m17:27:28.492224 [debug] [Thread-4 (]: SQL status: SUCCESS 5 in 0.528 seconds
[0m17:27:28.492438 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:27:28.492543 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
[0m17:27:28.530046 [debug] [Thread-7 (]: SQL status: SUCCESS 4566 in 0.568 seconds
[0m17:27:28.530191 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:27:28.530300 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
[0m17:27:28.699202 [debug] [Thread-3 (]: SQL status: SUCCESS 2000 in 0.695 seconds
[0m17:27:28.699329 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:27:28.699426 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
[0m17:27:28.761833 [debug] [Thread-1 (]: SQL status: SUCCESS 2000 in 0.801 seconds
[0m17:27:28.762006 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:27:28.762114 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
[0m17:27:28.792970 [debug] [Thread-2 (]: SQL status: SUCCESS 2000 in 0.550 seconds
[0m17:27:28.793091 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:27:28.793183 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
[0m17:27:28.816876 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.324 seconds
[0m17:27:28.819897 [debug] [Thread-4 (]: Applying DROP to: allianz.datavault.sat_orders_v0__dbt_tmp
[0m17:27:28.822213 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:27:28.822335 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: drop view if exists allianz.datavault.sat_orders_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
[0m17:27:28.823528 [debug] [Thread-6 (]: SQL status: SUCCESS 4566 in 0.680 seconds
[0m17:27:28.823667 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:27:28.823778 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
[0m17:27:28.829953 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 0.300 seconds
[0m17:27:28.831040 [debug] [Thread-7 (]: Applying DROP to: allianz.datavault.sat_product_v0__dbt_tmp
[0m17:27:28.831282 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:27:28.831395 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: drop view if exists allianz.datavault.sat_product_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
[0m17:27:28.927534 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.105 seconds
[0m17:27:28.934446 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: Close
[0m17:27:28.935616 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 0.104 seconds
[0m17:27:28.936173 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: Close
[0m17:27:28.974746 [debug] [Thread-5 (]: SQL status: SUCCESS 4566 in 0.768 seconds
[0m17:27:28.975065 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:27:28.975188 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
[0m17:27:28.997055 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.298 seconds
[0m17:27:28.997958 [debug] [Thread-3 (]: Applying DROP to: allianz.datavault.sat_customer_v0__dbt_tmp
[0m17:27:28.998195 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:27:28.998304 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: drop view if exists allianz.datavault.sat_customer_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
[0m17:27:29.024680 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.262 seconds
[0m17:27:29.025813 [debug] [Thread-1 (]: Applying DROP to: allianz.datavault.sat_customer_profession_v0__dbt_tmp
[0m17:27:29.026106 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:27:29.026227 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: drop view if exists allianz.datavault.sat_customer_profession_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
[0m17:27:29.027810 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fd976a0>]}
[0m17:27:29.028051 [info ] [Thread-4 (]: 4 of 10 OK created sql incremental model datavault.sat_orders_v0 ............... [[32mSUCCESS 5[0m in 2.35s]
[0m17:27:29.028249 [debug] [Thread-4 (]: Finished running node model.dbt_project.sat_orders_v0
[0m17:27:29.031537 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d337070>]}
[0m17:27:29.031741 [info ] [Thread-7 (]: 7 of 10 OK created sql incremental model datavault.sat_product_v0 .............. [[32mSUCCESS 4566[0m in 2.36s]
[0m17:27:29.031923 [debug] [Thread-7 (]: Finished running node model.dbt_project.sat_product_v0
[0m17:27:29.051023 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.258 seconds
[0m17:27:29.052037 [debug] [Thread-2 (]: Applying DROP to: allianz.datavault.sat_customer_spending_v0__dbt_tmp
[0m17:27:29.052305 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:27:29.052414 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: drop view if exists allianz.datavault.sat_customer_spending_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
[0m17:27:29.086083 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.262 seconds
[0m17:27:29.086941 [debug] [Thread-6 (]: Applying DROP to: allianz.datavault.sat_product_discount_v0__dbt_tmp
[0m17:27:29.087367 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:27:29.087467 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: drop view if exists allianz.datavault.sat_product_discount_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
[0m17:27:29.129091 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.131 seconds
[0m17:27:29.129663 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: Close
[0m17:27:29.179811 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.153 seconds
[0m17:27:29.180580 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: Close
[0m17:27:29.196738 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a16cbd0>]}
[0m17:27:29.197008 [info ] [Thread-3 (]: 3 of 10 OK created sql incremental model datavault.sat_customer_v0 ............. [[32mSUCCESS 2000[0m in 2.52s]
[0m17:27:29.197216 [debug] [Thread-3 (]: Finished running node model.dbt_project.sat_customer_v0
[0m17:27:29.213124 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.126 seconds
[0m17:27:29.213825 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: Close
[0m17:27:29.214094 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.239 seconds
[0m17:27:29.215772 [debug] [Thread-5 (]: Applying DROP to: allianz.datavault.sat_product_category_v0__dbt_tmp
[0m17:27:29.216374 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:27:29.216607 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: drop view if exists allianz.datavault.sat_product_category_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
[0m17:27:29.217006 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.164 seconds
[0m17:27:29.217639 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: Close
[0m17:27:29.265434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fd47690>]}
[0m17:27:29.265803 [info ] [Thread-1 (]: 1 of 10 OK created sql incremental model datavault.sat_customer_profession_v0 .. [[32mSUCCESS 2000[0m in 2.59s]
[0m17:27:29.266094 [debug] [Thread-1 (]: Finished running node model.dbt_project.sat_customer_profession_v0
[0m17:27:29.312656 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a1d15b0>]}
[0m17:27:29.313064 [info ] [Thread-2 (]: 2 of 10 OK created sql incremental model datavault.sat_customer_spending_v0 .... [[32mSUCCESS 2000[0m in 2.64s]
[0m17:27:29.313377 [debug] [Thread-2 (]: Finished running node model.dbt_project.sat_customer_spending_v0
[0m17:27:29.313713 [debug] [Thread-8 (]: Began running node model.dbt_project.hub_customer_v0
[0m17:27:29.314043 [info ] [Thread-8 (]: 8 of 10 START sql incremental model datavault.hub_customer_v0 .................. [RUN]
[0m17:27:29.314357 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.dbt_project.hub_customer_v0'
[0m17:27:29.314556 [debug] [Thread-8 (]: Began compiling node model.dbt_project.hub_customer_v0
[0m17:27:29.317016 [debug] [Thread-8 (]: Writing injected SQL for node "model.dbt_project.hub_customer_v0"
[0m17:27:29.317626 [debug] [Thread-8 (]: Began executing node model.dbt_project.hub_customer_v0
[0m17:27:29.320268 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:27:29.320500 [debug] [Thread-8 (]: On model.dbt_project.hub_customer_v0: select * from (
        -- depends_on: allianz.datavault.sat_customer_v0
-- depends_on: allianz.datavault.sat_customer_profession_v0
-- depends_on: allianz.datavault.sat_customer_spending_v0



with source_data as (
    select distinct
        CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , customer_id
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
    from 
        allianz.stage.stg_customer_v0 stg
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
[0m17:27:29.320920 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m17:27:29.323441 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a16ba70>]}
[0m17:27:29.323813 [info ] [Thread-6 (]: 6 of 10 OK created sql incremental model datavault.sat_product_discount_v0 ..... [[32mSUCCESS 4566[0m in 2.65s]
[0m17:27:29.324233 [debug] [Thread-6 (]: Finished running node model.dbt_project.sat_product_discount_v0
[0m17:27:29.330180 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.113 seconds
[0m17:27:29.331409 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: Close
[0m17:27:29.407461 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a16b410>]}
[0m17:27:29.409082 [info ] [Thread-5 (]: 5 of 10 OK created sql incremental model datavault.sat_product_category_v0 ..... [[32mSUCCESS 4566[0m in 2.73s]
[0m17:27:29.409469 [debug] [Thread-5 (]: Finished running node model.dbt_project.sat_product_category_v0
[0m17:27:29.409775 [debug] [Thread-9 (]: Began running node model.dbt_project.hub_product_v0
[0m17:27:29.410037 [info ] [Thread-9 (]: 9 of 10 START sql incremental model datavault.hub_product_v0 ................... [RUN]
[0m17:27:29.410285 [debug] [Thread-9 (]: Acquiring new snowflake connection 'model.dbt_project.hub_product_v0'
[0m17:27:29.410438 [debug] [Thread-9 (]: Began compiling node model.dbt_project.hub_product_v0
[0m17:27:29.412326 [debug] [Thread-9 (]: Writing injected SQL for node "model.dbt_project.hub_product_v0"
[0m17:27:29.413515 [debug] [Thread-9 (]: Began executing node model.dbt_project.hub_product_v0
[0m17:27:29.414944 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:27:29.415113 [debug] [Thread-9 (]: On model.dbt_project.hub_product_v0: select * from (
        -- depends_on: allianz.datavault.sat_product_v0
-- depends_on: allianz.datavault.sat_product_category_v0
-- depends_on: allianz.datavault.sat_product_discount_v0



with source_data as (
    select distinct
        CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
        , product_id
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
    from 
        allianz.stage.stg_product_v0 stg
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
[0m17:27:29.415382 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m17:27:29.646907 [debug] [Thread-8 (]: SQL status: SUCCESS 0 in 0.326 seconds
[0m17:27:29.650018 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:27:29.650421 [debug] [Thread-8 (]: On model.dbt_project.hub_customer_v0: select * from (
        select
    
      
    cast(null as binary)
     as customer_hk, 
      
    cast(null as integer)
     as customer_id, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
[0m17:27:29.722702 [debug] [Thread-8 (]: SQL status: SUCCESS 0 in 0.072 seconds
[0m17:27:29.726151 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:27:29.726997 [debug] [Thread-8 (]: On model.dbt_project.hub_customer_v0: create or replace  temporary view allianz.datavault.hub_customer_v0__dbt_tmp
  
  
  
  
  as (
    -- depends_on: allianz.datavault.sat_customer_v0
-- depends_on: allianz.datavault.sat_customer_profession_v0
-- depends_on: allianz.datavault.sat_customer_spending_v0



with source_data as (
    select distinct
        CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , customer_id
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
    from 
        allianz.stage.stg_customer_v0 stg
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */;
[0m17:27:29.733614 [debug] [Thread-9 (]: SQL status: SUCCESS 0 in 0.318 seconds
[0m17:27:29.734645 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:27:29.734913 [debug] [Thread-9 (]: On model.dbt_project.hub_product_v0: select * from (
        select
    
      
    cast(null as binary)
     as product_hk, 
      
    cast(null as TEXT)
     as product_id, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
[0m17:27:29.801131 [debug] [Thread-9 (]: SQL status: SUCCESS 0 in 0.066 seconds
[0m17:27:29.803229 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:27:29.803618 [debug] [Thread-9 (]: On model.dbt_project.hub_product_v0: create or replace  temporary view allianz.datavault.hub_product_v0__dbt_tmp
  
  
  
  
  as (
    -- depends_on: allianz.datavault.sat_product_v0
-- depends_on: allianz.datavault.sat_product_category_v0
-- depends_on: allianz.datavault.sat_product_discount_v0



with source_data as (
    select distinct
        CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
        , product_id
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
    from 
        allianz.stage.stg_product_v0 stg
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */;
[0m17:27:30.161459 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.357 seconds
[0m17:27:30.165133 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:27:30.165647 [debug] [Thread-9 (]: On model.dbt_project.hub_product_v0: describe table allianz.datavault.hub_product_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
[0m17:27:30.167075 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 0.440 seconds
[0m17:27:30.170748 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:27:30.171080 [debug] [Thread-8 (]: On model.dbt_project.hub_customer_v0: describe table allianz.datavault.hub_customer_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
[0m17:27:30.231367 [debug] [Thread-9 (]: SQL status: SUCCESS 4 in 0.064 seconds
[0m17:27:30.237119 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:27:30.237601 [debug] [Thread-9 (]: On model.dbt_project.hub_product_v0: describe table allianz.datavault.hub_product_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
[0m17:27:30.239722 [debug] [Thread-8 (]: SQL status: SUCCESS 4 in 0.068 seconds
[0m17:27:30.242912 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:27:30.243305 [debug] [Thread-8 (]: On model.dbt_project.hub_customer_v0: describe table allianz.datavault.hub_customer_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
[0m17:27:30.323131 [debug] [Thread-9 (]: SQL status: SUCCESS 4 in 0.084 seconds
[0m17:27:30.329481 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:27:30.330006 [debug] [Thread-9 (]: On model.dbt_project.hub_product_v0: describe table allianz.datavault.hub_product_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
[0m17:27:30.332167 [debug] [Thread-8 (]: SQL status: SUCCESS 4 in 0.088 seconds
[0m17:27:30.335889 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:27:30.336552 [debug] [Thread-8 (]: On model.dbt_project.hub_customer_v0: describe table allianz.datavault.hub_customer_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
[0m17:27:30.465245 [debug] [Thread-8 (]: SQL status: SUCCESS 4 in 0.128 seconds
[0m17:27:30.470746 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:27:30.471662 [debug] [Thread-9 (]: SQL status: SUCCESS 4 in 0.141 seconds
[0m17:27:30.472033 [debug] [Thread-8 (]: On model.dbt_project.hub_customer_v0: describe table "ALLIANZ"."DATAVAULT"."HUB_CUSTOMER_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
[0m17:27:30.475267 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:27:30.476043 [debug] [Thread-9 (]: On model.dbt_project.hub_product_v0: describe table "ALLIANZ"."DATAVAULT"."HUB_PRODUCT_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
[0m17:27:30.563465 [debug] [Thread-9 (]: SQL status: SUCCESS 4 in 0.087 seconds
[0m17:27:30.567000 [debug] [Thread-9 (]: 
    In "ALLIANZ"."DATAVAULT"."HUB_PRODUCT_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:27:30.568540 [debug] [Thread-9 (]: Writing runtime sql for node "model.dbt_project.hub_product_v0"
[0m17:27:30.570094 [debug] [Thread-8 (]: SQL status: SUCCESS 4 in 0.094 seconds
[0m17:27:30.572157 [debug] [Thread-8 (]: 
    In "ALLIANZ"."DATAVAULT"."HUB_CUSTOMER_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:27:30.573276 [debug] [Thread-8 (]: Writing runtime sql for node "model.dbt_project.hub_customer_v0"
[0m17:27:30.574844 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:27:30.575213 [debug] [Thread-9 (]: On model.dbt_project.hub_product_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */;
[0m17:27:30.576053 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:27:30.576608 [debug] [Thread-8 (]: On model.dbt_project.hub_customer_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */;
[0m17:27:30.723940 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 0.147 seconds
[0m17:27:30.725308 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.149 seconds
[0m17:27:30.725903 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:27:30.726432 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:27:30.726870 [debug] [Thread-8 (]: On model.dbt_project.hub_customer_v0: merge into allianz.datavault.hub_customer_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.hub_customer_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.customer_hk = DBT_INTERNAL_DEST.customer_hk
                )

    
    when matched then update set
        "CUSTOMER_HK" = DBT_INTERNAL_SOURCE."CUSTOMER_HK","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_HK", "CUSTOMER_ID", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE")
    values
        ("CUSTOMER_HK", "CUSTOMER_ID", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */;
[0m17:27:30.727295 [debug] [Thread-9 (]: On model.dbt_project.hub_product_v0: merge into allianz.datavault.hub_product_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.hub_product_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.product_hk = DBT_INTERNAL_DEST.product_hk
                )

    
    when matched then update set
        "PRODUCT_HK" = DBT_INTERNAL_SOURCE."PRODUCT_HK","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE"
    

    when not matched then insert
        ("PRODUCT_HK", "PRODUCT_ID", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE")
    values
        ("PRODUCT_HK", "PRODUCT_ID", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */;
[0m17:27:31.795316 [debug] [Thread-9 (]: SQL status: SUCCESS 4566 in 1.067 seconds
[0m17:27:31.796357 [debug] [Thread-8 (]: SQL status: SUCCESS 2000 in 1.069 seconds
[0m17:27:31.797063 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:27:31.797573 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:27:31.797934 [debug] [Thread-9 (]: On model.dbt_project.hub_product_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
[0m17:27:31.798248 [debug] [Thread-8 (]: On model.dbt_project.hub_customer_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
[0m17:27:32.101275 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.302 seconds
[0m17:27:32.107284 [debug] [Thread-9 (]: Applying DROP to: allianz.datavault.hub_product_v0__dbt_tmp
[0m17:27:32.108249 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:27:32.108779 [debug] [Thread-9 (]: On model.dbt_project.hub_product_v0: drop view if exists allianz.datavault.hub_product_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
[0m17:27:32.126368 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 0.327 seconds
[0m17:27:32.128816 [debug] [Thread-8 (]: Applying DROP to: allianz.datavault.hub_customer_v0__dbt_tmp
[0m17:27:32.129485 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:27:32.129750 [debug] [Thread-8 (]: On model.dbt_project.hub_customer_v0: drop view if exists allianz.datavault.hub_customer_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
[0m17:27:32.206297 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.097 seconds
[0m17:27:32.208572 [debug] [Thread-9 (]: On model.dbt_project.hub_product_v0: Close
[0m17:27:32.258464 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 0.128 seconds
[0m17:27:32.261125 [debug] [Thread-8 (]: On model.dbt_project.hub_customer_v0: Close
[0m17:27:32.322322 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ea642f0>]}
[0m17:27:32.323491 [info ] [Thread-9 (]: 9 of 10 OK created sql incremental model datavault.hub_product_v0 .............. [[32mSUCCESS 4566[0m in 2.91s]
[0m17:27:32.323998 [debug] [Thread-9 (]: Finished running node model.dbt_project.hub_product_v0
[0m17:27:32.348641 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f86fd10>]}
[0m17:27:32.349194 [info ] [Thread-8 (]: 8 of 10 OK created sql incremental model datavault.hub_customer_v0 ............. [[32mSUCCESS 2000[0m in 3.03s]
[0m17:27:32.349566 [debug] [Thread-8 (]: Finished running node model.dbt_project.hub_customer_v0
[0m17:27:32.350106 [debug] [Thread-10 ]: Began running node model.dbt_project.lnk_orders_v0
[0m17:27:32.350410 [info ] [Thread-10 ]: 10 of 10 START sql incremental model datavault.lnk_orders_v0 ................... [RUN]
[0m17:27:32.350790 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.dbt_project.lnk_orders_v0'
[0m17:27:32.351003 [debug] [Thread-10 ]: Began compiling node model.dbt_project.lnk_orders_v0
[0m17:27:32.358080 [debug] [Thread-10 ]: Writing injected SQL for node "model.dbt_project.lnk_orders_v0"
[0m17:27:32.359843 [debug] [Thread-10 ]: Began executing node model.dbt_project.lnk_orders_v0
[0m17:27:32.362187 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:27:32.362438 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: select * from (
        -- depends_on: allianz.datavault.hub_customer_v0
-- depends_on: allianz.datavault.hub_product_v0
-- depends_on: allianz.datavault.sat_orders_v0



with source_data as (
    select distinct
        CAST(SHA2_BINARY(order_id || customer_id || product_id) as BINARY(32)) as lnk_orders_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(order_id) as BINARY(32)) as order_hk
        , CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
    from 
        allianz.stage.stg_sap_orders_v0
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
[0m17:27:32.362639 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m17:27:32.652422 [debug] [Thread-10 ]: SQL status: SUCCESS 0 in 0.289 seconds
[0m17:27:32.655802 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:27:32.656261 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: select * from (
        select
    
      
    cast(null as binary)
     as lnk_orders_hk, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE, 
      
    cast(null as binary)
     as order_hk, 
      
    cast(null as binary)
     as customer_hk, 
      
    cast(null as binary)
     as product_hk
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
[0m17:27:32.750893 [debug] [Thread-10 ]: SQL status: SUCCESS 0 in 0.094 seconds
[0m17:27:32.751798 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:27:32.751989 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: create or replace  temporary view allianz.datavault.lnk_orders_v0__dbt_tmp
  
  
  
  
  as (
    -- depends_on: allianz.datavault.hub_customer_v0
-- depends_on: allianz.datavault.hub_product_v0
-- depends_on: allianz.datavault.sat_orders_v0



with source_data as (
    select distinct
        CAST(SHA2_BINARY(order_id || customer_id || product_id) as BINARY(32)) as lnk_orders_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(order_id) as BINARY(32)) as order_hk
        , CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
    from 
        allianz.stage.stg_sap_orders_v0
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */;
[0m17:27:33.024430 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.272 seconds
[0m17:27:33.030014 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:27:33.030477 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: describe table allianz.datavault.lnk_orders_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
[0m17:27:33.097439 [debug] [Thread-10 ]: SQL status: SUCCESS 6 in 0.066 seconds
[0m17:27:33.102188 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:27:33.102663 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: describe table allianz.datavault.lnk_orders_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
[0m17:27:33.174313 [debug] [Thread-10 ]: SQL status: SUCCESS 6 in 0.071 seconds
[0m17:27:33.178125 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:27:33.178478 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: describe table allianz.datavault.lnk_orders_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
[0m17:27:33.243539 [debug] [Thread-10 ]: SQL status: SUCCESS 6 in 0.065 seconds
[0m17:27:33.244812 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:27:33.244960 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: describe table "ALLIANZ"."DATAVAULT"."LNK_ORDERS_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
[0m17:27:33.313022 [debug] [Thread-10 ]: SQL status: SUCCESS 6 in 0.068 seconds
[0m17:27:33.313748 [debug] [Thread-10 ]: 
    In "ALLIANZ"."DATAVAULT"."LNK_ORDERS_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:27:33.314145 [debug] [Thread-10 ]: Writing runtime sql for node "model.dbt_project.lnk_orders_v0"
[0m17:27:33.314762 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:27:33.314881 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */;
[0m17:27:33.430257 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.115 seconds
[0m17:27:33.430476 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:27:33.430613 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: merge into allianz.datavault.lnk_orders_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.lnk_orders_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_hk = DBT_INTERNAL_DEST.order_hk
                )

    
    when matched then update set
        "LNK_ORDERS_HK" = DBT_INTERNAL_SOURCE."LNK_ORDERS_HK","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE","ORDER_HK" = DBT_INTERNAL_SOURCE."ORDER_HK","CUSTOMER_HK" = DBT_INTERNAL_SOURCE."CUSTOMER_HK","PRODUCT_HK" = DBT_INTERNAL_SOURCE."PRODUCT_HK"
    

    when not matched then insert
        ("LNK_ORDERS_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "ORDER_HK", "CUSTOMER_HK", "PRODUCT_HK")
    values
        ("LNK_ORDERS_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "ORDER_HK", "CUSTOMER_HK", "PRODUCT_HK")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */;
[0m17:27:34.172225 [debug] [Thread-10 ]: SQL status: SUCCESS 5 in 0.741 seconds
[0m17:27:34.172543 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:27:34.172690 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
[0m17:27:34.578079 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.405 seconds
[0m17:27:34.582553 [debug] [Thread-10 ]: Applying DROP to: allianz.datavault.lnk_orders_v0__dbt_tmp
[0m17:27:34.584659 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:27:34.585005 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: drop view if exists allianz.datavault.lnk_orders_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
[0m17:27:34.691370 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.106 seconds
[0m17:27:34.694050 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: Close
[0m17:27:34.769883 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ec8770>]}
[0m17:27:34.771040 [info ] [Thread-10 ]: 10 of 10 OK created sql incremental model datavault.lnk_orders_v0 .............. [[32mSUCCESS 5[0m in 2.42s]
[0m17:27:34.771658 [debug] [Thread-10 ]: Finished running node model.dbt_project.lnk_orders_v0
[0m17:27:34.773888 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:27:34.774283 [debug] [MainThread]: Connection 'model.dbt_project.sat_customer_profession_v0' was properly closed.
[0m17:27:34.774528 [debug] [MainThread]: Connection 'model.dbt_project.sat_customer_spending_v0' was properly closed.
[0m17:27:34.774740 [debug] [MainThread]: Connection 'model.dbt_project.sat_customer_v0' was properly closed.
[0m17:27:34.774941 [debug] [MainThread]: Connection 'model.dbt_project.sat_product_discount_v0' was properly closed.
[0m17:27:34.775142 [debug] [MainThread]: Connection 'model.dbt_project.sat_orders_v0' was properly closed.
[0m17:27:34.775335 [debug] [MainThread]: Connection 'model.dbt_project.sat_product_category_v0' was properly closed.
[0m17:27:34.775534 [debug] [MainThread]: Connection 'model.dbt_project.sat_product_v0' was properly closed.
[0m17:27:34.775722 [debug] [MainThread]: Connection 'model.dbt_project.hub_customer_v0' was properly closed.
[0m17:27:34.775925 [debug] [MainThread]: Connection 'model.dbt_project.hub_product_v0' was properly closed.
[0m17:27:34.776113 [debug] [MainThread]: Connection 'model.dbt_project.lnk_orders_v0' was properly closed.
[0m17:27:34.776490 [info ] [MainThread]: 
[0m17:27:34.776824 [info ] [MainThread]: Finished running 10 incremental models in 0 hours 0 minutes and 13.57 seconds (13.57s).
[0m17:27:34.778626 [debug] [MainThread]: Command end result
[0m17:27:34.807804 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/manifest.json
[0m17:27:34.809156 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/semantic_manifest.json
[0m17:27:34.812632 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/run_results.json
[0m17:27:34.812793 [info ] [MainThread]: 
[0m17:27:34.812976 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:27:34.813103 [info ] [MainThread]: 
[0m17:27:34.813250 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m17:27:34.815460 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.411059, "process_in_blocks": "0", "process_kernel_time": 0.307507, "process_mem_max_rss": "187400192", "process_out_blocks": "0", "process_user_time": 2.271556}
[0m17:27:34.815716 [debug] [MainThread]: Command `dbt run` succeeded at 17:27:34.815665 after 14.41 seconds
[0m17:27:34.815897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f72bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a1ad6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a6c52b0>]}
[0m17:27:34.816060 [debug] [MainThread]: Flushing usage events
[0m17:27:35.373598 [debug] [MainThread]: An error was encountered while trying to flush usage events
