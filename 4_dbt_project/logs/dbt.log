[0m17:27:20.431762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1186fb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a3279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a327b10>]}


============================== 17:27:20.434143 | f66b76d9-a7d9-451b-9662-d7a4d248e4f4 ==============================
[0m17:27:20.434143 [info ] [MainThread]: Running with dbt=1.10.9
[0m17:27:20.434374 [debug] [MainThread]: running dbt with arguments {'send_anonymous_usage_stats': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'use_colors': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'target_path': 'None', 'introspect': 'True', 'indirect_selection': 'eager', 'invocation_command': 'dbt run --select tag:allianz_dbt_assignment', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'profiles_dir': '/Users/vijaypalanichamy/.dbt', 'fail_fast': 'False', 'static_parser': 'True', 'warn_error': 'None', 'log_path': '/Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/logs', 'debug': 'False', 'version_check': 'True', 'log_format': 'default', 'no_print': 'None', 'printer_width': '80', 'write_json': 'True', 'partial_parse': 'True'}
[0m17:27:20.646157 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11923f230>]}
[0m17:27:20.665181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11cdef9b0>]}
[0m17:27:20.665622 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:27:20.706374 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m17:27:20.706706 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m17:27:20.706950 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ce98850>]}
[0m17:27:21.166276 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d2b54f0>]}
[0m17:27:21.198444 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/manifest.json
[0m17:27:21.199440 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/semantic_manifest.json
[0m17:27:21.209632 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d348e50>]}
[0m17:27:21.209795 [info ] [MainThread]: Found 15 models, 32 data tests, 3 sources, 479 macros
[0m17:27:21.209913 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e56fee0>]}
[0m17:27:21.210709 [info ] [MainThread]: 
[0m17:27:21.210839 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:27:21.210927 [info ] [MainThread]: 
[0m17:27:21.211093 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:27:21.212759 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_allianz'
[0m17:27:21.236234 [debug] [ThreadPool]: Using snowflake connection "list_allianz"
[0m17:27:21.236410 [debug] [ThreadPool]: On list_allianz: show terse schemas in database allianz
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz"} */
[0m17:27:21.236498 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:23.817444 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.581 seconds
[0m17:27:23.819699 [debug] [ThreadPool]: On list_allianz: Close
[0m17:27:23.903632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_allianz, now list_allianz_stage)
[0m17:27:23.904480 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_allianz_datavault'
[0m17:27:23.920471 [debug] [ThreadPool]: Using snowflake connection "list_allianz_datavault"
[0m17:27:23.922332 [debug] [ThreadPool]: Using snowflake connection "list_allianz_stage"
[0m17:27:23.922589 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_allianz_validation'
[0m17:27:23.922741 [debug] [ThreadPool]: On list_allianz_datavault: show objects in allianz.datavault
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz_datavault"} */;
[0m17:27:23.922979 [debug] [ThreadPool]: On list_allianz_stage: show objects in allianz.stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz_stage"} */;
[0m17:27:23.924472 [debug] [ThreadPool]: Using snowflake connection "list_allianz_validation"
[0m17:27:23.924701 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:23.924895 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:27:23.925082 [debug] [ThreadPool]: On list_allianz_validation: show objects in allianz.validation
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz_validation"} */;
[0m17:27:23.925785 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:27:26.265911 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.340 seconds
[0m17:27:26.266669 [debug] [ThreadPool]: On list_allianz_validation: Close
[0m17:27:26.416689 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 2.492 seconds
[0m17:27:26.418222 [debug] [ThreadPool]: On list_allianz_datavault: Close
[0m17:27:26.570366 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.645 seconds
[0m17:27:26.573262 [debug] [ThreadPool]: On list_allianz_stage: Close
[0m17:27:26.661992 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e5d9010>]}
[0m17:27:26.667452 [debug] [Thread-6 (]: Began running node model.dbt_project.sat_product_discount_v0
[0m17:27:26.667906 [debug] [Thread-3 (]: Began running node model.dbt_project.sat_customer_v0
[0m17:27:26.668236 [debug] [Thread-4 (]: Began running node model.dbt_project.sat_orders_v0
[0m17:27:26.668538 [debug] [Thread-5 (]: Began running node model.dbt_project.sat_product_category_v0
[0m17:27:26.668847 [debug] [Thread-7 (]: Began running node model.dbt_project.sat_product_v0
[0m17:27:26.669131 [debug] [Thread-1 (]: Began running node model.dbt_project.sat_customer_profession_v0
[0m17:27:26.669383 [debug] [Thread-2 (]: Began running node model.dbt_project.sat_customer_spending_v0
[0m17:27:26.669909 [info ] [Thread-6 (]: 6 of 10 START sql incremental model datavault.sat_product_discount_v0 .......... [RUN]
[0m17:27:26.670353 [info ] [Thread-3 (]: 3 of 10 START sql incremental model datavault.sat_customer_v0 .................. [RUN]
[0m17:27:26.670769 [info ] [Thread-4 (]: 4 of 10 START sql incremental model datavault.sat_orders_v0 .................... [RUN]
[0m17:27:26.671127 [info ] [Thread-5 (]: 5 of 10 START sql incremental model datavault.sat_product_category_v0 .......... [RUN]
[0m17:27:26.671482 [info ] [Thread-7 (]: 7 of 10 START sql incremental model datavault.sat_product_v0 ................... [RUN]
[0m17:27:26.671901 [info ] [Thread-1 (]: 1 of 10 START sql incremental model datavault.sat_customer_profession_v0 ....... [RUN]
[0m17:27:26.672297 [info ] [Thread-2 (]: 2 of 10 START sql incremental model datavault.sat_customer_spending_v0 ......... [RUN]
[0m17:27:26.672797 [debug] [Thread-6 (]: Acquiring new snowflake connection 'model.dbt_project.sat_product_discount_v0'
[0m17:27:26.673127 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_allianz_validation, now model.dbt_project.sat_customer_v0)
[0m17:27:26.673437 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_project.sat_orders_v0'
[0m17:27:26.673784 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.dbt_project.sat_product_category_v0'
[0m17:27:26.674081 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.dbt_project.sat_product_v0'
[0m17:27:26.674308 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_allianz_stage, now model.dbt_project.sat_customer_profession_v0)
[0m17:27:26.674531 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_allianz_datavault, now model.dbt_project.sat_customer_spending_v0)
[0m17:27:26.674786 [debug] [Thread-6 (]: Began compiling node model.dbt_project.sat_product_discount_v0
[0m17:27:26.675097 [debug] [Thread-3 (]: Began compiling node model.dbt_project.sat_customer_v0
[0m17:27:26.675562 [debug] [Thread-4 (]: Began compiling node model.dbt_project.sat_orders_v0
[0m17:27:26.675864 [debug] [Thread-5 (]: Began compiling node model.dbt_project.sat_product_category_v0
[0m17:27:26.676140 [debug] [Thread-7 (]: Began compiling node model.dbt_project.sat_product_v0
[0m17:27:26.676405 [debug] [Thread-1 (]: Began compiling node model.dbt_project.sat_customer_profession_v0
[0m17:27:26.676895 [debug] [Thread-2 (]: Began compiling node model.dbt_project.sat_customer_spending_v0
[0m17:27:26.685617 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.sat_customer_v0"
[0m17:27:26.687929 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.sat_orders_v0"
[0m17:27:26.690005 [debug] [Thread-6 (]: Writing injected SQL for node "model.dbt_project.sat_product_discount_v0"
[0m17:27:26.691955 [debug] [Thread-5 (]: Writing injected SQL for node "model.dbt_project.sat_product_category_v0"
[0m17:27:26.694350 [debug] [Thread-7 (]: Writing injected SQL for node "model.dbt_project.sat_product_v0"
[0m17:27:26.695923 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.sat_customer_profession_v0"
[0m17:27:26.697360 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.sat_customer_spending_v0"
[0m17:27:26.698549 [debug] [Thread-5 (]: Began executing node model.dbt_project.sat_product_category_v0
[0m17:27:26.711137 [debug] [Thread-4 (]: Began executing node model.dbt_project.sat_orders_v0
[0m17:27:26.729633 [debug] [Thread-1 (]: Began executing node model.dbt_project.sat_customer_profession_v0
[0m17:27:26.731607 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:27:26.731759 [debug] [Thread-7 (]: Began executing node model.dbt_project.sat_product_v0
[0m17:27:26.732487 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:27:26.732637 [debug] [Thread-3 (]: Began executing node model.dbt_project.sat_customer_v0
[0m17:27:26.735659 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:27:26.735806 [debug] [Thread-6 (]: Began executing node model.dbt_project.sat_product_discount_v0
[0m17:27:26.735920 [debug] [Thread-2 (]: Began executing node model.dbt_project.sat_customer_spending_v0
[0m17:27:26.736054 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: select * from (
        

with source_data as (
    select distinct
        CAST(SHA2_BINARY(order_id) as BINARY(32)) as order_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(source || order_id || quantity || amount) as BINARY(32)) as DV_HASH_DIFF
        , order_id
        , quantity
        , amount
    from 
        allianz.stage.stg_sap_orders_v0
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
[0m17:27:26.737257 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:27:26.737405 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: select * from (
        

with source_data as (
    select distinct
        CAST(SHA2_BINARY(product_id || source || category_name) as BINARY(32)) as product_category_hk
        , CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , category_name
    from 
        allianz.stage.stg_product_v0      
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
[0m17:27:26.738757 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:27:26.738929 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: select * from (
        

with source_data as (
    select distinct
        CAST(SHA2_BINARY(customer_id || source || profession || annual_income_inr || work_experience) as BINARY(32)) as customer_profession_hk
        , CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , profession
        , CASE
            WHEN lower(profession) IS NULL THEN 'UNKNOWN'
            WHEN lower(profession) IN ('doctor','healthcare') THEN 'HIGH'
            WHEN lower(profession) IN ('artist','homemaker') THEN 'MEDIUM'
            ELSE 'LOW'
        END as risk_category
        , annual_income_inr
        , CASE
            WHEN annual_income_inr BETWEEN       0 and   100000 THEN 'LOW'
            WHEN annual_income_inr BETWEEN  100001 and  1000000 THEN 'MEDIUM'
            WHEN annual_income_inr BETWEEN 1000001 and 10000000 THEN 'HIGH'
            WHEN annual_income_inr > 10000000 THEN 'HNI'
            ELSE 'NA'
        END as annual_income_bucket
        , work_experience
    from 
        allianz.stage.stg_customer_v0
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
[0m17:27:26.740225 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:27:26.741426 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:27:26.741569 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:27:26.741704 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: select * from (
        

with source_data as (
    select distinct
        CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(source || product_id || product_name || product_description || product_sizes || brand_name) as BINARY(32)) as DV_HASH_DIFF
        , product_id
        , product_name
        , product_description
        , product_sizes
        , brand_name
    from 
        allianz.stage.stg_product_v0
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
[0m17:27:26.741854 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m17:27:26.742004 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: select * from (
        

with source_data as (
    select distinct
        CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(source || gender || age || family_size) as BINARY(32)) as DV_HASH_DIFF
        , customer_id
        , gender
        , age
        , family_size
    from 
        allianz.stage.stg_customer_v0
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
[0m17:27:26.742129 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:27:26.742252 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: select * from (
        

with source_data as (
    select distinct
        CAST(SHA2_BINARY(product_id || source || discount_name) as BINARY(32)) as product_discount_hk
        , CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
        , SYSDATE()  as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , discount_name
        , CAST( LEFT( discount_name , POSITION( '%' IN discount_name)-1 ) as NUMBER(38,2)) as discount_percentage
    from 
        allianz.stage.stg_product_v0
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
[0m17:27:26.742390 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: select * from (
        

with source_data as (
    select
        CAST(SHA2_BINARY(customer_id || source || spending_score) as BINARY(32)) as customer_spending_hk
        , CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , spending_score
        , CASE
            WHEN spending_score BETWEEN 0 and 25 THEN '00-25'
            WHEN spending_score BETWEEN 26 and 50 THEN '26-50'
            WHEN spending_score BETWEEN 51 and 75 THEN '51-75'
            WHEN spending_score BETWEEN 76 and 100 THEN '76-100'
            ELSE 'NA'
        END as spending_bucket
    from 
        allianz.stage.stg_customer_v0
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
[0m17:27:26.742568 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m17:27:26.742971 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:27:26.743330 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m17:27:26.743985 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:27:27.192637 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.450 seconds
[0m17:27:27.203082 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:27:27.203397 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: select * from (
        select
    
      
    cast(null as binary)
     as customer_profession_hk, 
      
    cast(null as binary)
     as customer_hk, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE, 
      
    cast(null as TEXT)
     as profession, 
      
    cast(null as TEXT)
     as risk_category, 
      
    cast(null as integer)
     as annual_income_inr, 
      
    cast(null as TEXT)
     as annual_income_bucket, 
      
    cast(null as integer)
     as work_experience
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
[0m17:27:27.204234 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.461 seconds
[0m17:27:27.205199 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:27:27.205590 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: select * from (
        select
    
      
    cast(null as binary)
     as customer_hk, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE, 
      
    cast(null as binary)
     as DV_HASH_DIFF, 
      
    cast(null as integer)
     as customer_id, 
      
    cast(null as TEXT)
     as gender, 
      
    cast(null as integer)
     as age, 
      
    cast(null as integer)
     as family_size
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
[0m17:27:27.211426 [debug] [Thread-7 (]: SQL status: SUCCESS 0 in 0.469 seconds
[0m17:27:27.212446 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:27:27.212659 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: select * from (
        select
    
      
    cast(null as binary)
     as product_hk, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE, 
      
    cast(null as binary)
     as DV_HASH_DIFF, 
      
    cast(null as TEXT)
     as product_id, 
      
    cast(null as TEXT)
     as product_name, 
      
    cast(null as TEXT)
     as product_description, 
      
    cast(null as TEXT)
     as product_sizes, 
      
    cast(null as TEXT)
     as brand_name
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
[0m17:27:27.284013 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.078 seconds
[0m17:27:27.284700 [debug] [Thread-7 (]: SQL status: SUCCESS 0 in 0.072 seconds
[0m17:27:27.289820 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:27:27.291066 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:27:27.291527 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: create or replace  temporary view allianz.datavault.sat_customer_v0__dbt_tmp
  
  
  
  
  as (
    

with source_data as (
    select distinct
        CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(source || gender || age || family_size) as BINARY(32)) as DV_HASH_DIFF
        , customer_id
        , gender
        , age
        , family_size
    from 
        allianz.stage.stg_customer_v0
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */;
[0m17:27:27.291821 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: create or replace  temporary view allianz.datavault.sat_product_v0__dbt_tmp
  
  
  
  
  as (
    

with source_data as (
    select distinct
        CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(source || product_id || product_name || product_description || product_sizes || brand_name) as BINARY(32)) as DV_HASH_DIFF
        , product_id
        , product_name
        , product_description
        , product_sizes
        , brand_name
    from 
        allianz.stage.stg_product_v0
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */;
[0m17:27:27.306161 [debug] [Thread-4 (]: SQL status: SUCCESS 0 in 0.565 seconds
[0m17:27:27.307128 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:27:27.307354 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: select * from (
        select
    
      
    cast(null as binary)
     as order_hk, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE, 
      
    cast(null as binary)
     as DV_HASH_DIFF, 
      
    cast(null as integer)
     as order_id, 
      
    cast(null as integer)
     as quantity, 
      
    cast(null as integer)
     as amount
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
[0m17:27:27.328152 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.124 seconds
[0m17:27:27.329625 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:27:27.329865 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: create or replace  temporary view allianz.datavault.sat_customer_profession_v0__dbt_tmp
  
  
  
  
  as (
    

with source_data as (
    select distinct
        CAST(SHA2_BINARY(customer_id || source || profession || annual_income_inr || work_experience) as BINARY(32)) as customer_profession_hk
        , CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , profession
        , CASE
            WHEN lower(profession) IS NULL THEN 'UNKNOWN'
            WHEN lower(profession) IN ('doctor','healthcare') THEN 'HIGH'
            WHEN lower(profession) IN ('artist','homemaker') THEN 'MEDIUM'
            ELSE 'LOW'
        END as risk_category
        , annual_income_inr
        , CASE
            WHEN annual_income_inr BETWEEN       0 and   100000 THEN 'LOW'
            WHEN annual_income_inr BETWEEN  100001 and  1000000 THEN 'MEDIUM'
            WHEN annual_income_inr BETWEEN 1000001 and 10000000 THEN 'HIGH'
            WHEN annual_income_inr > 10000000 THEN 'HNI'
            ELSE 'NA'
        END as annual_income_bucket
        , work_experience
    from 
        allianz.stage.stg_customer_v0
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */;
[0m17:27:27.370056 [debug] [Thread-4 (]: SQL status: SUCCESS 0 in 0.062 seconds
[0m17:27:27.371476 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:27:27.371901 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: create or replace  temporary view allianz.datavault.sat_orders_v0__dbt_tmp
  
  
  
  
  as (
    

with source_data as (
    select distinct
        CAST(SHA2_BINARY(order_id) as BINARY(32)) as order_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(source || order_id || quantity || amount) as BINARY(32)) as DV_HASH_DIFF
        , order_id
        , quantity
        , amount
    from 
        allianz.stage.stg_sap_orders_v0
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */;
[0m17:27:27.431697 [debug] [Thread-6 (]: SQL status: SUCCESS 0 in 0.688 seconds
[0m17:27:27.433787 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:27:27.434319 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: select * from (
        select
    
      
    cast(null as binary)
     as product_discount_hk, 
      
    cast(null as binary)
     as product_hk, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE, 
      
    cast(null as TEXT)
     as discount_name, 
      
    cast(null as number(38,2))
     as discount_percentage
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
[0m17:27:27.477892 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 0.185 seconds
[0m17:27:27.479128 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.149 seconds
[0m17:27:27.491522 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:27:27.494721 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:27:27.495181 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: describe table allianz.datavault.sat_product_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
[0m17:27:27.495508 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: describe table allianz.datavault.sat_customer_profession_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
[0m17:27:27.509107 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.765 seconds
[0m17:27:27.510540 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:27:27.510853 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: select * from (
        select
    
      
    cast(null as binary)
     as customer_spending_hk, 
      
    cast(null as binary)
     as customer_hk, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE, 
      
    cast(null as integer)
     as spending_score, 
      
    cast(null as TEXT)
     as spending_bucket
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
[0m17:27:27.517386 [debug] [Thread-5 (]: SQL status: SUCCESS 0 in 0.775 seconds
[0m17:27:27.518501 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:27:27.518800 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: select * from (
        select
    
      
    cast(null as binary)
     as product_category_hk, 
      
    cast(null as binary)
     as product_hk, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE, 
      
    cast(null as TEXT)
     as category_name
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
[0m17:27:27.550440 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.178 seconds
[0m17:27:27.553194 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:27:27.553489 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: describe table allianz.datavault.sat_orders_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
[0m17:27:27.558277 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.266 seconds
[0m17:27:27.558822 [debug] [Thread-6 (]: SQL status: SUCCESS 0 in 0.124 seconds
[0m17:27:27.560434 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:27:27.561457 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:27:27.561654 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: describe table allianz.datavault.sat_customer_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
[0m17:27:27.561855 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: create or replace  temporary view allianz.datavault.sat_product_discount_v0__dbt_tmp
  
  
  
  
  as (
    

with source_data as (
    select distinct
        CAST(SHA2_BINARY(product_id || source || discount_name) as BINARY(32)) as product_discount_hk
        , CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
        , SYSDATE()  as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , discount_name
        , CAST( LEFT( discount_name , POSITION( '%' IN discount_name)-1 ) as NUMBER(38,2)) as discount_percentage
    from 
        allianz.stage.stg_product_v0
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */;
[0m17:27:27.579678 [debug] [Thread-5 (]: SQL status: SUCCESS 0 in 0.061 seconds
[0m17:27:27.580182 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.069 seconds
[0m17:27:27.581228 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:27:27.582407 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:27:27.582615 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: create or replace  temporary view allianz.datavault.sat_product_category_v0__dbt_tmp
  
  
  
  
  as (
    

with source_data as (
    select distinct
        CAST(SHA2_BINARY(product_id || source || category_name) as BINARY(32)) as product_category_hk
        , CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , category_name
    from 
        allianz.stage.stg_product_v0      
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */;
[0m17:27:27.582852 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: create or replace  temporary view allianz.datavault.sat_customer_spending_v0__dbt_tmp
  
  
  
  
  as (
    

with source_data as (
    select
        CAST(SHA2_BINARY(customer_id || source || spending_score) as BINARY(32)) as customer_spending_hk
        , CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , spending_score
        , CASE
            WHEN spending_score BETWEEN 0 and 25 THEN '00-25'
            WHEN spending_score BETWEEN 26 and 50 THEN '26-50'
            WHEN spending_score BETWEEN 51 and 75 THEN '51-75'
            WHEN spending_score BETWEEN 76 and 100 THEN '76-100'
            ELSE 'NA'
        END as spending_bucket
    from 
        allianz.stage.stg_customer_v0
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */;
[0m17:27:27.593773 [debug] [Thread-7 (]: SQL status: SUCCESS 9 in 0.098 seconds
[0m17:27:27.599063 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:27:27.599312 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: describe table allianz.datavault.sat_product_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
[0m17:27:27.600580 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.104 seconds
[0m17:27:27.602620 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:27:27.602863 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: describe table allianz.datavault.sat_customer_profession_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
[0m17:27:27.641090 [debug] [Thread-4 (]: SQL status: SUCCESS 7 in 0.087 seconds
[0m17:27:27.643484 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:27:27.643703 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: describe table allianz.datavault.sat_orders_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
[0m17:27:27.677421 [debug] [Thread-3 (]: SQL status: SUCCESS 8 in 0.115 seconds
[0m17:27:27.679797 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:27:27.680074 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: describe table allianz.datavault.sat_customer_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
[0m17:27:27.681335 [debug] [Thread-7 (]: SQL status: SUCCESS 9 in 0.082 seconds
[0m17:27:27.691246 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:27:27.691828 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: describe table allianz.datavault.sat_product_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
[0m17:27:27.693418 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.090 seconds
[0m17:27:27.695397 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:27:27.695810 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: describe table allianz.datavault.sat_customer_profession_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
[0m17:27:27.707646 [debug] [Thread-4 (]: SQL status: SUCCESS 7 in 0.064 seconds
[0m17:27:27.707999 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.146 seconds
[0m17:27:27.709537 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:27:27.710778 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:27:27.710937 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: describe table allianz.datavault.sat_orders_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
[0m17:27:27.711084 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: describe table allianz.datavault.sat_product_discount_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
[0m17:27:27.762811 [debug] [Thread-3 (]: SQL status: SUCCESS 8 in 0.082 seconds
[0m17:27:27.764773 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:27:27.764989 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: describe table allianz.datavault.sat_customer_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
[0m17:27:27.773294 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.077 seconds
[0m17:27:27.775428 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:27:27.775655 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: describe table "ALLIANZ"."DATAVAULT"."SAT_CUSTOMER_PROFESSION_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
[0m17:27:27.778420 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.195 seconds
[0m17:27:27.779717 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:27:27.779914 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: describe table allianz.datavault.sat_customer_spending_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
[0m17:27:27.780548 [debug] [Thread-7 (]: SQL status: SUCCESS 9 in 0.089 seconds
[0m17:27:27.782184 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:27:27.782630 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: describe table "ALLIANZ"."DATAVAULT"."SAT_PRODUCT_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
[0m17:27:27.786978 [debug] [Thread-4 (]: SQL status: SUCCESS 7 in 0.076 seconds
[0m17:27:27.788594 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:27:27.788780 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: describe table "ALLIANZ"."DATAVAULT"."SAT_ORDERS_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
[0m17:27:27.791464 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.208 seconds
[0m17:27:27.792707 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:27:27.792880 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: describe table allianz.datavault.sat_product_category_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
[0m17:27:27.813556 [debug] [Thread-6 (]: SQL status: SUCCESS 6 in 0.102 seconds
[0m17:27:27.815365 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:27:27.815547 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: describe table allianz.datavault.sat_product_discount_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
[0m17:27:27.827295 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.051 seconds
[0m17:27:27.831668 [debug] [Thread-1 (]: 
    In "ALLIANZ"."DATAVAULT"."SAT_CUSTOMER_PROFESSION_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:27:27.843249 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.sat_customer_profession_v0"
[0m17:27:27.843814 [debug] [Thread-3 (]: SQL status: SUCCESS 8 in 0.079 seconds
[0m17:27:27.845281 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:27:27.845438 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: describe table "ALLIANZ"."DATAVAULT"."SAT_CUSTOMER_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
[0m17:27:27.845748 [debug] [Thread-7 (]: SQL status: SUCCESS 9 in 0.063 seconds
[0m17:27:27.846717 [debug] [Thread-7 (]: 
    In "ALLIANZ"."DATAVAULT"."SAT_PRODUCT_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:27:27.847152 [debug] [Thread-7 (]: Writing runtime sql for node "model.dbt_project.sat_product_v0"
[0m17:27:27.848154 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:27:27.848602 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:27:27.848729 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */;
[0m17:27:27.848924 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */;
[0m17:27:27.853598 [debug] [Thread-4 (]: SQL status: SUCCESS 7 in 0.065 seconds
[0m17:27:27.854316 [debug] [Thread-4 (]: 
    In "ALLIANZ"."DATAVAULT"."SAT_ORDERS_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:27:27.854712 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.sat_orders_v0"
[0m17:27:27.855420 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:27:27.855532 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */;
[0m17:27:27.859084 [debug] [Thread-5 (]: SQL status: SUCCESS 5 in 0.066 seconds
[0m17:27:27.860375 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:27:27.860498 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: describe table allianz.datavault.sat_product_category_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
[0m17:27:27.884239 [debug] [Thread-6 (]: SQL status: SUCCESS 6 in 0.069 seconds
[0m17:27:27.885482 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:27:27.885795 [debug] [Thread-2 (]: SQL status: SUCCESS 6 in 0.106 seconds
[0m17:27:27.885936 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: describe table allianz.datavault.sat_product_discount_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
[0m17:27:27.887169 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:27:27.887703 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: describe table allianz.datavault.sat_customer_spending_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
[0m17:27:27.923135 [debug] [Thread-3 (]: SQL status: SUCCESS 8 in 0.077 seconds
[0m17:27:27.924360 [debug] [Thread-3 (]: 
    In "ALLIANZ"."DATAVAULT"."SAT_CUSTOMER_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:27:27.925021 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.sat_customer_v0"
[0m17:27:27.925902 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:27:27.926074 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */;
[0m17:27:27.930815 [debug] [Thread-5 (]: SQL status: SUCCESS 5 in 0.070 seconds
[0m17:27:27.932387 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:27:27.932580 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: describe table allianz.datavault.sat_product_category_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
[0m17:27:27.943310 [debug] [Thread-2 (]: SQL status: SUCCESS 6 in 0.055 seconds
[0m17:27:27.945071 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:27:27.945249 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: describe table allianz.datavault.sat_customer_spending_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
[0m17:27:27.959973 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.111 seconds
[0m17:27:27.960150 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:27:27.960328 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: merge into allianz.datavault.sat_customer_profession_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.sat_customer_profession_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.customer_profession_hk = DBT_INTERNAL_DEST.customer_profession_hk
                )

    
    when matched then update set
        "CUSTOMER_PROFESSION_HK" = DBT_INTERNAL_SOURCE."CUSTOMER_PROFESSION_HK","CUSTOMER_HK" = DBT_INTERNAL_SOURCE."CUSTOMER_HK","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE","PROFESSION" = DBT_INTERNAL_SOURCE."PROFESSION","RISK_CATEGORY" = DBT_INTERNAL_SOURCE."RISK_CATEGORY","ANNUAL_INCOME_INR" = DBT_INTERNAL_SOURCE."ANNUAL_INCOME_INR","ANNUAL_INCOME_BUCKET" = DBT_INTERNAL_SOURCE."ANNUAL_INCOME_BUCKET","WORK_EXPERIENCE" = DBT_INTERNAL_SOURCE."WORK_EXPERIENCE"
    

    when not matched then insert
        ("CUSTOMER_PROFESSION_HK", "CUSTOMER_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "PROFESSION", "RISK_CATEGORY", "ANNUAL_INCOME_INR", "ANNUAL_INCOME_BUCKET", "WORK_EXPERIENCE")
    values
        ("CUSTOMER_PROFESSION_HK", "CUSTOMER_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "PROFESSION", "RISK_CATEGORY", "ANNUAL_INCOME_INR", "ANNUAL_INCOME_BUCKET", "WORK_EXPERIENCE")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */;
[0m17:27:27.960928 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 0.112 seconds
[0m17:27:27.961219 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:27:27.961560 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: merge into allianz.datavault.sat_product_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.sat_product_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.product_hk = DBT_INTERNAL_DEST.product_hk
                ) and (
                    DBT_INTERNAL_SOURCE.DV_HASH_DIFF = DBT_INTERNAL_DEST.DV_HASH_DIFF
                )

    
    when matched then update set
        "PRODUCT_HK" = DBT_INTERNAL_SOURCE."PRODUCT_HK","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE","DV_HASH_DIFF" = DBT_INTERNAL_SOURCE."DV_HASH_DIFF","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRODUCT_NAME" = DBT_INTERNAL_SOURCE."PRODUCT_NAME","PRODUCT_DESCRIPTION" = DBT_INTERNAL_SOURCE."PRODUCT_DESCRIPTION","PRODUCT_SIZES" = DBT_INTERNAL_SOURCE."PRODUCT_SIZES","BRAND_NAME" = DBT_INTERNAL_SOURCE."BRAND_NAME"
    

    when not matched then insert
        ("PRODUCT_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "DV_HASH_DIFF", "PRODUCT_ID", "PRODUCT_NAME", "PRODUCT_DESCRIPTION", "PRODUCT_SIZES", "BRAND_NAME")
    values
        ("PRODUCT_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "DV_HASH_DIFF", "PRODUCT_ID", "PRODUCT_NAME", "PRODUCT_DESCRIPTION", "PRODUCT_SIZES", "BRAND_NAME")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */;
[0m17:27:27.964121 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.108 seconds
[0m17:27:27.964308 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:27:27.964480 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: merge into allianz.datavault.sat_orders_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.sat_orders_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_hk = DBT_INTERNAL_DEST.order_hk
                ) and (
                    DBT_INTERNAL_SOURCE.DV_HASH_DIFF = DBT_INTERNAL_DEST.DV_HASH_DIFF
                )

    
    when matched then update set
        "ORDER_HK" = DBT_INTERNAL_SOURCE."ORDER_HK","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE","DV_HASH_DIFF" = DBT_INTERNAL_SOURCE."DV_HASH_DIFF","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","AMOUNT" = DBT_INTERNAL_SOURCE."AMOUNT"
    

    when not matched then insert
        ("ORDER_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "DV_HASH_DIFF", "ORDER_ID", "QUANTITY", "AMOUNT")
    values
        ("ORDER_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "DV_HASH_DIFF", "ORDER_ID", "QUANTITY", "AMOUNT")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */;
[0m17:27:27.968746 [debug] [Thread-6 (]: SQL status: SUCCESS 6 in 0.081 seconds
[0m17:27:27.970311 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:27:27.970492 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: describe table "ALLIANZ"."DATAVAULT"."SAT_PRODUCT_DISCOUNT_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
[0m17:27:28.003354 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.077 seconds
[0m17:27:28.003573 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:27:28.003785 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: merge into allianz.datavault.sat_customer_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.sat_customer_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.customer_hk = DBT_INTERNAL_DEST.customer_hk
                ) and (
                    DBT_INTERNAL_SOURCE.DV_HASH_DIFF = DBT_INTERNAL_DEST.DV_HASH_DIFF
                )

    
    when matched then update set
        "CUSTOMER_HK" = DBT_INTERNAL_SOURCE."CUSTOMER_HK","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE","DV_HASH_DIFF" = DBT_INTERNAL_SOURCE."DV_HASH_DIFF","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","GENDER" = DBT_INTERNAL_SOURCE."GENDER","AGE" = DBT_INTERNAL_SOURCE."AGE","FAMILY_SIZE" = DBT_INTERNAL_SOURCE."FAMILY_SIZE"
    

    when not matched then insert
        ("CUSTOMER_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "DV_HASH_DIFF", "CUSTOMER_ID", "GENDER", "AGE", "FAMILY_SIZE")
    values
        ("CUSTOMER_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "DV_HASH_DIFF", "CUSTOMER_ID", "GENDER", "AGE", "FAMILY_SIZE")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */;
[0m17:27:28.014621 [debug] [Thread-5 (]: SQL status: SUCCESS 5 in 0.082 seconds
[0m17:27:28.016928 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:27:28.017440 [debug] [Thread-2 (]: SQL status: SUCCESS 6 in 0.072 seconds
[0m17:27:28.017695 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: describe table "ALLIANZ"."DATAVAULT"."SAT_PRODUCT_CATEGORY_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
[0m17:27:28.019485 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:27:28.020018 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: describe table "ALLIANZ"."DATAVAULT"."SAT_CUSTOMER_SPENDING_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
[0m17:27:28.026294 [debug] [Thread-6 (]: SQL status: SUCCESS 6 in 0.056 seconds
[0m17:27:28.027445 [debug] [Thread-6 (]: 
    In "ALLIANZ"."DATAVAULT"."SAT_PRODUCT_DISCOUNT_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:27:28.028111 [debug] [Thread-6 (]: Writing runtime sql for node "model.dbt_project.sat_product_discount_v0"
[0m17:27:28.029008 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:27:28.029198 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */;
[0m17:27:28.130738 [debug] [Thread-5 (]: SQL status: SUCCESS 5 in 0.111 seconds
[0m17:27:28.132435 [debug] [Thread-5 (]: 
    In "ALLIANZ"."DATAVAULT"."SAT_PRODUCT_CATEGORY_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:27:28.133146 [debug] [Thread-5 (]: Writing runtime sql for node "model.dbt_project.sat_product_category_v0"
[0m17:27:28.134116 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:27:28.134332 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */;
[0m17:27:28.137987 [debug] [Thread-2 (]: SQL status: SUCCESS 6 in 0.118 seconds
[0m17:27:28.139151 [debug] [Thread-2 (]: 
    In "ALLIANZ"."DATAVAULT"."SAT_CUSTOMER_SPENDING_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:27:28.139756 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.sat_customer_spending_v0"
[0m17:27:28.140776 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:27:28.141097 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */;
[0m17:27:28.142580 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.113 seconds
[0m17:27:28.142882 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:27:28.143193 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: merge into allianz.datavault.sat_product_discount_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.sat_product_discount_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.product_discount_hk = DBT_INTERNAL_DEST.product_discount_hk
                )

    
    when matched then update set
        "PRODUCT_DISCOUNT_HK" = DBT_INTERNAL_SOURCE."PRODUCT_DISCOUNT_HK","PRODUCT_HK" = DBT_INTERNAL_SOURCE."PRODUCT_HK","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE","DISCOUNT_NAME" = DBT_INTERNAL_SOURCE."DISCOUNT_NAME","DISCOUNT_PERCENTAGE" = DBT_INTERNAL_SOURCE."DISCOUNT_PERCENTAGE"
    

    when not matched then insert
        ("PRODUCT_DISCOUNT_HK", "PRODUCT_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "DISCOUNT_NAME", "DISCOUNT_PERCENTAGE")
    values
        ("PRODUCT_DISCOUNT_HK", "PRODUCT_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "DISCOUNT_NAME", "DISCOUNT_PERCENTAGE")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */;
[0m17:27:28.206185 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.072 seconds
[0m17:27:28.206371 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:27:28.206498 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: merge into allianz.datavault.sat_product_category_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.sat_product_category_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.product_category_hk = DBT_INTERNAL_DEST.product_category_hk
                )

    
    when matched then update set
        "PRODUCT_CATEGORY_HK" = DBT_INTERNAL_SOURCE."PRODUCT_CATEGORY_HK","PRODUCT_HK" = DBT_INTERNAL_SOURCE."PRODUCT_HK","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE","CATEGORY_NAME" = DBT_INTERNAL_SOURCE."CATEGORY_NAME"
    

    when not matched then insert
        ("PRODUCT_CATEGORY_HK", "PRODUCT_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "CATEGORY_NAME")
    values
        ("PRODUCT_CATEGORY_HK", "PRODUCT_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "CATEGORY_NAME")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */;
[0m17:27:28.242994 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.102 seconds
[0m17:27:28.243126 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:27:28.243256 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: merge into allianz.datavault.sat_customer_spending_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.sat_customer_spending_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.customer_spending_hk = DBT_INTERNAL_DEST.customer_spending_hk
                )

    
    when matched then update set
        "CUSTOMER_SPENDING_HK" = DBT_INTERNAL_SOURCE."CUSTOMER_SPENDING_HK","CUSTOMER_HK" = DBT_INTERNAL_SOURCE."CUSTOMER_HK","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE","SPENDING_SCORE" = DBT_INTERNAL_SOURCE."SPENDING_SCORE","SPENDING_BUCKET" = DBT_INTERNAL_SOURCE."SPENDING_BUCKET"
    

    when not matched then insert
        ("CUSTOMER_SPENDING_HK", "CUSTOMER_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "SPENDING_SCORE", "SPENDING_BUCKET")
    values
        ("CUSTOMER_SPENDING_HK", "CUSTOMER_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "SPENDING_SCORE", "SPENDING_BUCKET")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */;
[0m17:27:28.492224 [debug] [Thread-4 (]: SQL status: SUCCESS 5 in 0.528 seconds
[0m17:27:28.492438 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:27:28.492543 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
[0m17:27:28.530046 [debug] [Thread-7 (]: SQL status: SUCCESS 4566 in 0.568 seconds
[0m17:27:28.530191 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:27:28.530300 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
[0m17:27:28.699202 [debug] [Thread-3 (]: SQL status: SUCCESS 2000 in 0.695 seconds
[0m17:27:28.699329 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:27:28.699426 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
[0m17:27:28.761833 [debug] [Thread-1 (]: SQL status: SUCCESS 2000 in 0.801 seconds
[0m17:27:28.762006 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:27:28.762114 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
[0m17:27:28.792970 [debug] [Thread-2 (]: SQL status: SUCCESS 2000 in 0.550 seconds
[0m17:27:28.793091 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:27:28.793183 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
[0m17:27:28.816876 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.324 seconds
[0m17:27:28.819897 [debug] [Thread-4 (]: Applying DROP to: allianz.datavault.sat_orders_v0__dbt_tmp
[0m17:27:28.822213 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:27:28.822335 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: drop view if exists allianz.datavault.sat_orders_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
[0m17:27:28.823528 [debug] [Thread-6 (]: SQL status: SUCCESS 4566 in 0.680 seconds
[0m17:27:28.823667 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:27:28.823778 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
[0m17:27:28.829953 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 0.300 seconds
[0m17:27:28.831040 [debug] [Thread-7 (]: Applying DROP to: allianz.datavault.sat_product_v0__dbt_tmp
[0m17:27:28.831282 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:27:28.831395 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: drop view if exists allianz.datavault.sat_product_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
[0m17:27:28.927534 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.105 seconds
[0m17:27:28.934446 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: Close
[0m17:27:28.935616 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 0.104 seconds
[0m17:27:28.936173 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: Close
[0m17:27:28.974746 [debug] [Thread-5 (]: SQL status: SUCCESS 4566 in 0.768 seconds
[0m17:27:28.975065 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:27:28.975188 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
[0m17:27:28.997055 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.298 seconds
[0m17:27:28.997958 [debug] [Thread-3 (]: Applying DROP to: allianz.datavault.sat_customer_v0__dbt_tmp
[0m17:27:28.998195 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:27:28.998304 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: drop view if exists allianz.datavault.sat_customer_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
[0m17:27:29.024680 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.262 seconds
[0m17:27:29.025813 [debug] [Thread-1 (]: Applying DROP to: allianz.datavault.sat_customer_profession_v0__dbt_tmp
[0m17:27:29.026106 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:27:29.026227 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: drop view if exists allianz.datavault.sat_customer_profession_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
[0m17:27:29.027810 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fd976a0>]}
[0m17:27:29.028051 [info ] [Thread-4 (]: 4 of 10 OK created sql incremental model datavault.sat_orders_v0 ............... [[32mSUCCESS 5[0m in 2.35s]
[0m17:27:29.028249 [debug] [Thread-4 (]: Finished running node model.dbt_project.sat_orders_v0
[0m17:27:29.031537 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11d337070>]}
[0m17:27:29.031741 [info ] [Thread-7 (]: 7 of 10 OK created sql incremental model datavault.sat_product_v0 .............. [[32mSUCCESS 4566[0m in 2.36s]
[0m17:27:29.031923 [debug] [Thread-7 (]: Finished running node model.dbt_project.sat_product_v0
[0m17:27:29.051023 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.258 seconds
[0m17:27:29.052037 [debug] [Thread-2 (]: Applying DROP to: allianz.datavault.sat_customer_spending_v0__dbt_tmp
[0m17:27:29.052305 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:27:29.052414 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: drop view if exists allianz.datavault.sat_customer_spending_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
[0m17:27:29.086083 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.262 seconds
[0m17:27:29.086941 [debug] [Thread-6 (]: Applying DROP to: allianz.datavault.sat_product_discount_v0__dbt_tmp
[0m17:27:29.087367 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:27:29.087467 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: drop view if exists allianz.datavault.sat_product_discount_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
[0m17:27:29.129091 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.131 seconds
[0m17:27:29.129663 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: Close
[0m17:27:29.179811 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.153 seconds
[0m17:27:29.180580 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: Close
[0m17:27:29.196738 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a16cbd0>]}
[0m17:27:29.197008 [info ] [Thread-3 (]: 3 of 10 OK created sql incremental model datavault.sat_customer_v0 ............. [[32mSUCCESS 2000[0m in 2.52s]
[0m17:27:29.197216 [debug] [Thread-3 (]: Finished running node model.dbt_project.sat_customer_v0
[0m17:27:29.213124 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.126 seconds
[0m17:27:29.213825 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: Close
[0m17:27:29.214094 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.239 seconds
[0m17:27:29.215772 [debug] [Thread-5 (]: Applying DROP to: allianz.datavault.sat_product_category_v0__dbt_tmp
[0m17:27:29.216374 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:27:29.216607 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: drop view if exists allianz.datavault.sat_product_category_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
[0m17:27:29.217006 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.164 seconds
[0m17:27:29.217639 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: Close
[0m17:27:29.265434 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11fd47690>]}
[0m17:27:29.265803 [info ] [Thread-1 (]: 1 of 10 OK created sql incremental model datavault.sat_customer_profession_v0 .. [[32mSUCCESS 2000[0m in 2.59s]
[0m17:27:29.266094 [debug] [Thread-1 (]: Finished running node model.dbt_project.sat_customer_profession_v0
[0m17:27:29.312656 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a1d15b0>]}
[0m17:27:29.313064 [info ] [Thread-2 (]: 2 of 10 OK created sql incremental model datavault.sat_customer_spending_v0 .... [[32mSUCCESS 2000[0m in 2.64s]
[0m17:27:29.313377 [debug] [Thread-2 (]: Finished running node model.dbt_project.sat_customer_spending_v0
[0m17:27:29.313713 [debug] [Thread-8 (]: Began running node model.dbt_project.hub_customer_v0
[0m17:27:29.314043 [info ] [Thread-8 (]: 8 of 10 START sql incremental model datavault.hub_customer_v0 .................. [RUN]
[0m17:27:29.314357 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.dbt_project.hub_customer_v0'
[0m17:27:29.314556 [debug] [Thread-8 (]: Began compiling node model.dbt_project.hub_customer_v0
[0m17:27:29.317016 [debug] [Thread-8 (]: Writing injected SQL for node "model.dbt_project.hub_customer_v0"
[0m17:27:29.317626 [debug] [Thread-8 (]: Began executing node model.dbt_project.hub_customer_v0
[0m17:27:29.320268 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:27:29.320500 [debug] [Thread-8 (]: On model.dbt_project.hub_customer_v0: select * from (
        -- depends_on: allianz.datavault.sat_customer_v0
-- depends_on: allianz.datavault.sat_customer_profession_v0
-- depends_on: allianz.datavault.sat_customer_spending_v0



with source_data as (
    select distinct
        CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , customer_id
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
    from 
        allianz.stage.stg_customer_v0 stg
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
[0m17:27:29.320920 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m17:27:29.323441 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a16ba70>]}
[0m17:27:29.323813 [info ] [Thread-6 (]: 6 of 10 OK created sql incremental model datavault.sat_product_discount_v0 ..... [[32mSUCCESS 4566[0m in 2.65s]
[0m17:27:29.324233 [debug] [Thread-6 (]: Finished running node model.dbt_project.sat_product_discount_v0
[0m17:27:29.330180 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.113 seconds
[0m17:27:29.331409 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: Close
[0m17:27:29.407461 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a16b410>]}
[0m17:27:29.409082 [info ] [Thread-5 (]: 5 of 10 OK created sql incremental model datavault.sat_product_category_v0 ..... [[32mSUCCESS 4566[0m in 2.73s]
[0m17:27:29.409469 [debug] [Thread-5 (]: Finished running node model.dbt_project.sat_product_category_v0
[0m17:27:29.409775 [debug] [Thread-9 (]: Began running node model.dbt_project.hub_product_v0
[0m17:27:29.410037 [info ] [Thread-9 (]: 9 of 10 START sql incremental model datavault.hub_product_v0 ................... [RUN]
[0m17:27:29.410285 [debug] [Thread-9 (]: Acquiring new snowflake connection 'model.dbt_project.hub_product_v0'
[0m17:27:29.410438 [debug] [Thread-9 (]: Began compiling node model.dbt_project.hub_product_v0
[0m17:27:29.412326 [debug] [Thread-9 (]: Writing injected SQL for node "model.dbt_project.hub_product_v0"
[0m17:27:29.413515 [debug] [Thread-9 (]: Began executing node model.dbt_project.hub_product_v0
[0m17:27:29.414944 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:27:29.415113 [debug] [Thread-9 (]: On model.dbt_project.hub_product_v0: select * from (
        -- depends_on: allianz.datavault.sat_product_v0
-- depends_on: allianz.datavault.sat_product_category_v0
-- depends_on: allianz.datavault.sat_product_discount_v0



with source_data as (
    select distinct
        CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
        , product_id
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
    from 
        allianz.stage.stg_product_v0 stg
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
[0m17:27:29.415382 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m17:27:29.646907 [debug] [Thread-8 (]: SQL status: SUCCESS 0 in 0.326 seconds
[0m17:27:29.650018 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:27:29.650421 [debug] [Thread-8 (]: On model.dbt_project.hub_customer_v0: select * from (
        select
    
      
    cast(null as binary)
     as customer_hk, 
      
    cast(null as integer)
     as customer_id, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
[0m17:27:29.722702 [debug] [Thread-8 (]: SQL status: SUCCESS 0 in 0.072 seconds
[0m17:27:29.726151 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:27:29.726997 [debug] [Thread-8 (]: On model.dbt_project.hub_customer_v0: create or replace  temporary view allianz.datavault.hub_customer_v0__dbt_tmp
  
  
  
  
  as (
    -- depends_on: allianz.datavault.sat_customer_v0
-- depends_on: allianz.datavault.sat_customer_profession_v0
-- depends_on: allianz.datavault.sat_customer_spending_v0



with source_data as (
    select distinct
        CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , customer_id
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
    from 
        allianz.stage.stg_customer_v0 stg
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */;
[0m17:27:29.733614 [debug] [Thread-9 (]: SQL status: SUCCESS 0 in 0.318 seconds
[0m17:27:29.734645 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:27:29.734913 [debug] [Thread-9 (]: On model.dbt_project.hub_product_v0: select * from (
        select
    
      
    cast(null as binary)
     as product_hk, 
      
    cast(null as TEXT)
     as product_id, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
[0m17:27:29.801131 [debug] [Thread-9 (]: SQL status: SUCCESS 0 in 0.066 seconds
[0m17:27:29.803229 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:27:29.803618 [debug] [Thread-9 (]: On model.dbt_project.hub_product_v0: create or replace  temporary view allianz.datavault.hub_product_v0__dbt_tmp
  
  
  
  
  as (
    -- depends_on: allianz.datavault.sat_product_v0
-- depends_on: allianz.datavault.sat_product_category_v0
-- depends_on: allianz.datavault.sat_product_discount_v0



with source_data as (
    select distinct
        CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
        , product_id
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
    from 
        allianz.stage.stg_product_v0 stg
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */;
[0m17:27:30.161459 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.357 seconds
[0m17:27:30.165133 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:27:30.165647 [debug] [Thread-9 (]: On model.dbt_project.hub_product_v0: describe table allianz.datavault.hub_product_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
[0m17:27:30.167075 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 0.440 seconds
[0m17:27:30.170748 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:27:30.171080 [debug] [Thread-8 (]: On model.dbt_project.hub_customer_v0: describe table allianz.datavault.hub_customer_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
[0m17:27:30.231367 [debug] [Thread-9 (]: SQL status: SUCCESS 4 in 0.064 seconds
[0m17:27:30.237119 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:27:30.237601 [debug] [Thread-9 (]: On model.dbt_project.hub_product_v0: describe table allianz.datavault.hub_product_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
[0m17:27:30.239722 [debug] [Thread-8 (]: SQL status: SUCCESS 4 in 0.068 seconds
[0m17:27:30.242912 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:27:30.243305 [debug] [Thread-8 (]: On model.dbt_project.hub_customer_v0: describe table allianz.datavault.hub_customer_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
[0m17:27:30.323131 [debug] [Thread-9 (]: SQL status: SUCCESS 4 in 0.084 seconds
[0m17:27:30.329481 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:27:30.330006 [debug] [Thread-9 (]: On model.dbt_project.hub_product_v0: describe table allianz.datavault.hub_product_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
[0m17:27:30.332167 [debug] [Thread-8 (]: SQL status: SUCCESS 4 in 0.088 seconds
[0m17:27:30.335889 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:27:30.336552 [debug] [Thread-8 (]: On model.dbt_project.hub_customer_v0: describe table allianz.datavault.hub_customer_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
[0m17:27:30.465245 [debug] [Thread-8 (]: SQL status: SUCCESS 4 in 0.128 seconds
[0m17:27:30.470746 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:27:30.471662 [debug] [Thread-9 (]: SQL status: SUCCESS 4 in 0.141 seconds
[0m17:27:30.472033 [debug] [Thread-8 (]: On model.dbt_project.hub_customer_v0: describe table "ALLIANZ"."DATAVAULT"."HUB_CUSTOMER_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
[0m17:27:30.475267 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:27:30.476043 [debug] [Thread-9 (]: On model.dbt_project.hub_product_v0: describe table "ALLIANZ"."DATAVAULT"."HUB_PRODUCT_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
[0m17:27:30.563465 [debug] [Thread-9 (]: SQL status: SUCCESS 4 in 0.087 seconds
[0m17:27:30.567000 [debug] [Thread-9 (]: 
    In "ALLIANZ"."DATAVAULT"."HUB_PRODUCT_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:27:30.568540 [debug] [Thread-9 (]: Writing runtime sql for node "model.dbt_project.hub_product_v0"
[0m17:27:30.570094 [debug] [Thread-8 (]: SQL status: SUCCESS 4 in 0.094 seconds
[0m17:27:30.572157 [debug] [Thread-8 (]: 
    In "ALLIANZ"."DATAVAULT"."HUB_CUSTOMER_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:27:30.573276 [debug] [Thread-8 (]: Writing runtime sql for node "model.dbt_project.hub_customer_v0"
[0m17:27:30.574844 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:27:30.575213 [debug] [Thread-9 (]: On model.dbt_project.hub_product_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */;
[0m17:27:30.576053 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:27:30.576608 [debug] [Thread-8 (]: On model.dbt_project.hub_customer_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */;
[0m17:27:30.723940 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 0.147 seconds
[0m17:27:30.725308 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.149 seconds
[0m17:27:30.725903 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:27:30.726432 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:27:30.726870 [debug] [Thread-8 (]: On model.dbt_project.hub_customer_v0: merge into allianz.datavault.hub_customer_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.hub_customer_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.customer_hk = DBT_INTERNAL_DEST.customer_hk
                )

    
    when matched then update set
        "CUSTOMER_HK" = DBT_INTERNAL_SOURCE."CUSTOMER_HK","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_HK", "CUSTOMER_ID", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE")
    values
        ("CUSTOMER_HK", "CUSTOMER_ID", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */;
[0m17:27:30.727295 [debug] [Thread-9 (]: On model.dbt_project.hub_product_v0: merge into allianz.datavault.hub_product_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.hub_product_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.product_hk = DBT_INTERNAL_DEST.product_hk
                )

    
    when matched then update set
        "PRODUCT_HK" = DBT_INTERNAL_SOURCE."PRODUCT_HK","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE"
    

    when not matched then insert
        ("PRODUCT_HK", "PRODUCT_ID", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE")
    values
        ("PRODUCT_HK", "PRODUCT_ID", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */;
[0m17:27:31.795316 [debug] [Thread-9 (]: SQL status: SUCCESS 4566 in 1.067 seconds
[0m17:27:31.796357 [debug] [Thread-8 (]: SQL status: SUCCESS 2000 in 1.069 seconds
[0m17:27:31.797063 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:27:31.797573 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:27:31.797934 [debug] [Thread-9 (]: On model.dbt_project.hub_product_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
[0m17:27:31.798248 [debug] [Thread-8 (]: On model.dbt_project.hub_customer_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
[0m17:27:32.101275 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.302 seconds
[0m17:27:32.107284 [debug] [Thread-9 (]: Applying DROP to: allianz.datavault.hub_product_v0__dbt_tmp
[0m17:27:32.108249 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:27:32.108779 [debug] [Thread-9 (]: On model.dbt_project.hub_product_v0: drop view if exists allianz.datavault.hub_product_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
[0m17:27:32.126368 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 0.327 seconds
[0m17:27:32.128816 [debug] [Thread-8 (]: Applying DROP to: allianz.datavault.hub_customer_v0__dbt_tmp
[0m17:27:32.129485 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:27:32.129750 [debug] [Thread-8 (]: On model.dbt_project.hub_customer_v0: drop view if exists allianz.datavault.hub_customer_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
[0m17:27:32.206297 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.097 seconds
[0m17:27:32.208572 [debug] [Thread-9 (]: On model.dbt_project.hub_product_v0: Close
[0m17:27:32.258464 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 0.128 seconds
[0m17:27:32.261125 [debug] [Thread-8 (]: On model.dbt_project.hub_customer_v0: Close
[0m17:27:32.322322 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11ea642f0>]}
[0m17:27:32.323491 [info ] [Thread-9 (]: 9 of 10 OK created sql incremental model datavault.hub_product_v0 .............. [[32mSUCCESS 4566[0m in 2.91s]
[0m17:27:32.323998 [debug] [Thread-9 (]: Finished running node model.dbt_project.hub_product_v0
[0m17:27:32.348641 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11f86fd10>]}
[0m17:27:32.349194 [info ] [Thread-8 (]: 8 of 10 OK created sql incremental model datavault.hub_customer_v0 ............. [[32mSUCCESS 2000[0m in 3.03s]
[0m17:27:32.349566 [debug] [Thread-8 (]: Finished running node model.dbt_project.hub_customer_v0
[0m17:27:32.350106 [debug] [Thread-10 ]: Began running node model.dbt_project.lnk_orders_v0
[0m17:27:32.350410 [info ] [Thread-10 ]: 10 of 10 START sql incremental model datavault.lnk_orders_v0 ................... [RUN]
[0m17:27:32.350790 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.dbt_project.lnk_orders_v0'
[0m17:27:32.351003 [debug] [Thread-10 ]: Began compiling node model.dbt_project.lnk_orders_v0
[0m17:27:32.358080 [debug] [Thread-10 ]: Writing injected SQL for node "model.dbt_project.lnk_orders_v0"
[0m17:27:32.359843 [debug] [Thread-10 ]: Began executing node model.dbt_project.lnk_orders_v0
[0m17:27:32.362187 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:27:32.362438 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: select * from (
        -- depends_on: allianz.datavault.hub_customer_v0
-- depends_on: allianz.datavault.hub_product_v0
-- depends_on: allianz.datavault.sat_orders_v0



with source_data as (
    select distinct
        CAST(SHA2_BINARY(order_id || customer_id || product_id) as BINARY(32)) as lnk_orders_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(order_id) as BINARY(32)) as order_hk
        , CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
    from 
        allianz.stage.stg_sap_orders_v0
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
[0m17:27:32.362639 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m17:27:32.652422 [debug] [Thread-10 ]: SQL status: SUCCESS 0 in 0.289 seconds
[0m17:27:32.655802 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:27:32.656261 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: select * from (
        select
    
      
    cast(null as binary)
     as lnk_orders_hk, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE, 
      
    cast(null as binary)
     as order_hk, 
      
    cast(null as binary)
     as customer_hk, 
      
    cast(null as binary)
     as product_hk
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
[0m17:27:32.750893 [debug] [Thread-10 ]: SQL status: SUCCESS 0 in 0.094 seconds
[0m17:27:32.751798 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:27:32.751989 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: create or replace  temporary view allianz.datavault.lnk_orders_v0__dbt_tmp
  
  
  
  
  as (
    -- depends_on: allianz.datavault.hub_customer_v0
-- depends_on: allianz.datavault.hub_product_v0
-- depends_on: allianz.datavault.sat_orders_v0



with source_data as (
    select distinct
        CAST(SHA2_BINARY(order_id || customer_id || product_id) as BINARY(32)) as lnk_orders_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(order_id) as BINARY(32)) as order_hk
        , CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
    from 
        allianz.stage.stg_sap_orders_v0
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */;
[0m17:27:33.024430 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.272 seconds
[0m17:27:33.030014 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:27:33.030477 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: describe table allianz.datavault.lnk_orders_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
[0m17:27:33.097439 [debug] [Thread-10 ]: SQL status: SUCCESS 6 in 0.066 seconds
[0m17:27:33.102188 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:27:33.102663 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: describe table allianz.datavault.lnk_orders_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
[0m17:27:33.174313 [debug] [Thread-10 ]: SQL status: SUCCESS 6 in 0.071 seconds
[0m17:27:33.178125 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:27:33.178478 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: describe table allianz.datavault.lnk_orders_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
[0m17:27:33.243539 [debug] [Thread-10 ]: SQL status: SUCCESS 6 in 0.065 seconds
[0m17:27:33.244812 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:27:33.244960 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: describe table "ALLIANZ"."DATAVAULT"."LNK_ORDERS_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
[0m17:27:33.313022 [debug] [Thread-10 ]: SQL status: SUCCESS 6 in 0.068 seconds
[0m17:27:33.313748 [debug] [Thread-10 ]: 
    In "ALLIANZ"."DATAVAULT"."LNK_ORDERS_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:27:33.314145 [debug] [Thread-10 ]: Writing runtime sql for node "model.dbt_project.lnk_orders_v0"
[0m17:27:33.314762 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:27:33.314881 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */;
[0m17:27:33.430257 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.115 seconds
[0m17:27:33.430476 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:27:33.430613 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: merge into allianz.datavault.lnk_orders_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.lnk_orders_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_hk = DBT_INTERNAL_DEST.order_hk
                )

    
    when matched then update set
        "LNK_ORDERS_HK" = DBT_INTERNAL_SOURCE."LNK_ORDERS_HK","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE","ORDER_HK" = DBT_INTERNAL_SOURCE."ORDER_HK","CUSTOMER_HK" = DBT_INTERNAL_SOURCE."CUSTOMER_HK","PRODUCT_HK" = DBT_INTERNAL_SOURCE."PRODUCT_HK"
    

    when not matched then insert
        ("LNK_ORDERS_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "ORDER_HK", "CUSTOMER_HK", "PRODUCT_HK")
    values
        ("LNK_ORDERS_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "ORDER_HK", "CUSTOMER_HK", "PRODUCT_HK")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */;
[0m17:27:34.172225 [debug] [Thread-10 ]: SQL status: SUCCESS 5 in 0.741 seconds
[0m17:27:34.172543 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:27:34.172690 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
[0m17:27:34.578079 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.405 seconds
[0m17:27:34.582553 [debug] [Thread-10 ]: Applying DROP to: allianz.datavault.lnk_orders_v0__dbt_tmp
[0m17:27:34.584659 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:27:34.585005 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: drop view if exists allianz.datavault.lnk_orders_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
[0m17:27:34.691370 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.106 seconds
[0m17:27:34.694050 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: Close
[0m17:27:34.769883 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'f66b76d9-a7d9-451b-9662-d7a4d248e4f4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ec8770>]}
[0m17:27:34.771040 [info ] [Thread-10 ]: 10 of 10 OK created sql incremental model datavault.lnk_orders_v0 .............. [[32mSUCCESS 5[0m in 2.42s]
[0m17:27:34.771658 [debug] [Thread-10 ]: Finished running node model.dbt_project.lnk_orders_v0
[0m17:27:34.773888 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:27:34.774283 [debug] [MainThread]: Connection 'model.dbt_project.sat_customer_profession_v0' was properly closed.
[0m17:27:34.774528 [debug] [MainThread]: Connection 'model.dbt_project.sat_customer_spending_v0' was properly closed.
[0m17:27:34.774740 [debug] [MainThread]: Connection 'model.dbt_project.sat_customer_v0' was properly closed.
[0m17:27:34.774941 [debug] [MainThread]: Connection 'model.dbt_project.sat_product_discount_v0' was properly closed.
[0m17:27:34.775142 [debug] [MainThread]: Connection 'model.dbt_project.sat_orders_v0' was properly closed.
[0m17:27:34.775335 [debug] [MainThread]: Connection 'model.dbt_project.sat_product_category_v0' was properly closed.
[0m17:27:34.775534 [debug] [MainThread]: Connection 'model.dbt_project.sat_product_v0' was properly closed.
[0m17:27:34.775722 [debug] [MainThread]: Connection 'model.dbt_project.hub_customer_v0' was properly closed.
[0m17:27:34.775925 [debug] [MainThread]: Connection 'model.dbt_project.hub_product_v0' was properly closed.
[0m17:27:34.776113 [debug] [MainThread]: Connection 'model.dbt_project.lnk_orders_v0' was properly closed.
[0m17:27:34.776490 [info ] [MainThread]: 
[0m17:27:34.776824 [info ] [MainThread]: Finished running 10 incremental models in 0 hours 0 minutes and 13.57 seconds (13.57s).
[0m17:27:34.778626 [debug] [MainThread]: Command end result
[0m17:27:34.807804 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/manifest.json
[0m17:27:34.809156 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/semantic_manifest.json
[0m17:27:34.812632 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/run_results.json
[0m17:27:34.812793 [info ] [MainThread]: 
[0m17:27:34.812976 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:27:34.813103 [info ] [MainThread]: 
[0m17:27:34.813250 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m17:27:34.815460 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.411059, "process_in_blocks": "0", "process_kernel_time": 0.307507, "process_mem_max_rss": "187400192", "process_out_blocks": "0", "process_user_time": 2.271556}
[0m17:27:34.815716 [debug] [MainThread]: Command `dbt run` succeeded at 17:27:34.815665 after 14.41 seconds
[0m17:27:34.815897 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f72bd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a1ad6d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12a6c52b0>]}
[0m17:27:34.816060 [debug] [MainThread]: Flushing usage events
[0m17:27:35.373598 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:28:34.800773 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1058ab620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106dc7b10>]}


============================== 17:28:34.802923 | d85a04c0-b751-4714-8e37-6de839f765a7 ==============================
[0m17:28:34.802923 [info ] [MainThread]: Running with dbt=1.10.9
[0m17:28:34.803155 [debug] [MainThread]: running dbt with arguments {'quiet': 'False', 'static_parser': 'True', 'use_colors': 'True', 'indirect_selection': 'eager', 'cache_selected_only': 'False', 'log_cache_events': 'False', 'write_json': 'True', 'no_print': 'None', 'log_path': '/Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/logs', 'partial_parse': 'True', 'profiles_dir': '/Users/vijaypalanichamy/.dbt', 'fail_fast': 'False', 'log_format': 'default', 'debug': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'target_path': 'None', 'version_check': 'True', 'invocation_command': 'dbt run --select tag:allianz_dbt_assignment', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'introspect': 'True', 'printer_width': '80', 'warn_error': 'None'}
[0m17:28:34.984495 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd85a04c0-b751-4714-8e37-6de839f765a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060df230>]}
[0m17:28:35.003188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd85a04c0-b751-4714-8e37-6de839f765a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10788b9b0>]}
[0m17:28:35.003481 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m17:28:35.038198 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m17:28:35.080631 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m17:28:35.080780 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m17:28:35.097711 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd85a04c0-b751-4714-8e37-6de839f765a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107f80350>]}
[0m17:28:35.129558 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/manifest.json
[0m17:28:35.130330 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/semantic_manifest.json
[0m17:28:35.136555 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd85a04c0-b751-4714-8e37-6de839f765a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1078b3110>]}
[0m17:28:35.136730 [info ] [MainThread]: Found 15 models, 32 data tests, 3 sources, 479 macros
[0m17:28:35.136843 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd85a04c0-b751-4714-8e37-6de839f765a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107993070>]}
[0m17:28:35.137611 [info ] [MainThread]: 
[0m17:28:35.137740 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m17:28:35.137827 [info ] [MainThread]: 
[0m17:28:35.137984 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m17:28:35.139588 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_allianz'
[0m17:28:35.158827 [debug] [ThreadPool]: Using snowflake connection "list_allianz"
[0m17:28:35.159021 [debug] [ThreadPool]: On list_allianz: show terse schemas in database allianz
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz"} */
[0m17:28:35.159128 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:37.847477 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.688 seconds
[0m17:28:37.850187 [debug] [ThreadPool]: On list_allianz: Close
[0m17:28:37.950821 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_allianz, now list_allianz_stage)
[0m17:28:37.951646 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_allianz_datavault'
[0m17:28:37.958540 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_allianz_validation'
[0m17:28:37.969150 [debug] [ThreadPool]: Using snowflake connection "list_allianz_datavault"
[0m17:28:37.970238 [debug] [ThreadPool]: Using snowflake connection "list_allianz_stage"
[0m17:28:37.971516 [debug] [ThreadPool]: Using snowflake connection "list_allianz_validation"
[0m17:28:37.971734 [debug] [ThreadPool]: On list_allianz_datavault: show objects in allianz.datavault
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz_datavault"} */;
[0m17:28:37.971931 [debug] [ThreadPool]: On list_allianz_stage: show objects in allianz.stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz_stage"} */;
[0m17:28:37.972113 [debug] [ThreadPool]: On list_allianz_validation: show objects in allianz.validation
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz_validation"} */;
[0m17:28:37.972284 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:37.972439 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m17:28:37.972591 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m17:28:40.304604 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.332 seconds
[0m17:28:40.307365 [debug] [ThreadPool]: On list_allianz_stage: Close
[0m17:28:40.313976 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 2.342 seconds
[0m17:28:40.315692 [debug] [ThreadPool]: On list_allianz_datavault: Close
[0m17:28:40.397265 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.425 seconds
[0m17:28:40.398300 [debug] [ThreadPool]: On list_allianz_validation: Close
[0m17:28:40.626645 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd85a04c0-b751-4714-8e37-6de839f765a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e6f6820>]}
[0m17:28:40.632285 [debug] [Thread-1 (]: Began running node model.dbt_project.sat_customer_profession_v0
[0m17:28:40.632834 [debug] [Thread-2 (]: Began running node model.dbt_project.sat_customer_spending_v0
[0m17:28:40.633190 [debug] [Thread-4 (]: Began running node model.dbt_project.sat_orders_v0
[0m17:28:40.633495 [debug] [Thread-5 (]: Began running node model.dbt_project.sat_product_category_v0
[0m17:28:40.633790 [debug] [Thread-6 (]: Began running node model.dbt_project.sat_product_discount_v0
[0m17:28:40.634066 [debug] [Thread-7 (]: Began running node model.dbt_project.sat_product_v0
[0m17:28:40.634390 [debug] [Thread-3 (]: Began running node model.dbt_project.sat_customer_v0
[0m17:28:40.635034 [info ] [Thread-1 (]: 1 of 10 START sql incremental model datavault.sat_customer_profession_v0 ....... [RUN]
[0m17:28:40.635467 [info ] [Thread-2 (]: 2 of 10 START sql incremental model datavault.sat_customer_spending_v0 ......... [RUN]
[0m17:28:40.635886 [info ] [Thread-4 (]: 4 of 10 START sql incremental model datavault.sat_orders_v0 .................... [RUN]
[0m17:28:40.636272 [info ] [Thread-5 (]: 5 of 10 START sql incremental model datavault.sat_product_category_v0 .......... [RUN]
[0m17:28:40.636621 [info ] [Thread-6 (]: 6 of 10 START sql incremental model datavault.sat_product_discount_v0 .......... [RUN]
[0m17:28:40.636968 [info ] [Thread-7 (]: 7 of 10 START sql incremental model datavault.sat_product_v0 ................... [RUN]
[0m17:28:40.637746 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_allianz_stage, now model.dbt_project.sat_customer_profession_v0)
[0m17:28:40.637298 [info ] [Thread-3 (]: 3 of 10 START sql incremental model datavault.sat_customer_v0 .................. [RUN]
[0m17:28:40.638073 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_allianz_datavault, now model.dbt_project.sat_customer_spending_v0)
[0m17:28:40.638423 [debug] [Thread-4 (]: Acquiring new snowflake connection 'model.dbt_project.sat_orders_v0'
[0m17:28:40.638741 [debug] [Thread-5 (]: Acquiring new snowflake connection 'model.dbt_project.sat_product_category_v0'
[0m17:28:40.639022 [debug] [Thread-6 (]: Acquiring new snowflake connection 'model.dbt_project.sat_product_discount_v0'
[0m17:28:40.639304 [debug] [Thread-7 (]: Acquiring new snowflake connection 'model.dbt_project.sat_product_v0'
[0m17:28:40.639886 [debug] [Thread-1 (]: Began compiling node model.dbt_project.sat_customer_profession_v0
[0m17:28:40.640370 [debug] [Thread-3 (]: Re-using an available connection from the pool (formerly list_allianz_validation, now model.dbt_project.sat_customer_v0)
[0m17:28:40.640877 [debug] [Thread-2 (]: Began compiling node model.dbt_project.sat_customer_spending_v0
[0m17:28:40.641296 [debug] [Thread-4 (]: Began compiling node model.dbt_project.sat_orders_v0
[0m17:28:40.641585 [debug] [Thread-5 (]: Began compiling node model.dbt_project.sat_product_category_v0
[0m17:28:40.641834 [debug] [Thread-6 (]: Began compiling node model.dbt_project.sat_product_discount_v0
[0m17:28:40.642056 [debug] [Thread-7 (]: Began compiling node model.dbt_project.sat_product_v0
[0m17:28:40.647809 [debug] [Thread-3 (]: Began compiling node model.dbt_project.sat_customer_v0
[0m17:28:40.650241 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.sat_customer_spending_v0"
[0m17:28:40.652335 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.sat_customer_profession_v0"
[0m17:28:40.654162 [debug] [Thread-4 (]: Writing injected SQL for node "model.dbt_project.sat_orders_v0"
[0m17:28:40.655795 [debug] [Thread-5 (]: Writing injected SQL for node "model.dbt_project.sat_product_category_v0"
[0m17:28:40.657890 [debug] [Thread-6 (]: Writing injected SQL for node "model.dbt_project.sat_product_discount_v0"
[0m17:28:40.659461 [debug] [Thread-7 (]: Writing injected SQL for node "model.dbt_project.sat_product_v0"
[0m17:28:40.661111 [debug] [Thread-3 (]: Writing injected SQL for node "model.dbt_project.sat_customer_v0"
[0m17:28:40.662804 [debug] [Thread-6 (]: Began executing node model.dbt_project.sat_product_discount_v0
[0m17:28:40.669309 [debug] [Thread-2 (]: Began executing node model.dbt_project.sat_customer_spending_v0
[0m17:28:40.669496 [debug] [Thread-3 (]: Began executing node model.dbt_project.sat_customer_v0
[0m17:28:40.669697 [debug] [Thread-7 (]: Began executing node model.dbt_project.sat_product_v0
[0m17:28:40.669855 [debug] [Thread-1 (]: Began executing node model.dbt_project.sat_customer_profession_v0
[0m17:28:40.687561 [debug] [Thread-5 (]: Began executing node model.dbt_project.sat_product_category_v0
[0m17:28:40.700165 [debug] [Thread-4 (]: Began executing node model.dbt_project.sat_orders_v0
[0m17:28:40.707874 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:28:40.709110 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:28:40.709528 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:28:40.710759 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:28:40.712074 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:28:40.713081 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:28:40.714171 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:28:40.714308 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: select * from (
        

with source_data as (
    select distinct
        CAST(SHA2_BINARY(product_id || source || discount_name) as BINARY(32)) as product_discount_hk
        , CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
        , SYSDATE()  as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , discount_name
        , CAST( LEFT( discount_name , POSITION( '%' IN discount_name)-1 ) as NUMBER(38,2)) as discount_percentage
    from 
        allianz.stage.stg_product_v0
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
[0m17:28:40.714454 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: select * from (
        

with source_data as (
    select distinct
        CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(source || gender || age || family_size) as BINARY(32)) as DV_HASH_DIFF
        , customer_id
        , gender
        , age
        , family_size
    from 
        allianz.stage.stg_customer_v0
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
[0m17:28:40.714596 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: select * from (
        

with source_data as (
    select
        CAST(SHA2_BINARY(customer_id || source || spending_score) as BINARY(32)) as customer_spending_hk
        , CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , spending_score
        , CASE
            WHEN spending_score BETWEEN 0 and 25 THEN '00-25'
            WHEN spending_score BETWEEN 26 and 50 THEN '26-50'
            WHEN spending_score BETWEEN 51 and 75 THEN '51-75'
            WHEN spending_score BETWEEN 76 and 100 THEN '76-100'
            ELSE 'NA'
        END as spending_bucket
    from 
        allianz.stage.stg_customer_v0
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
[0m17:28:40.714736 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: select * from (
        

with source_data as (
    select distinct
        CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(source || product_id || product_name || product_description || product_sizes || brand_name) as BINARY(32)) as DV_HASH_DIFF
        , product_id
        , product_name
        , product_description
        , product_sizes
        , brand_name
    from 
        allianz.stage.stg_product_v0
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
[0m17:28:40.714873 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: select * from (
        

with source_data as (
    select distinct
        CAST(SHA2_BINARY(customer_id || source || profession || annual_income_inr || work_experience) as BINARY(32)) as customer_profession_hk
        , CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , profession
        , CASE
            WHEN lower(profession) IS NULL THEN 'UNKNOWN'
            WHEN lower(profession) IN ('doctor','healthcare') THEN 'HIGH'
            WHEN lower(profession) IN ('artist','homemaker') THEN 'MEDIUM'
            ELSE 'LOW'
        END as risk_category
        , annual_income_inr
        , CASE
            WHEN annual_income_inr BETWEEN       0 and   100000 THEN 'LOW'
            WHEN annual_income_inr BETWEEN  100001 and  1000000 THEN 'MEDIUM'
            WHEN annual_income_inr BETWEEN 1000001 and 10000000 THEN 'HIGH'
            WHEN annual_income_inr > 10000000 THEN 'HNI'
            ELSE 'NA'
        END as annual_income_bucket
        , work_experience
    from 
        allianz.stage.stg_customer_v0
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
[0m17:28:40.715005 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: select * from (
        

with source_data as (
    select distinct
        CAST(SHA2_BINARY(product_id || source || category_name) as BINARY(32)) as product_category_hk
        , CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , category_name
    from 
        allianz.stage.stg_product_v0      
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
[0m17:28:40.715126 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: select * from (
        

with source_data as (
    select distinct
        CAST(SHA2_BINARY(order_id) as BINARY(32)) as order_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(source || order_id || quantity || amount) as BINARY(32)) as DV_HASH_DIFF
        , order_id
        , quantity
        , amount
    from 
        allianz.stage.stg_sap_orders_v0
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
[0m17:28:40.715239 [debug] [Thread-6 (]: Opening a new connection, currently in state init
[0m17:28:40.715342 [debug] [Thread-3 (]: Opening a new connection, currently in state closed
[0m17:28:40.715440 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m17:28:40.715537 [debug] [Thread-7 (]: Opening a new connection, currently in state init
[0m17:28:40.715635 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m17:28:40.715733 [debug] [Thread-5 (]: Opening a new connection, currently in state init
[0m17:28:40.715827 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m17:28:41.067757 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.352 seconds
[0m17:28:41.083025 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:28:41.083429 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: select * from (
        select
    
      
    cast(null as binary)
     as customer_hk, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE, 
      
    cast(null as binary)
     as DV_HASH_DIFF, 
      
    cast(null as integer)
     as customer_id, 
      
    cast(null as TEXT)
     as gender, 
      
    cast(null as integer)
     as age, 
      
    cast(null as integer)
     as family_size
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
[0m17:28:41.118728 [debug] [Thread-6 (]: SQL status: SUCCESS 0 in 0.403 seconds
[0m17:28:41.120315 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:28:41.120696 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: select * from (
        select
    
      
    cast(null as binary)
     as product_discount_hk, 
      
    cast(null as binary)
     as product_hk, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE, 
      
    cast(null as TEXT)
     as discount_name, 
      
    cast(null as number(38,2))
     as discount_percentage
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
[0m17:28:41.133390 [debug] [Thread-4 (]: SQL status: SUCCESS 0 in 0.417 seconds
[0m17:28:41.134908 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:28:41.135249 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: select * from (
        select
    
      
    cast(null as binary)
     as order_hk, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE, 
      
    cast(null as binary)
     as DV_HASH_DIFF, 
      
    cast(null as integer)
     as order_id, 
      
    cast(null as integer)
     as quantity, 
      
    cast(null as integer)
     as amount
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
[0m17:28:41.153812 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.438 seconds
[0m17:28:41.155612 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:28:41.156153 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: select * from (
        select
    
      
    cast(null as binary)
     as customer_spending_hk, 
      
    cast(null as binary)
     as customer_hk, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE, 
      
    cast(null as integer)
     as spending_score, 
      
    cast(null as TEXT)
     as spending_bucket
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
[0m17:28:41.157665 [debug] [Thread-7 (]: SQL status: SUCCESS 0 in 0.442 seconds
[0m17:28:41.160274 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:28:41.160699 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: select * from (
        select
    
      
    cast(null as binary)
     as product_hk, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE, 
      
    cast(null as binary)
     as DV_HASH_DIFF, 
      
    cast(null as TEXT)
     as product_id, 
      
    cast(null as TEXT)
     as product_name, 
      
    cast(null as TEXT)
     as product_description, 
      
    cast(null as TEXT)
     as product_sizes, 
      
    cast(null as TEXT)
     as brand_name
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
[0m17:28:41.167716 [debug] [Thread-3 (]: SQL status: SUCCESS 0 in 0.084 seconds
[0m17:28:41.173218 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:28:41.173493 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: create or replace  temporary view allianz.datavault.sat_customer_v0__dbt_tmp
  
  
  
  
  as (
    

with source_data as (
    select distinct
        CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(source || gender || age || family_size) as BINARY(32)) as DV_HASH_DIFF
        , customer_id
        , gender
        , age
        , family_size
    from 
        allianz.stage.stg_customer_v0
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */;
[0m17:28:41.174517 [debug] [Thread-5 (]: SQL status: SUCCESS 0 in 0.459 seconds
[0m17:28:41.175582 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:28:41.175864 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: select * from (
        select
    
      
    cast(null as binary)
     as product_category_hk, 
      
    cast(null as binary)
     as product_hk, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE, 
      
    cast(null as TEXT)
     as category_name
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
[0m17:28:41.198263 [debug] [Thread-6 (]: SQL status: SUCCESS 0 in 0.077 seconds
[0m17:28:41.199477 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:28:41.199725 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: create or replace  temporary view allianz.datavault.sat_product_discount_v0__dbt_tmp
  
  
  
  
  as (
    

with source_data as (
    select distinct
        CAST(SHA2_BINARY(product_id || source || discount_name) as BINARY(32)) as product_discount_hk
        , CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
        , SYSDATE()  as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , discount_name
        , CAST( LEFT( discount_name , POSITION( '%' IN discount_name)-1 ) as NUMBER(38,2)) as discount_percentage
    from 
        allianz.stage.stg_product_v0
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */;
[0m17:28:41.200731 [debug] [Thread-4 (]: SQL status: SUCCESS 0 in 0.065 seconds
[0m17:28:41.202062 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:28:41.202344 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: create or replace  temporary view allianz.datavault.sat_orders_v0__dbt_tmp
  
  
  
  
  as (
    

with source_data as (
    select distinct
        CAST(SHA2_BINARY(order_id) as BINARY(32)) as order_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(source || order_id || quantity || amount) as BINARY(32)) as DV_HASH_DIFF
        , order_id
        , quantity
        , amount
    from 
        allianz.stage.stg_sap_orders_v0
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */;
[0m17:28:41.220899 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.064 seconds
[0m17:28:41.222145 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:28:41.222414 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: create or replace  temporary view allianz.datavault.sat_customer_spending_v0__dbt_tmp
  
  
  
  
  as (
    

with source_data as (
    select
        CAST(SHA2_BINARY(customer_id || source || spending_score) as BINARY(32)) as customer_spending_hk
        , CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , spending_score
        , CASE
            WHEN spending_score BETWEEN 0 and 25 THEN '00-25'
            WHEN spending_score BETWEEN 26 and 50 THEN '26-50'
            WHEN spending_score BETWEEN 51 and 75 THEN '51-75'
            WHEN spending_score BETWEEN 76 and 100 THEN '76-100'
            ELSE 'NA'
        END as spending_bucket
    from 
        allianz.stage.stg_customer_v0
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */;
[0m17:28:41.229291 [debug] [Thread-7 (]: SQL status: SUCCESS 0 in 0.068 seconds
[0m17:28:41.230647 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:28:41.230901 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: create or replace  temporary view allianz.datavault.sat_product_v0__dbt_tmp
  
  
  
  
  as (
    

with source_data as (
    select distinct
        CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(source || product_id || product_name || product_description || product_sizes || brand_name) as BINARY(32)) as DV_HASH_DIFF
        , product_id
        , product_name
        , product_description
        , product_sizes
        , brand_name
    from 
        allianz.stage.stg_product_v0
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */;
[0m17:28:41.249656 [debug] [Thread-5 (]: SQL status: SUCCESS 0 in 0.073 seconds
[0m17:28:41.250825 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:28:41.251088 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: create or replace  temporary view allianz.datavault.sat_product_category_v0__dbt_tmp
  
  
  
  
  as (
    

with source_data as (
    select distinct
        CAST(SHA2_BINARY(product_id || source || category_name) as BINARY(32)) as product_category_hk
        , CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , category_name
    from 
        allianz.stage.stg_product_v0      
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */;
[0m17:28:41.314509 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.599 seconds
[0m17:28:41.317227 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:28:41.317681 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: select * from (
        select
    
      
    cast(null as binary)
     as customer_profession_hk, 
      
    cast(null as binary)
     as customer_hk, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE, 
      
    cast(null as TEXT)
     as profession, 
      
    cast(null as TEXT)
     as risk_category, 
      
    cast(null as integer)
     as annual_income_inr, 
      
    cast(null as TEXT)
     as annual_income_bucket, 
      
    cast(null as integer)
     as work_experience
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
[0m17:28:41.375275 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 0.144 seconds
[0m17:28:41.386038 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:28:41.386443 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: describe table allianz.datavault.sat_product_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
[0m17:28:41.387262 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.069 seconds
[0m17:28:41.389329 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:28:41.389823 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: create or replace  temporary view allianz.datavault.sat_customer_profession_v0__dbt_tmp
  
  
  
  
  as (
    

with source_data as (
    select distinct
        CAST(SHA2_BINARY(customer_id || source || profession || annual_income_inr || work_experience) as BINARY(32)) as customer_profession_hk
        , CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , profession
        , CASE
            WHEN lower(profession) IS NULL THEN 'UNKNOWN'
            WHEN lower(profession) IN ('doctor','healthcare') THEN 'HIGH'
            WHEN lower(profession) IN ('artist','homemaker') THEN 'MEDIUM'
            ELSE 'LOW'
        END as risk_category
        , annual_income_inr
        , CASE
            WHEN annual_income_inr BETWEEN       0 and   100000 THEN 'LOW'
            WHEN annual_income_inr BETWEEN  100001 and  1000000 THEN 'MEDIUM'
            WHEN annual_income_inr BETWEEN 1000001 and 10000000 THEN 'HIGH'
            WHEN annual_income_inr > 10000000 THEN 'HNI'
            ELSE 'NA'
        END as annual_income_bucket
        , work_experience
    from 
        allianz.stage.stg_customer_v0
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */;
[0m17:28:41.390365 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.190 seconds
[0m17:28:41.392370 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:28:41.392732 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: describe table allianz.datavault.sat_product_discount_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
[0m17:28:41.412469 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.210 seconds
[0m17:28:41.416865 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:28:41.417107 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: describe table allianz.datavault.sat_orders_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
[0m17:28:41.420307 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.169 seconds
[0m17:28:41.421922 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:28:41.422140 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: describe table allianz.datavault.sat_product_category_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
[0m17:28:41.430529 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.208 seconds
[0m17:28:41.432393 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:28:41.432623 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: describe table allianz.datavault.sat_customer_spending_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
[0m17:28:41.488998 [debug] [Thread-7 (]: SQL status: SUCCESS 9 in 0.101 seconds
[0m17:28:41.492736 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:28:41.493100 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: describe table allianz.datavault.sat_product_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
[0m17:28:41.495657 [debug] [Thread-2 (]: SQL status: SUCCESS 6 in 0.063 seconds
[0m17:28:41.497999 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:28:41.498272 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: describe table allianz.datavault.sat_customer_spending_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
[0m17:28:41.499176 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.325 seconds
[0m17:28:41.501403 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:28:41.501729 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: describe table allianz.datavault.sat_customer_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
[0m17:28:41.504864 [debug] [Thread-5 (]: SQL status: SUCCESS 5 in 0.083 seconds
[0m17:28:41.506781 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:28:41.507006 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: describe table allianz.datavault.sat_product_category_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
[0m17:28:41.508777 [debug] [Thread-4 (]: SQL status: SUCCESS 7 in 0.091 seconds
[0m17:28:41.510797 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:28:41.510987 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: describe table allianz.datavault.sat_orders_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
[0m17:28:41.516030 [debug] [Thread-6 (]: SQL status: SUCCESS 6 in 0.123 seconds
[0m17:28:41.517727 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:28:41.517925 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: describe table allianz.datavault.sat_product_discount_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
[0m17:28:41.536212 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.146 seconds
[0m17:28:41.537699 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:28:41.537912 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: describe table allianz.datavault.sat_customer_profession_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
[0m17:28:41.571844 [debug] [Thread-5 (]: SQL status: SUCCESS 5 in 0.065 seconds
[0m17:28:41.572393 [debug] [Thread-6 (]: SQL status: SUCCESS 6 in 0.054 seconds
[0m17:28:41.582342 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:28:41.583518 [debug] [Thread-4 (]: SQL status: SUCCESS 7 in 0.072 seconds
[0m17:28:41.585405 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:28:41.585854 [debug] [Thread-2 (]: SQL status: SUCCESS 6 in 0.087 seconds
[0m17:28:41.586333 [debug] [Thread-7 (]: SQL status: SUCCESS 9 in 0.093 seconds
[0m17:28:41.586860 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: describe table allianz.datavault.sat_product_category_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
[0m17:28:41.587279 [debug] [Thread-3 (]: SQL status: SUCCESS 8 in 0.085 seconds
[0m17:28:41.589290 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:28:41.589503 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: describe table allianz.datavault.sat_product_discount_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
[0m17:28:41.591118 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:28:41.592862 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:28:41.594502 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:28:41.594703 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: describe table allianz.datavault.sat_orders_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
[0m17:28:41.595625 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: describe table allianz.datavault.sat_customer_spending_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
[0m17:28:41.595901 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: describe table allianz.datavault.sat_product_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
[0m17:28:41.596248 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: describe table allianz.datavault.sat_customer_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
[0m17:28:41.622758 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.084 seconds
[0m17:28:41.624605 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:28:41.624786 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: describe table allianz.datavault.sat_customer_profession_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
[0m17:28:41.672451 [debug] [Thread-5 (]: SQL status: SUCCESS 5 in 0.079 seconds
[0m17:28:41.674752 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:28:41.675051 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: describe table "ALLIANZ"."DATAVAULT"."SAT_PRODUCT_CATEGORY_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
[0m17:28:41.676490 [debug] [Thread-7 (]: SQL status: SUCCESS 9 in 0.079 seconds
[0m17:28:41.678905 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:28:41.679147 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: describe table "ALLIANZ"."DATAVAULT"."SAT_PRODUCT_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
[0m17:28:41.680397 [debug] [Thread-6 (]: SQL status: SUCCESS 6 in 0.085 seconds
[0m17:28:41.682326 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:28:41.683178 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: describe table "ALLIANZ"."DATAVAULT"."SAT_PRODUCT_DISCOUNT_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
[0m17:28:41.684142 [debug] [Thread-3 (]: SQL status: SUCCESS 8 in 0.087 seconds
[0m17:28:41.686064 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:28:41.686602 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: describe table allianz.datavault.sat_customer_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
[0m17:28:41.736457 [debug] [Thread-7 (]: SQL status: SUCCESS 9 in 0.057 seconds
[0m17:28:41.744683 [debug] [Thread-7 (]: 
    In "ALLIANZ"."DATAVAULT"."SAT_PRODUCT_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:28:41.764038 [debug] [Thread-7 (]: Writing runtime sql for node "model.dbt_project.sat_product_v0"
[0m17:28:41.764904 [debug] [Thread-5 (]: SQL status: SUCCESS 5 in 0.090 seconds
[0m17:28:41.765275 [debug] [Thread-3 (]: SQL status: SUCCESS 8 in 0.078 seconds
[0m17:28:41.765668 [debug] [Thread-2 (]: SQL status: SUCCESS 6 in 0.169 seconds
[0m17:28:41.766651 [debug] [Thread-5 (]: 
    In "ALLIANZ"."DATAVAULT"."SAT_PRODUCT_CATEGORY_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:28:41.767043 [debug] [Thread-6 (]: SQL status: SUCCESS 6 in 0.084 seconds
[0m17:28:41.767386 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.142 seconds
[0m17:28:41.768887 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:28:41.769221 [debug] [Thread-4 (]: SQL status: SUCCESS 7 in 0.173 seconds
[0m17:28:41.770785 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:28:41.771298 [debug] [Thread-5 (]: Writing runtime sql for node "model.dbt_project.sat_product_category_v0"
[0m17:28:41.771871 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:28:41.772716 [debug] [Thread-6 (]: 
    In "ALLIANZ"."DATAVAULT"."SAT_PRODUCT_DISCOUNT_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:28:41.774072 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:28:41.774234 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: describe table "ALLIANZ"."DATAVAULT"."SAT_CUSTOMER_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
[0m17:28:41.775600 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:28:41.775751 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: describe table "ALLIANZ"."DATAVAULT"."SAT_CUSTOMER_SPENDING_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
[0m17:28:41.775922 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */;
[0m17:28:41.776382 [debug] [Thread-6 (]: Writing runtime sql for node "model.dbt_project.sat_product_discount_v0"
[0m17:28:41.776532 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: describe table allianz.datavault.sat_customer_profession_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
[0m17:28:41.776812 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: describe table "ALLIANZ"."DATAVAULT"."SAT_ORDERS_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
[0m17:28:41.777379 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:28:41.779077 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */;
[0m17:28:41.780237 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:28:41.780378 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */;
[0m17:28:41.830744 [debug] [Thread-4 (]: SQL status: SUCCESS 7 in 0.052 seconds
[0m17:28:41.831162 [debug] [Thread-2 (]: SQL status: SUCCESS 6 in 0.053 seconds
[0m17:28:41.832308 [debug] [Thread-4 (]: 
    In "ALLIANZ"."DATAVAULT"."SAT_ORDERS_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:28:41.833277 [debug] [Thread-2 (]: 
    In "ALLIANZ"."DATAVAULT"."SAT_CUSTOMER_SPENDING_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:28:41.833883 [debug] [Thread-4 (]: Writing runtime sql for node "model.dbt_project.sat_orders_v0"
[0m17:28:41.838322 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.sat_customer_spending_v0"
[0m17:28:41.839282 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:28:41.840031 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */;
[0m17:28:41.839872 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:28:41.840612 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */;
[0m17:28:41.842907 [debug] [Thread-3 (]: SQL status: SUCCESS 8 in 0.066 seconds
[0m17:28:41.843957 [debug] [Thread-3 (]: 
    In "ALLIANZ"."DATAVAULT"."SAT_CUSTOMER_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:28:41.844468 [debug] [Thread-3 (]: Writing runtime sql for node "model.dbt_project.sat_customer_v0"
[0m17:28:41.845316 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:28:41.845484 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */;
[0m17:28:41.846590 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.066 seconds
[0m17:28:41.846762 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:28:41.846946 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: merge into allianz.datavault.sat_product_discount_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.sat_product_discount_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.product_discount_hk = DBT_INTERNAL_DEST.product_discount_hk
                )

    
    when matched then update set
        "PRODUCT_DISCOUNT_HK" = DBT_INTERNAL_SOURCE."PRODUCT_DISCOUNT_HK","PRODUCT_HK" = DBT_INTERNAL_SOURCE."PRODUCT_HK","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE","DISCOUNT_NAME" = DBT_INTERNAL_SOURCE."DISCOUNT_NAME","DISCOUNT_PERCENTAGE" = DBT_INTERNAL_SOURCE."DISCOUNT_PERCENTAGE"
    

    when not matched then insert
        ("PRODUCT_DISCOUNT_HK", "PRODUCT_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "DISCOUNT_NAME", "DISCOUNT_PERCENTAGE")
    values
        ("PRODUCT_DISCOUNT_HK", "PRODUCT_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "DISCOUNT_NAME", "DISCOUNT_PERCENTAGE")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */;
[0m17:28:41.850997 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.072 seconds
[0m17:28:41.852497 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:28:41.852653 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: describe table "ALLIANZ"."DATAVAULT"."SAT_CUSTOMER_PROFESSION_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
[0m17:28:41.864520 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 0.086 seconds
[0m17:28:41.864740 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:28:41.864892 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: merge into allianz.datavault.sat_product_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.sat_product_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.product_hk = DBT_INTERNAL_DEST.product_hk
                ) and (
                    DBT_INTERNAL_SOURCE.DV_HASH_DIFF = DBT_INTERNAL_DEST.DV_HASH_DIFF
                )

    
    when matched then update set
        "PRODUCT_HK" = DBT_INTERNAL_SOURCE."PRODUCT_HK","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE","DV_HASH_DIFF" = DBT_INTERNAL_SOURCE."DV_HASH_DIFF","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","PRODUCT_NAME" = DBT_INTERNAL_SOURCE."PRODUCT_NAME","PRODUCT_DESCRIPTION" = DBT_INTERNAL_SOURCE."PRODUCT_DESCRIPTION","PRODUCT_SIZES" = DBT_INTERNAL_SOURCE."PRODUCT_SIZES","BRAND_NAME" = DBT_INTERNAL_SOURCE."BRAND_NAME"
    

    when not matched then insert
        ("PRODUCT_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "DV_HASH_DIFF", "PRODUCT_ID", "PRODUCT_NAME", "PRODUCT_DESCRIPTION", "PRODUCT_SIZES", "BRAND_NAME")
    values
        ("PRODUCT_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "DV_HASH_DIFF", "PRODUCT_ID", "PRODUCT_NAME", "PRODUCT_DESCRIPTION", "PRODUCT_SIZES", "BRAND_NAME")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */;
[0m17:28:41.893056 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.114 seconds
[0m17:28:41.893230 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:28:41.893384 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: merge into allianz.datavault.sat_product_category_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.sat_product_category_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.product_category_hk = DBT_INTERNAL_DEST.product_category_hk
                )

    
    when matched then update set
        "PRODUCT_CATEGORY_HK" = DBT_INTERNAL_SOURCE."PRODUCT_CATEGORY_HK","PRODUCT_HK" = DBT_INTERNAL_SOURCE."PRODUCT_HK","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE","CATEGORY_NAME" = DBT_INTERNAL_SOURCE."CATEGORY_NAME"
    

    when not matched then insert
        ("PRODUCT_CATEGORY_HK", "PRODUCT_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "CATEGORY_NAME")
    values
        ("PRODUCT_CATEGORY_HK", "PRODUCT_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "CATEGORY_NAME")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */;
[0m17:28:41.910407 [debug] [Thread-1 (]: SQL status: SUCCESS 9 in 0.058 seconds
[0m17:28:41.911751 [debug] [Thread-1 (]: 
    In "ALLIANZ"."DATAVAULT"."SAT_CUSTOMER_PROFESSION_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:28:41.912405 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.sat_customer_profession_v0"
[0m17:28:41.913215 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:28:41.913369 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */;
[0m17:28:41.917497 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.077 seconds
[0m17:28:41.917710 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:28:41.917903 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: merge into allianz.datavault.sat_customer_spending_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.sat_customer_spending_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.customer_spending_hk = DBT_INTERNAL_DEST.customer_spending_hk
                )

    
    when matched then update set
        "CUSTOMER_SPENDING_HK" = DBT_INTERNAL_SOURCE."CUSTOMER_SPENDING_HK","CUSTOMER_HK" = DBT_INTERNAL_SOURCE."CUSTOMER_HK","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE","SPENDING_SCORE" = DBT_INTERNAL_SOURCE."SPENDING_SCORE","SPENDING_BUCKET" = DBT_INTERNAL_SOURCE."SPENDING_BUCKET"
    

    when not matched then insert
        ("CUSTOMER_SPENDING_HK", "CUSTOMER_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "SPENDING_SCORE", "SPENDING_BUCKET")
    values
        ("CUSTOMER_SPENDING_HK", "CUSTOMER_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "SPENDING_SCORE", "SPENDING_BUCKET")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */;
[0m17:28:41.932880 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.092 seconds
[0m17:28:41.933079 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:28:41.933460 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.088 seconds
[0m17:28:41.933697 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: merge into allianz.datavault.sat_orders_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.sat_orders_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_hk = DBT_INTERNAL_DEST.order_hk
                ) and (
                    DBT_INTERNAL_SOURCE.DV_HASH_DIFF = DBT_INTERNAL_DEST.DV_HASH_DIFF
                )

    
    when matched then update set
        "ORDER_HK" = DBT_INTERNAL_SOURCE."ORDER_HK","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE","DV_HASH_DIFF" = DBT_INTERNAL_SOURCE."DV_HASH_DIFF","ORDER_ID" = DBT_INTERNAL_SOURCE."ORDER_ID","QUANTITY" = DBT_INTERNAL_SOURCE."QUANTITY","AMOUNT" = DBT_INTERNAL_SOURCE."AMOUNT"
    

    when not matched then insert
        ("ORDER_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "DV_HASH_DIFF", "ORDER_ID", "QUANTITY", "AMOUNT")
    values
        ("ORDER_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "DV_HASH_DIFF", "ORDER_ID", "QUANTITY", "AMOUNT")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */;
[0m17:28:41.933938 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:28:41.934317 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: merge into allianz.datavault.sat_customer_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.sat_customer_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.customer_hk = DBT_INTERNAL_DEST.customer_hk
                ) and (
                    DBT_INTERNAL_SOURCE.DV_HASH_DIFF = DBT_INTERNAL_DEST.DV_HASH_DIFF
                )

    
    when matched then update set
        "CUSTOMER_HK" = DBT_INTERNAL_SOURCE."CUSTOMER_HK","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE","DV_HASH_DIFF" = DBT_INTERNAL_SOURCE."DV_HASH_DIFF","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","GENDER" = DBT_INTERNAL_SOURCE."GENDER","AGE" = DBT_INTERNAL_SOURCE."AGE","FAMILY_SIZE" = DBT_INTERNAL_SOURCE."FAMILY_SIZE"
    

    when not matched then insert
        ("CUSTOMER_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "DV_HASH_DIFF", "CUSTOMER_ID", "GENDER", "AGE", "FAMILY_SIZE")
    values
        ("CUSTOMER_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "DV_HASH_DIFF", "CUSTOMER_ID", "GENDER", "AGE", "FAMILY_SIZE")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */;
[0m17:28:41.980326 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.067 seconds
[0m17:28:41.980602 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:28:41.980857 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: merge into allianz.datavault.sat_customer_profession_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.sat_customer_profession_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.customer_profession_hk = DBT_INTERNAL_DEST.customer_profession_hk
                )

    
    when matched then update set
        "CUSTOMER_PROFESSION_HK" = DBT_INTERNAL_SOURCE."CUSTOMER_PROFESSION_HK","CUSTOMER_HK" = DBT_INTERNAL_SOURCE."CUSTOMER_HK","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE","PROFESSION" = DBT_INTERNAL_SOURCE."PROFESSION","RISK_CATEGORY" = DBT_INTERNAL_SOURCE."RISK_CATEGORY","ANNUAL_INCOME_INR" = DBT_INTERNAL_SOURCE."ANNUAL_INCOME_INR","ANNUAL_INCOME_BUCKET" = DBT_INTERNAL_SOURCE."ANNUAL_INCOME_BUCKET","WORK_EXPERIENCE" = DBT_INTERNAL_SOURCE."WORK_EXPERIENCE"
    

    when not matched then insert
        ("CUSTOMER_PROFESSION_HK", "CUSTOMER_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "PROFESSION", "RISK_CATEGORY", "ANNUAL_INCOME_INR", "ANNUAL_INCOME_BUCKET", "WORK_EXPERIENCE")
    values
        ("CUSTOMER_PROFESSION_HK", "CUSTOMER_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "PROFESSION", "RISK_CATEGORY", "ANNUAL_INCOME_INR", "ANNUAL_INCOME_BUCKET", "WORK_EXPERIENCE")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */;
[0m17:28:42.488264 [debug] [Thread-7 (]: SQL status: SUCCESS 4566 in 0.623 seconds
[0m17:28:42.488932 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:28:42.489253 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
[0m17:28:42.491207 [debug] [Thread-2 (]: SQL status: SUCCESS 2000 in 0.573 seconds
[0m17:28:42.491770 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:28:42.492141 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
[0m17:28:42.493516 [debug] [Thread-5 (]: SQL status: SUCCESS 4566 in 0.600 seconds
[0m17:28:42.494067 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:28:42.494433 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
[0m17:28:42.497895 [debug] [Thread-4 (]: SQL status: SUCCESS 5 in 0.564 seconds
[0m17:28:42.498206 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:28:42.498447 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
[0m17:28:42.587628 [debug] [Thread-6 (]: SQL status: SUCCESS 4566 in 0.740 seconds
[0m17:28:42.588774 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:28:42.589486 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
[0m17:28:42.676413 [debug] [Thread-1 (]: SQL status: SUCCESS 2000 in 0.695 seconds
[0m17:28:42.677667 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:28:42.678348 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
[0m17:28:42.696759 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.204 seconds
[0m17:28:42.704485 [debug] [Thread-2 (]: Applying DROP to: allianz.datavault.sat_customer_spending_v0__dbt_tmp
[0m17:28:42.708809 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_customer_spending_v0"
[0m17:28:42.709109 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: drop view if exists allianz.datavault.sat_customer_spending_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_spending_v0"} */
[0m17:28:42.710090 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 0.221 seconds
[0m17:28:42.711970 [debug] [Thread-7 (]: Applying DROP to: allianz.datavault.sat_product_v0__dbt_tmp
[0m17:28:42.712812 [debug] [Thread-7 (]: Using snowflake connection "model.dbt_project.sat_product_v0"
[0m17:28:42.713039 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: drop view if exists allianz.datavault.sat_product_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_v0"} */
[0m17:28:42.765703 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.271 seconds
[0m17:28:42.769013 [debug] [Thread-5 (]: Applying DROP to: allianz.datavault.sat_product_category_v0__dbt_tmp
[0m17:28:42.769724 [debug] [Thread-5 (]: Using snowflake connection "model.dbt_project.sat_product_category_v0"
[0m17:28:42.770316 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: drop view if exists allianz.datavault.sat_product_category_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_category_v0"} */
[0m17:28:42.771284 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.273 seconds
[0m17:28:42.773852 [debug] [Thread-4 (]: Applying DROP to: allianz.datavault.sat_orders_v0__dbt_tmp
[0m17:28:42.774435 [debug] [Thread-4 (]: Using snowflake connection "model.dbt_project.sat_orders_v0"
[0m17:28:42.774692 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: drop view if exists allianz.datavault.sat_orders_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v0"} */
[0m17:28:42.811922 [debug] [Thread-7 (]: SQL status: SUCCESS 1 in 0.098 seconds
[0m17:28:42.831125 [debug] [Thread-7 (]: On model.dbt_project.sat_product_v0: Close
[0m17:28:42.832876 [debug] [Thread-3 (]: SQL status: SUCCESS 2000 in 0.898 seconds
[0m17:28:42.833467 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.124 seconds
[0m17:28:42.833700 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:28:42.834749 [debug] [Thread-2 (]: On model.dbt_project.sat_customer_spending_v0: Close
[0m17:28:42.835064 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
[0m17:28:42.854634 [debug] [Thread-5 (]: SQL status: SUCCESS 1 in 0.084 seconds
[0m17:28:42.855666 [debug] [Thread-5 (]: On model.dbt_project.sat_product_category_v0: Close
[0m17:28:42.908781 [debug] [Thread-7 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd85a04c0-b751-4714-8e37-6de839f765a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e88fdd0>]}
[0m17:28:42.909363 [info ] [Thread-7 (]: 7 of 10 OK created sql incremental model datavault.sat_product_v0 .............. [[32mSUCCESS 4566[0m in 2.27s]
[0m17:28:42.909818 [debug] [Thread-7 (]: Finished running node model.dbt_project.sat_product_v0
[0m17:28:42.916731 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd85a04c0-b751-4714-8e37-6de839f765a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e82adb0>]}
[0m17:28:42.917279 [info ] [Thread-2 (]: 2 of 10 OK created sql incremental model datavault.sat_customer_spending_v0 .... [[32mSUCCESS 2000[0m in 2.28s]
[0m17:28:42.917694 [debug] [Thread-2 (]: Finished running node model.dbt_project.sat_customer_spending_v0
[0m17:28:42.936205 [debug] [Thread-5 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd85a04c0-b751-4714-8e37-6de839f765a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f80d70>]}
[0m17:28:42.936702 [info ] [Thread-5 (]: 5 of 10 OK created sql incremental model datavault.sat_product_category_v0 ..... [[32mSUCCESS 4566[0m in 2.30s]
[0m17:28:42.937086 [debug] [Thread-5 (]: Finished running node model.dbt_project.sat_product_category_v0
[0m17:28:42.946448 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.268 seconds
[0m17:28:42.948949 [debug] [Thread-1 (]: Applying DROP to: allianz.datavault.sat_customer_profession_v0__dbt_tmp
[0m17:28:42.949625 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_customer_profession_v0"
[0m17:28:42.949914 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: drop view if exists allianz.datavault.sat_customer_profession_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_profession_v0"} */
[0m17:28:42.962908 [debug] [Thread-4 (]: SQL status: SUCCESS 1 in 0.188 seconds
[0m17:28:42.964365 [debug] [Thread-4 (]: On model.dbt_project.sat_orders_v0: Close
[0m17:28:42.973460 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.383 seconds
[0m17:28:42.975414 [debug] [Thread-6 (]: Applying DROP to: allianz.datavault.sat_product_discount_v0__dbt_tmp
[0m17:28:42.975954 [debug] [Thread-6 (]: Using snowflake connection "model.dbt_project.sat_product_discount_v0"
[0m17:28:42.976183 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: drop view if exists allianz.datavault.sat_product_discount_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_product_discount_v0"} */
[0m17:28:43.021166 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.184 seconds
[0m17:28:43.026044 [debug] [Thread-3 (]: Applying DROP to: allianz.datavault.sat_customer_v0__dbt_tmp
[0m17:28:43.026954 [debug] [Thread-3 (]: Using snowflake connection "model.dbt_project.sat_customer_v0"
[0m17:28:43.027221 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: drop view if exists allianz.datavault.sat_customer_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_customer_v0"} */
[0m17:28:43.035308 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 0.085 seconds
[0m17:28:43.036839 [debug] [Thread-1 (]: On model.dbt_project.sat_customer_profession_v0: Close
[0m17:28:43.046689 [debug] [Thread-4 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd85a04c0-b751-4714-8e37-6de839f765a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110863a50>]}
[0m17:28:43.047163 [info ] [Thread-4 (]: 4 of 10 OK created sql incremental model datavault.sat_orders_v0 ............... [[32mSUCCESS 5[0m in 2.41s]
[0m17:28:43.047573 [debug] [Thread-4 (]: Finished running node model.dbt_project.sat_orders_v0
[0m17:28:43.069841 [debug] [Thread-6 (]: SQL status: SUCCESS 1 in 0.093 seconds
[0m17:28:43.071788 [debug] [Thread-6 (]: On model.dbt_project.sat_product_discount_v0: Close
[0m17:28:43.115332 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd85a04c0-b751-4714-8e37-6de839f765a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e7ddef0>]}
[0m17:28:43.116312 [info ] [Thread-1 (]: 1 of 10 OK created sql incremental model datavault.sat_customer_profession_v0 .. [[32mSUCCESS 2000[0m in 2.48s]
[0m17:28:43.116871 [debug] [Thread-1 (]: Finished running node model.dbt_project.sat_customer_profession_v0
[0m17:28:43.131446 [debug] [Thread-3 (]: SQL status: SUCCESS 1 in 0.104 seconds
[0m17:28:43.133839 [debug] [Thread-3 (]: On model.dbt_project.sat_customer_v0: Close
[0m17:28:43.165173 [debug] [Thread-6 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd85a04c0-b751-4714-8e37-6de839f765a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041f0d70>]}
[0m17:28:43.165791 [info ] [Thread-6 (]: 6 of 10 OK created sql incremental model datavault.sat_product_discount_v0 ..... [[32mSUCCESS 4566[0m in 2.53s]
[0m17:28:43.166260 [debug] [Thread-6 (]: Finished running node model.dbt_project.sat_product_discount_v0
[0m17:28:43.166758 [debug] [Thread-8 (]: Began running node model.dbt_project.hub_product_v0
[0m17:28:43.167169 [info ] [Thread-8 (]: 8 of 10 START sql incremental model datavault.hub_product_v0 ................... [RUN]
[0m17:28:43.167621 [debug] [Thread-8 (]: Acquiring new snowflake connection 'model.dbt_project.hub_product_v0'
[0m17:28:43.167914 [debug] [Thread-8 (]: Began compiling node model.dbt_project.hub_product_v0
[0m17:28:43.171150 [debug] [Thread-8 (]: Writing injected SQL for node "model.dbt_project.hub_product_v0"
[0m17:28:43.172312 [debug] [Thread-8 (]: Began executing node model.dbt_project.hub_product_v0
[0m17:28:43.175293 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:28:43.175570 [debug] [Thread-8 (]: On model.dbt_project.hub_product_v0: select * from (
        -- depends_on: allianz.datavault.sat_product_v0
-- depends_on: allianz.datavault.sat_product_category_v0
-- depends_on: allianz.datavault.sat_product_discount_v0



with source_data as (
    select distinct
        CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
        , product_id
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
    from 
        allianz.stage.stg_product_v0 stg
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
[0m17:28:43.175852 [debug] [Thread-8 (]: Opening a new connection, currently in state init
[0m17:28:43.221246 [debug] [Thread-3 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd85a04c0-b751-4714-8e37-6de839f765a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110865c10>]}
[0m17:28:43.221651 [info ] [Thread-3 (]: 3 of 10 OK created sql incremental model datavault.sat_customer_v0 ............. [[32mSUCCESS 2000[0m in 2.58s]
[0m17:28:43.221936 [debug] [Thread-3 (]: Finished running node model.dbt_project.sat_customer_v0
[0m17:28:43.222218 [debug] [Thread-9 (]: Began running node model.dbt_project.hub_customer_v0
[0m17:28:43.222486 [info ] [Thread-9 (]: 9 of 10 START sql incremental model datavault.hub_customer_v0 .................. [RUN]
[0m17:28:43.222748 [debug] [Thread-9 (]: Acquiring new snowflake connection 'model.dbt_project.hub_customer_v0'
[0m17:28:43.222910 [debug] [Thread-9 (]: Began compiling node model.dbt_project.hub_customer_v0
[0m17:28:43.224907 [debug] [Thread-9 (]: Writing injected SQL for node "model.dbt_project.hub_customer_v0"
[0m17:28:43.225279 [debug] [Thread-9 (]: Began executing node model.dbt_project.hub_customer_v0
[0m17:28:43.226816 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:28:43.226996 [debug] [Thread-9 (]: On model.dbt_project.hub_customer_v0: select * from (
        -- depends_on: allianz.datavault.sat_customer_v0
-- depends_on: allianz.datavault.sat_customer_profession_v0
-- depends_on: allianz.datavault.sat_customer_spending_v0



with source_data as (
    select distinct
        CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , customer_id
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
    from 
        allianz.stage.stg_customer_v0 stg
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
[0m17:28:43.227157 [debug] [Thread-9 (]: Opening a new connection, currently in state init
[0m17:28:43.494812 [debug] [Thread-8 (]: SQL status: SUCCESS 0 in 0.319 seconds
[0m17:28:43.497970 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:28:43.498375 [debug] [Thread-8 (]: On model.dbt_project.hub_product_v0: select * from (
        select
    
      
    cast(null as binary)
     as product_hk, 
      
    cast(null as TEXT)
     as product_id, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
[0m17:28:43.503317 [debug] [Thread-9 (]: SQL status: SUCCESS 0 in 0.276 seconds
[0m17:28:43.504677 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:28:43.505015 [debug] [Thread-9 (]: On model.dbt_project.hub_customer_v0: select * from (
        select
    
      
    cast(null as binary)
     as customer_hk, 
      
    cast(null as integer)
     as customer_id, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
[0m17:28:43.564315 [debug] [Thread-9 (]: SQL status: SUCCESS 0 in 0.059 seconds
[0m17:28:43.566587 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:28:43.567085 [debug] [Thread-9 (]: On model.dbt_project.hub_customer_v0: create or replace  temporary view allianz.datavault.hub_customer_v0__dbt_tmp
  
  
  
  
  as (
    -- depends_on: allianz.datavault.sat_customer_v0
-- depends_on: allianz.datavault.sat_customer_profession_v0
-- depends_on: allianz.datavault.sat_customer_spending_v0



with source_data as (
    select distinct
        CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , customer_id
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
    from 
        allianz.stage.stg_customer_v0 stg
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */;
[0m17:28:43.580989 [debug] [Thread-8 (]: SQL status: SUCCESS 0 in 0.082 seconds
[0m17:28:43.583143 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:28:43.583564 [debug] [Thread-8 (]: On model.dbt_project.hub_product_v0: create or replace  temporary view allianz.datavault.hub_product_v0__dbt_tmp
  
  
  
  
  as (
    -- depends_on: allianz.datavault.sat_product_v0
-- depends_on: allianz.datavault.sat_product_category_v0
-- depends_on: allianz.datavault.sat_product_discount_v0



with source_data as (
    select distinct
        CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
        , product_id
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
    from 
        allianz.stage.stg_product_v0 stg
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */;
[0m17:28:43.764577 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.197 seconds
[0m17:28:43.769321 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:28:43.769768 [debug] [Thread-9 (]: On model.dbt_project.hub_customer_v0: describe table allianz.datavault.hub_customer_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
[0m17:28:43.836334 [debug] [Thread-9 (]: SQL status: SUCCESS 4 in 0.066 seconds
[0m17:28:43.838515 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:28:43.838710 [debug] [Thread-9 (]: On model.dbt_project.hub_customer_v0: describe table allianz.datavault.hub_customer_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
[0m17:28:43.840327 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 0.256 seconds
[0m17:28:43.842137 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:28:43.842369 [debug] [Thread-8 (]: On model.dbt_project.hub_product_v0: describe table allianz.datavault.hub_product_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
[0m17:28:43.899686 [debug] [Thread-9 (]: SQL status: SUCCESS 4 in 0.061 seconds
[0m17:28:43.901145 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:28:43.901314 [debug] [Thread-9 (]: On model.dbt_project.hub_customer_v0: describe table allianz.datavault.hub_customer_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
[0m17:28:43.912778 [debug] [Thread-8 (]: SQL status: SUCCESS 4 in 0.070 seconds
[0m17:28:43.914382 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:28:43.914546 [debug] [Thread-8 (]: On model.dbt_project.hub_product_v0: describe table allianz.datavault.hub_product_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
[0m17:28:43.967575 [debug] [Thread-9 (]: SQL status: SUCCESS 4 in 0.066 seconds
[0m17:28:43.969248 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:28:43.969449 [debug] [Thread-9 (]: On model.dbt_project.hub_customer_v0: describe table "ALLIANZ"."DATAVAULT"."HUB_CUSTOMER_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
[0m17:28:43.970742 [debug] [Thread-8 (]: SQL status: SUCCESS 4 in 0.056 seconds
[0m17:28:43.972688 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:28:43.972889 [debug] [Thread-8 (]: On model.dbt_project.hub_product_v0: describe table allianz.datavault.hub_product_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
[0m17:28:44.030751 [debug] [Thread-8 (]: SQL status: SUCCESS 4 in 0.058 seconds
[0m17:28:44.033441 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:28:44.033777 [debug] [Thread-8 (]: On model.dbt_project.hub_product_v0: describe table "ALLIANZ"."DATAVAULT"."HUB_PRODUCT_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
[0m17:28:44.047250 [debug] [Thread-9 (]: SQL status: SUCCESS 4 in 0.078 seconds
[0m17:28:44.048731 [debug] [Thread-9 (]: 
    In "ALLIANZ"."DATAVAULT"."HUB_CUSTOMER_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:28:44.049598 [debug] [Thread-9 (]: Writing runtime sql for node "model.dbt_project.hub_customer_v0"
[0m17:28:44.051627 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:28:44.051884 [debug] [Thread-9 (]: On model.dbt_project.hub_customer_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */;
[0m17:28:44.094138 [debug] [Thread-8 (]: SQL status: SUCCESS 4 in 0.060 seconds
[0m17:28:44.095053 [debug] [Thread-8 (]: 
    In "ALLIANZ"."DATAVAULT"."HUB_PRODUCT_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:28:44.095533 [debug] [Thread-8 (]: Writing runtime sql for node "model.dbt_project.hub_product_v0"
[0m17:28:44.096165 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:28:44.096302 [debug] [Thread-8 (]: On model.dbt_project.hub_product_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */;
[0m17:28:44.148427 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.096 seconds
[0m17:28:44.148632 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:28:44.148810 [debug] [Thread-9 (]: On model.dbt_project.hub_customer_v0: merge into allianz.datavault.hub_customer_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.hub_customer_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.customer_hk = DBT_INTERNAL_DEST.customer_hk
                )

    
    when matched then update set
        "CUSTOMER_HK" = DBT_INTERNAL_SOURCE."CUSTOMER_HK","CUSTOMER_ID" = DBT_INTERNAL_SOURCE."CUSTOMER_ID","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE"
    

    when not matched then insert
        ("CUSTOMER_HK", "CUSTOMER_ID", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE")
    values
        ("CUSTOMER_HK", "CUSTOMER_ID", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */;
[0m17:28:44.238842 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 0.142 seconds
[0m17:28:44.239305 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:28:44.239661 [debug] [Thread-8 (]: On model.dbt_project.hub_product_v0: merge into allianz.datavault.hub_product_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.hub_product_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.product_hk = DBT_INTERNAL_DEST.product_hk
                )

    
    when matched then update set
        "PRODUCT_HK" = DBT_INTERNAL_SOURCE."PRODUCT_HK","PRODUCT_ID" = DBT_INTERNAL_SOURCE."PRODUCT_ID","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE"
    

    when not matched then insert
        ("PRODUCT_HK", "PRODUCT_ID", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE")
    values
        ("PRODUCT_HK", "PRODUCT_ID", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */;
[0m17:28:44.718293 [debug] [Thread-9 (]: SQL status: SUCCESS 2000 in 0.569 seconds
[0m17:28:44.719169 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:28:44.719608 [debug] [Thread-9 (]: On model.dbt_project.hub_customer_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
[0m17:28:44.743587 [debug] [Thread-8 (]: SQL status: SUCCESS 4566 in 0.503 seconds
[0m17:28:44.744691 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:28:44.745033 [debug] [Thread-8 (]: On model.dbt_project.hub_product_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
[0m17:28:44.919877 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.200 seconds
[0m17:28:44.927243 [debug] [Thread-9 (]: Applying DROP to: allianz.datavault.hub_customer_v0__dbt_tmp
[0m17:28:44.928048 [debug] [Thread-9 (]: Using snowflake connection "model.dbt_project.hub_customer_v0"
[0m17:28:44.928354 [debug] [Thread-9 (]: On model.dbt_project.hub_customer_v0: drop view if exists allianz.datavault.hub_customer_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_customer_v0"} */
[0m17:28:44.970114 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 0.225 seconds
[0m17:28:44.972784 [debug] [Thread-8 (]: Applying DROP to: allianz.datavault.hub_product_v0__dbt_tmp
[0m17:28:44.973486 [debug] [Thread-8 (]: Using snowflake connection "model.dbt_project.hub_product_v0"
[0m17:28:44.973752 [debug] [Thread-8 (]: On model.dbt_project.hub_product_v0: drop view if exists allianz.datavault.hub_product_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.hub_product_v0"} */
[0m17:28:45.028874 [debug] [Thread-9 (]: SQL status: SUCCESS 1 in 0.100 seconds
[0m17:28:45.031484 [debug] [Thread-9 (]: On model.dbt_project.hub_customer_v0: Close
[0m17:28:45.119388 [debug] [Thread-9 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd85a04c0-b751-4714-8e37-6de839f765a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041b3e90>]}
[0m17:28:45.120570 [info ] [Thread-9 (]: 9 of 10 OK created sql incremental model datavault.hub_customer_v0 ............. [[32mSUCCESS 2000[0m in 1.90s]
[0m17:28:45.121190 [debug] [Thread-9 (]: Finished running node model.dbt_project.hub_customer_v0
[0m17:28:45.296021 [debug] [Thread-8 (]: SQL status: SUCCESS 1 in 0.322 seconds
[0m17:28:45.299501 [debug] [Thread-8 (]: On model.dbt_project.hub_product_v0: Close
[0m17:28:45.378738 [debug] [Thread-8 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd85a04c0-b751-4714-8e37-6de839f765a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ef97590>]}
[0m17:28:45.379915 [info ] [Thread-8 (]: 8 of 10 OK created sql incremental model datavault.hub_product_v0 .............. [[32mSUCCESS 4566[0m in 2.21s]
[0m17:28:45.380546 [debug] [Thread-8 (]: Finished running node model.dbt_project.hub_product_v0
[0m17:28:45.381485 [debug] [Thread-10 ]: Began running node model.dbt_project.lnk_orders_v0
[0m17:28:45.382045 [info ] [Thread-10 ]: 10 of 10 START sql incremental model datavault.lnk_orders_v0 ................... [RUN]
[0m17:28:45.382627 [debug] [Thread-10 ]: Acquiring new snowflake connection 'model.dbt_project.lnk_orders_v0'
[0m17:28:45.382966 [debug] [Thread-10 ]: Began compiling node model.dbt_project.lnk_orders_v0
[0m17:28:45.389113 [debug] [Thread-10 ]: Writing injected SQL for node "model.dbt_project.lnk_orders_v0"
[0m17:28:45.390081 [debug] [Thread-10 ]: Began executing node model.dbt_project.lnk_orders_v0
[0m17:28:45.393374 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:28:45.393547 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: select * from (
        -- depends_on: allianz.datavault.hub_customer_v0
-- depends_on: allianz.datavault.hub_product_v0
-- depends_on: allianz.datavault.sat_orders_v0



with source_data as (
    select distinct
        CAST(SHA2_BINARY(order_id || customer_id || product_id) as BINARY(32)) as lnk_orders_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(order_id) as BINARY(32)) as order_hk
        , CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
    from 
        allianz.stage.stg_sap_orders_v0
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
[0m17:28:45.393664 [debug] [Thread-10 ]: Opening a new connection, currently in state init
[0m17:28:45.806457 [debug] [Thread-10 ]: SQL status: SUCCESS 0 in 0.412 seconds
[0m17:28:45.809687 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:28:45.810246 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: select * from (
        select
    
      
    cast(null as binary)
     as lnk_orders_hk, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE, 
      
    cast(null as binary)
     as order_hk, 
      
    cast(null as binary)
     as customer_hk, 
      
    cast(null as binary)
     as product_hk
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
[0m17:28:45.876520 [debug] [Thread-10 ]: SQL status: SUCCESS 0 in 0.066 seconds
[0m17:28:45.880943 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:28:45.881398 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: create or replace  temporary view allianz.datavault.lnk_orders_v0__dbt_tmp
  
  
  
  
  as (
    -- depends_on: allianz.datavault.hub_customer_v0
-- depends_on: allianz.datavault.hub_product_v0
-- depends_on: allianz.datavault.sat_orders_v0



with source_data as (
    select distinct
        CAST(SHA2_BINARY(order_id || customer_id || product_id) as BINARY(32)) as lnk_orders_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(order_id) as BINARY(32)) as order_hk
        , CAST(SHA2_BINARY(customer_id) as BINARY(32)) as customer_hk
        , CAST(SHA2_BINARY(product_id) as BINARY(32)) as product_hk
    from 
        allianz.stage.stg_sap_orders_v0
)

select * from source_data
  )
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */;
[0m17:28:46.854663 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.973 seconds
[0m17:28:46.861690 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:28:46.862189 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: describe table allianz.datavault.lnk_orders_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
[0m17:28:46.954020 [debug] [Thread-10 ]: SQL status: SUCCESS 6 in 0.092 seconds
[0m17:28:46.955749 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:28:46.955945 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: describe table allianz.datavault.lnk_orders_v0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
[0m17:28:47.050591 [debug] [Thread-10 ]: SQL status: SUCCESS 6 in 0.094 seconds
[0m17:28:47.053547 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:28:47.053856 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: describe table allianz.datavault.lnk_orders_v0__dbt_tmp
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
[0m17:28:47.132451 [debug] [Thread-10 ]: SQL status: SUCCESS 6 in 0.078 seconds
[0m17:28:47.137031 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:28:47.137585 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: describe table "ALLIANZ"."DATAVAULT"."LNK_ORDERS_V0"
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
[0m17:28:47.261370 [debug] [Thread-10 ]: SQL status: SUCCESS 6 in 0.123 seconds
[0m17:28:47.263562 [debug] [Thread-10 ]: 
    In "ALLIANZ"."DATAVAULT"."LNK_ORDERS_V0":
        Schema changed: False
        Source columns not in target: []
        Target columns not in source: []
        New column types: []
  
[0m17:28:47.264837 [debug] [Thread-10 ]: Writing runtime sql for node "model.dbt_project.lnk_orders_v0"
[0m17:28:47.267699 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:28:47.268143 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: -- back compat for old kwarg name
  
  begin
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */;
[0m17:28:47.365704 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.097 seconds
[0m17:28:47.366083 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:28:47.366319 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: merge into allianz.datavault.lnk_orders_v0 as DBT_INTERNAL_DEST
        using allianz.datavault.lnk_orders_v0__dbt_tmp as DBT_INTERNAL_SOURCE
        on (
                    DBT_INTERNAL_SOURCE.order_hk = DBT_INTERNAL_DEST.order_hk
                )

    
    when matched then update set
        "LNK_ORDERS_HK" = DBT_INTERNAL_SOURCE."LNK_ORDERS_HK","DV_LOAD_DATETIME" = DBT_INTERNAL_SOURCE."DV_LOAD_DATETIME","DV_RECORD_SOURCE" = DBT_INTERNAL_SOURCE."DV_RECORD_SOURCE","ORDER_HK" = DBT_INTERNAL_SOURCE."ORDER_HK","CUSTOMER_HK" = DBT_INTERNAL_SOURCE."CUSTOMER_HK","PRODUCT_HK" = DBT_INTERNAL_SOURCE."PRODUCT_HK"
    

    when not matched then insert
        ("LNK_ORDERS_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "ORDER_HK", "CUSTOMER_HK", "PRODUCT_HK")
    values
        ("LNK_ORDERS_HK", "DV_LOAD_DATETIME", "DV_RECORD_SOURCE", "ORDER_HK", "CUSTOMER_HK", "PRODUCT_HK")


/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */;
[0m17:28:48.288085 [debug] [Thread-10 ]: SQL status: SUCCESS 5 in 0.921 seconds
[0m17:28:48.289439 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:28:48.289908 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: COMMIT
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
[0m17:28:48.521488 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.231 seconds
[0m17:28:48.523043 [debug] [Thread-10 ]: Applying DROP to: allianz.datavault.lnk_orders_v0__dbt_tmp
[0m17:28:48.523886 [debug] [Thread-10 ]: Using snowflake connection "model.dbt_project.lnk_orders_v0"
[0m17:28:48.524119 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: drop view if exists allianz.datavault.lnk_orders_v0__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.lnk_orders_v0"} */
[0m17:28:48.619199 [debug] [Thread-10 ]: SQL status: SUCCESS 1 in 0.095 seconds
[0m17:28:48.621587 [debug] [Thread-10 ]: On model.dbt_project.lnk_orders_v0: Close
[0m17:28:48.735470 [debug] [Thread-10 ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd85a04c0-b751-4714-8e37-6de839f765a7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1108b7ef0>]}
[0m17:28:48.736554 [info ] [Thread-10 ]: 10 of 10 OK created sql incremental model datavault.lnk_orders_v0 .............. [[32mSUCCESS 5[0m in 3.35s]
[0m17:28:48.737234 [debug] [Thread-10 ]: Finished running node model.dbt_project.lnk_orders_v0
[0m17:28:48.739667 [debug] [MainThread]: Connection 'master' was properly closed.
[0m17:28:48.740064 [debug] [MainThread]: Connection 'model.dbt_project.sat_customer_profession_v0' was properly closed.
[0m17:28:48.740310 [debug] [MainThread]: Connection 'model.dbt_project.sat_customer_spending_v0' was properly closed.
[0m17:28:48.740548 [debug] [MainThread]: Connection 'model.dbt_project.sat_customer_v0' was properly closed.
[0m17:28:48.740785 [debug] [MainThread]: Connection 'model.dbt_project.sat_orders_v0' was properly closed.
[0m17:28:48.741008 [debug] [MainThread]: Connection 'model.dbt_project.sat_product_category_v0' was properly closed.
[0m17:28:48.741219 [debug] [MainThread]: Connection 'model.dbt_project.sat_product_discount_v0' was properly closed.
[0m17:28:48.741426 [debug] [MainThread]: Connection 'model.dbt_project.sat_product_v0' was properly closed.
[0m17:28:48.741636 [debug] [MainThread]: Connection 'model.dbt_project.hub_product_v0' was properly closed.
[0m17:28:48.741838 [debug] [MainThread]: Connection 'model.dbt_project.hub_customer_v0' was properly closed.
[0m17:28:48.742048 [debug] [MainThread]: Connection 'model.dbt_project.lnk_orders_v0' was properly closed.
[0m17:28:48.742471 [info ] [MainThread]: 
[0m17:28:48.742849 [info ] [MainThread]: Finished running 10 incremental models in 0 hours 0 minutes and 13.60 seconds (13.60s).
[0m17:28:48.744733 [debug] [MainThread]: Command end result
[0m17:28:48.773393 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/manifest.json
[0m17:28:48.774913 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/semantic_manifest.json
[0m17:28:48.778415 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/run_results.json
[0m17:28:48.778581 [info ] [MainThread]: 
[0m17:28:48.778749 [info ] [MainThread]: [32mCompleted successfully[0m
[0m17:28:48.778876 [info ] [MainThread]: 
[0m17:28:48.779018 [info ] [MainThread]: Done. PASS=10 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=10
[0m17:28:48.781130 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 14.004481, "process_in_blocks": "0", "process_kernel_time": 0.290014, "process_mem_max_rss": "178159616", "process_out_blocks": "0", "process_user_time": 2.044276}
[0m17:28:48.781426 [debug] [MainThread]: Command `dbt run` succeeded at 17:28:48.781372 after 14.00 seconds
[0m17:28:48.781622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1053775f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f57dd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110f57cb0>]}
[0m17:28:48.781805 [debug] [MainThread]: Flushing usage events
[0m17:28:49.277410 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:41:16.701627 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103dab620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c27b10>]}


============================== 09:41:16.704078 | f646f569-fe92-4b38-8456-2e147b64a228 ==============================
[0m09:41:16.704078 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:41:16.704311 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'use_colors': 'True', 'log_cache_events': 'False', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'warn_error': 'None', 'no_print': 'None', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'empty': 'False', 'fail_fast': 'False', 'cache_selected_only': 'False', 'write_json': 'True', 'quiet': 'False', 'use_experimental_parser': 'False', 'invocation_command': 'dbt run --select sat_orders_v1', 'log_path': '/Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/logs', 'static_parser': 'True', 'profiles_dir': '/Users/vijaypalanichamy/.dbt', 'target_path': 'None', 'partial_parse': 'True', 'debug': 'False', 'introspect': 'True'}
[0m09:41:16.938797 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f646f569-fe92-4b38-8456-2e147b64a228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b3f230>]}
[0m09:41:16.956388 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f646f569-fe92-4b38-8456-2e147b64a228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069eb9b0>]}
[0m09:41:16.956740 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m09:41:17.003713 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m09:41:17.004044 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:41:17.004178 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f646f569-fe92-4b38-8456-2e147b64a228', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b9c850>]}
[0m09:41:17.316906 [error] [MainThread]: Encountered an error:
Compilation Error in model sat_orders_v1 (models/datavault/sat/sat_orders_v1.sql)
  unexpected '%'
    line 8
      -%}
[0m09:41:17.318305 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.6451182, "process_in_blocks": "0", "process_kernel_time": 0.155844, "process_mem_max_rss": "137428992", "process_out_blocks": "0", "process_user_time": 0.891978}
[0m09:41:17.318549 [debug] [MainThread]: Command `dbt run` failed at 09:41:17.318499 after 0.65 seconds
[0m09:41:17.318710 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fadb80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106facaa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105c07e70>]}
[0m09:41:17.318823 [debug] [MainThread]: Flushing usage events
[0m09:41:17.764147 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:41:38.286691 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103ccb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1051e7b10>]}


============================== 09:41:38.288283 | 27891559-741e-4693-b6bb-21c0a9bc79b8 ==============================
[0m09:41:38.288283 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:41:38.288519 [debug] [MainThread]: running dbt with arguments {'log_format': 'default', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'no_print': 'None', 'static_parser': 'True', 'invocation_command': 'dbt run --select sat_orders_v1', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'use_experimental_parser': 'False', 'partial_parse': 'True', 'target_path': 'None', 'introspect': 'True', 'log_path': '/Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/logs', 'version_check': 'True', 'warn_error': 'None', 'printer_width': '80', 'write_json': 'True', 'cache_selected_only': 'False', 'quiet': 'False', 'profiles_dir': '/Users/vijaypalanichamy/.dbt', 'use_colors': 'True', 'indirect_selection': 'eager', 'fail_fast': 'False', 'log_cache_events': 'False', 'empty': 'False'}
[0m09:41:38.431076 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '27891559-741e-4693-b6bb-21c0a9bc79b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1044ff230>]}
[0m09:41:38.448976 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '27891559-741e-4693-b6bb-21c0a9bc79b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d1b9b0>]}
[0m09:41:38.449300 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m09:41:38.484557 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m09:41:38.484883 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:41:38.485025 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '27891559-741e-4693-b6bb-21c0a9bc79b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dc8850>]}
[0m09:41:38.937667 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '27891559-741e-4693-b6bb-21c0a9bc79b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062d33e0>]}
[0m09:41:38.970327 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/manifest.json
[0m09:41:38.971344 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/semantic_manifest.json
[0m09:41:38.981989 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '27891559-741e-4693-b6bb-21c0a9bc79b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1063727b0>]}
[0m09:41:38.982174 [info ] [MainThread]: Found 16 models, 33 data tests, 3 sources, 479 macros
[0m09:41:38.982295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27891559-741e-4693-b6bb-21c0a9bc79b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107193ee0>]}
[0m09:41:38.983007 [info ] [MainThread]: 
[0m09:41:38.983127 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m09:41:38.983214 [info ] [MainThread]: 
[0m09:41:38.983378 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:41:38.983678 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_allianz'
[0m09:41:39.006960 [debug] [ThreadPool]: Using snowflake connection "list_allianz"
[0m09:41:39.007145 [debug] [ThreadPool]: On list_allianz: show terse schemas in database allianz
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz"} */
[0m09:41:39.007250 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:41:41.836605 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.829 seconds
[0m09:41:41.839300 [debug] [ThreadPool]: On list_allianz: Close
[0m09:41:42.000396 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_allianz, now list_allianz_datavault)
[0m09:41:42.001398 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_allianz_validation'
[0m09:41:42.016388 [debug] [ThreadPool]: Using snowflake connection "list_allianz_datavault"
[0m09:41:42.016879 [debug] [ThreadPool]: Using snowflake connection "list_allianz_validation"
[0m09:41:42.017151 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_allianz_stage'
[0m09:41:42.017337 [debug] [ThreadPool]: On list_allianz_datavault: show objects in allianz.datavault
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz_datavault"} */;
[0m09:41:42.017534 [debug] [ThreadPool]: On list_allianz_validation: show objects in allianz.validation
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz_validation"} */;
[0m09:41:42.018738 [debug] [ThreadPool]: Using snowflake connection "list_allianz_stage"
[0m09:41:42.018896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:41:42.019020 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:41:42.019141 [debug] [ThreadPool]: On list_allianz_stage: show objects in allianz.stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz_stage"} */;
[0m09:41:42.019692 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:41:44.408011 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.389 seconds
[0m09:41:44.410135 [debug] [ThreadPool]: On list_allianz_validation: Close
[0m09:41:44.425499 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 2.406 seconds
[0m09:41:44.426489 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.407 seconds
[0m09:41:44.428844 [debug] [ThreadPool]: On list_allianz_datavault: Close
[0m09:41:44.430472 [debug] [ThreadPool]: On list_allianz_stage: Close
[0m09:41:44.578889 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '27891559-741e-4693-b6bb-21c0a9bc79b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071aa750>]}
[0m09:41:44.582966 [debug] [Thread-1 (]: Began running node model.dbt_project.sat_orders_v1
[0m09:41:44.583411 [info ] [Thread-1 (]: 1 of 1 START sql incremental model datavault.sat_orders_v1 ..................... [RUN]
[0m09:41:44.583753 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_allianz_datavault, now model.dbt_project.sat_orders_v1)
[0m09:41:44.583993 [debug] [Thread-1 (]: Began compiling node model.dbt_project.sat_orders_v1
[0m09:41:44.595547 [debug] [Thread-1 (]: Compilation Error in model sat_orders_v1 (models/datavault/sat/sat_orders_v1.sql)
  'automate_dv' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:41:44.596898 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '27891559-741e-4693-b6bb-21c0a9bc79b8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3b26d0>]}
[0m09:41:44.597259 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model datavault.sat_orders_v1 ............ [[31mERROR[0m in 0.01s]
[0m09:41:44.597527 [debug] [Thread-1 (]: Finished running node model.dbt_project.sat_orders_v1
[0m09:41:44.597774 [debug] [Thread-13 ]: Marking all children of 'model.dbt_project.sat_orders_v1' to be skipped because of status 'error'.  Reason: Compilation Error in model sat_orders_v1 (models/datavault/sat/sat_orders_v1.sql)
  'automate_dv' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps"..
[0m09:41:44.598912 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:41:44.599060 [debug] [MainThread]: Connection 'model.dbt_project.sat_orders_v1' was properly closed.
[0m09:41:44.599167 [debug] [MainThread]: Connection 'list_allianz_validation' was properly closed.
[0m09:41:44.599264 [debug] [MainThread]: Connection 'list_allianz_stage' was properly closed.
[0m09:41:44.599386 [info ] [MainThread]: 
[0m09:41:44.599524 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 5.62 seconds (5.62s).
[0m09:41:44.599785 [debug] [MainThread]: Command end result
[0m09:41:44.619558 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/manifest.json
[0m09:41:44.620542 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/semantic_manifest.json
[0m09:41:44.623015 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/run_results.json
[0m09:41:44.623145 [info ] [MainThread]: 
[0m09:41:44.623294 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:41:44.623409 [info ] [MainThread]: 
[0m09:41:44.623549 [error] [MainThread]: [31mFailure in model sat_orders_v1 (models/datavault/sat/sat_orders_v1.sql)[0m
[0m09:41:44.623684 [error] [MainThread]:   Compilation Error in model sat_orders_v1 (models/datavault/sat/sat_orders_v1.sql)
  'automate_dv' is undefined. This can happen when calling a macro that does not exist. Check for typos and/or install package dependencies with "dbt deps".
[0m09:41:44.623783 [info ] [MainThread]: 
[0m09:41:44.623896 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m09:41:44.625059 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.361117, "process_in_blocks": "0", "process_kernel_time": 0.237718, "process_mem_max_rss": "180207616", "process_out_blocks": "0", "process_user_time": 1.540752}
[0m09:41:44.625232 [debug] [MainThread]: Command `dbt run` failed at 09:41:44.625196 after 6.36 seconds
[0m09:41:44.625373 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d2e11d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d3ef020>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10666cb50>]}
[0m09:41:44.625501 [debug] [MainThread]: Flushing usage events
[0m09:41:45.061641 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:44:35.876971 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105a37620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f539d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f53b10>]}


============================== 09:44:35.879334 | 8137bdba-570d-470f-866d-b883b9a5e8e5 ==============================
[0m09:44:35.879334 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:44:35.879580 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'warn_error': 'None', 'cache_selected_only': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'debug': 'False', 'write_json': 'True', 'log_format': 'default', 'invocation_command': 'dbt run --select sat_orders_v1', 'no_print': 'None', 'profiles_dir': '/Users/vijaypalanichamy/.dbt', 'empty': 'False', 'indirect_selection': 'eager', 'version_check': 'True', 'printer_width': '80', 'quiet': 'False', 'static_parser': 'True', 'fail_fast': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'partial_parse': 'True', 'use_colors': 'True', 'log_path': '/Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/logs', 'use_experimental_parser': 'False'}
[0m09:44:36.089852 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8137bdba-570d-470f-866d-b883b9a5e8e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10626b230>]}
[0m09:44:36.109162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8137bdba-570d-470f-866d-b883b9a5e8e5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a4f9b0>]}
[0m09:44:36.109552 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m09:44:36.147843 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found 2 package(s) specified in packages.yml, but only 0 package(s) installed in dbt_packages. Run "dbt deps" to install package dependencies.
[0m09:44:36.149523 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.29845017, "process_in_blocks": "0", "process_kernel_time": 0.119982, "process_mem_max_rss": "131137536", "process_out_blocks": "0", "process_user_time": 0.610064}
[0m09:44:36.149869 [debug] [MainThread]: Command `dbt run` failed at 09:44:36.149829 after 0.30 seconds
[0m09:44:36.150039 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b00650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107b00850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a73890>]}
[0m09:44:36.150178 [debug] [MainThread]: Flushing usage events
[0m09:44:36.605615 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:44:43.629514 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1045fb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10611f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10611fb10>]}


============================== 09:44:43.631524 | f8e6f94c-4b86-47fd-bb53-62aabc56912f ==============================
[0m09:44:43.631524 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:44:43.631766 [debug] [MainThread]: running dbt with arguments {'no_print': 'None', 'empty': 'None', 'invocation_command': 'dbt deps', 'quiet': 'False', 'use_experimental_parser': 'False', 'log_cache_events': 'False', 'static_parser': 'True', 'indirect_selection': 'eager', 'debug': 'False', 'cache_selected_only': 'False', 'log_format': 'default', 'use_colors': 'True', 'warn_error': 'None', 'target_path': 'None', 'send_anonymous_usage_stats': 'True', 'log_path': '/Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/logs', 'write_json': 'True', 'partial_parse': 'True', 'introspect': 'True', 'printer_width': '80', 'version_check': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'profiles_dir': '/Users/vijaypalanichamy/.dbt', 'fail_fast': 'False'}
[0m09:44:43.674559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f8e6f94c-4b86-47fd-bb53-62aabc56912f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10513f230>]}
[0m09:44:43.683310 [debug] [MainThread]: Set downloads directory='/var/folders/ql/vz9cv_4n0d5b5gp5br328_3w0000gn/T/dbt-downloads-yp13ine2'
[0m09:44:43.683518 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:44:43.774691 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:44:43.775590 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m09:44:43.839235 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m09:44:43.843261 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json
[0m09:44:43.893663 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json 200
[0m09:44:43.900532 [info ] [MainThread]: Updating lock file in file path: /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/package-lock.yml
[0m09:44:43.902084 [debug] [MainThread]: Set downloads directory='/var/folders/ql/vz9cv_4n0d5b5gp5br328_3w0000gn/T/dbt-downloads-65otaexl'
[0m09:44:43.904032 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m09:44:44.181974 [info ] [MainThread]: Installed from version 1.3.0
[0m09:44:44.182207 [info ] [MainThread]: Up to date!
[0m09:44:44.182395 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f8e6f94c-4b86-47fd-bb53-62aabc56912f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc3130>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc2f10>]}
[0m09:44:44.182585 [info ] [MainThread]: Installing Datavault-UK/automate_dv
[0m09:44:44.477657 [info ] [MainThread]: Installed from version 0.9.7
[0m09:44:44.477896 [info ] [MainThread]: Updated version available: 0.11.2
[0m09:44:44.478059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': 'f8e6f94c-4b86-47fd-bb53-62aabc56912f', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106501f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fa75c0>]}
[0m09:44:44.478235 [info ] [MainThread]: 
[0m09:44:44.478368 [info ] [MainThread]: Updates available for packages: ['Datavault-UK/automate_dv']                 
Update your versions in packages.yml, then run dbt deps
[0m09:44:44.479842 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.8738116, "process_in_blocks": "0", "process_kernel_time": 0.118916, "process_mem_max_rss": "115589120", "process_out_blocks": "0", "process_user_time": 0.605654}
[0m09:44:44.480107 [debug] [MainThread]: Command `dbt deps` succeeded at 09:44:44.480044 after 0.87 seconds
[0m09:44:44.480273 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106103e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106243930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10600ec30>]}
[0m09:44:44.480418 [debug] [MainThread]: Flushing usage events
[0m09:44:44.904335 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:45:12.553188 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108afb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a61f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a61fb10>]}


============================== 09:45:12.554974 | 0ae884e2-1ac2-4231-9ce0-1151a83d2ad9 ==============================
[0m09:45:12.554974 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:45:12.555216 [debug] [MainThread]: running dbt with arguments {'fail_fast': 'False', 'log_format': 'default', 'log_path': '/Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/logs', 'profiles_dir': '/Users/vijaypalanichamy/.dbt', 'target_path': 'None', 'indirect_selection': 'eager', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'send_anonymous_usage_stats': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'debug': 'False', 'empty': 'None', 'static_parser': 'True', 'cache_selected_only': 'False', 'introspect': 'True', 'no_print': 'None', 'version_check': 'True', 'quiet': 'False', 'invocation_command': 'dbt deps', 'log_cache_events': 'False', 'printer_width': '80'}
[0m09:45:12.598029 [error] [MainThread]: Encountered an error:
'version'
[0m09:45:12.600852 [error] [MainThread]: Traceback (most recent call last):
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 178, in wrapper
    result, success = func(*args, **kwargs)
                      ~~~~^^^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 128, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 254, in wrapper
    return func(*args, **kwargs)
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/cli/requires.py", line 290, in wrapper
    project = load_project(
        flags.PROJECT_DIR, flags.VERSION_CHECK, ctx.obj["profile"], flags.VARS, validate=True
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/config/runtime.py", line 58, in load_project
    project = Project.from_project_root(
        project_root, project_renderer, verify_version=version_check, validate=validate
    )
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/config/project.py", line 771, in from_project_root
    return partial.render(renderer)
           ~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/config/project.py", line 337, in render
    return self.create_project(rendered)
           ~~~~~~~~~~~~~~~~~~~^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/config/project.py", line 484, in create_project
    packages: PackageConfig = package_config_from_data(
                              ~~~~~~~~~~~~~~~~~~~~~~~~^
        rendered.packages_dict, unrendered.packages_dict
        ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
    )
    ^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/config/project.py", line 148, in package_config_from_data
    PackageConfig.validate(packages_data)
    ~~~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^
  File "/Library/Frameworks/Python.framework/Versions/3.13/lib/python3.13/site-packages/dbt/contracts/project.py", line 140, in validate
    if not package["version"]:
           ~~~~~~~^^^^^^^^^^^
KeyError: 'version'

[0m09:45:12.601961 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": false, "command_wall_clock_time": 0.073723085, "process_in_blocks": "0", "process_kernel_time": 0.066391, "process_mem_max_rss": "108642304", "process_out_blocks": "0", "process_user_time": 0.464075}
[0m09:45:12.602144 [debug] [MainThread]: Command `dbt deps` failed at 09:45:12.602106 after 0.07 seconds
[0m09:45:12.602265 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6f2650>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a6f68d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a3c2250>]}
[0m09:45:12.602392 [debug] [MainThread]: Flushing usage events
[0m09:45:13.053290 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:45:42.654859 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071fb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10870f9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10870fb10>]}


============================== 09:45:42.656594 | 960bd608-ec9a-41d9-8867-a8b3aa6aa614 ==============================
[0m09:45:42.656594 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:45:42.656838 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'log_cache_events': 'False', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'partial_parse': 'True', 'use_colors': 'True', 'log_format': 'default', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True', 'version_check': 'True', 'cache_selected_only': 'False', 'invocation_command': 'dbt deps', 'write_json': 'True', 'profiles_dir': '/Users/vijaypalanichamy/.dbt', 'no_print': 'None', 'log_path': '/Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/logs', 'target_path': 'None', 'indirect_selection': 'eager', 'debug': 'False', 'fail_fast': 'False', 'introspect': 'True', 'quiet': 'False', 'empty': 'None', 'warn_error': 'None', 'use_experimental_parser': 'False'}
[0m09:45:42.699762 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '960bd608-ec9a-41d9-8867-a8b3aa6aa614', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a2f230>]}
[0m09:45:42.709140 [debug] [MainThread]: Set downloads directory='/var/folders/ql/vz9cv_4n0d5b5gp5br328_3w0000gn/T/dbt-downloads-sv0d7682'
[0m09:45:42.709344 [debug] [MainThread]: Making package index registry request: GET https://hub.getdbt.com/api/v1/index.json
[0m09:45:42.815374 [debug] [MainThread]: Response from registry index: GET https://hub.getdbt.com/api/v1/index.json 200
[0m09:45:42.816325 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json
[0m09:45:42.862534 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/dbt-labs/dbt_utils.json 200
[0m09:45:42.866127 [debug] [MainThread]: Making package registry request: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json
[0m09:45:42.921175 [debug] [MainThread]: Response from registry: GET https://hub.getdbt.com/api/v1/Datavault-UK/automate_dv.json 200
[0m09:45:42.926942 [info ] [MainThread]: Updating lock file in file path: /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/package-lock.yml
[0m09:45:42.946994 [debug] [MainThread]: Set downloads directory='/var/folders/ql/vz9cv_4n0d5b5gp5br328_3w0000gn/T/dbt-downloads-5dgze0qz'
[0m09:45:42.948720 [info ] [MainThread]: Installing dbt-labs/dbt_utils
[0m09:45:43.215478 [info ] [MainThread]: Installed from version 1.3.0
[0m09:45:43.215707 [info ] [MainThread]: Up to date!
[0m09:45:43.215871 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '960bd608-ec9a-41d9-8867-a8b3aa6aa614', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085b2580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085b3130>]}
[0m09:45:43.216044 [info ] [MainThread]: Installing Datavault-UK/automate_dv
[0m09:45:43.520361 [info ] [MainThread]: Installed from version 0.11.2
[0m09:45:43.520665 [info ] [MainThread]: Up to date!
[0m09:45:43.520874 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'package', 'label': '960bd608-ec9a-41d9-8867-a8b3aa6aa614', 'property_': 'install', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088f5f50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1085975c0>]}
[0m09:45:43.523042 [debug] [MainThread]: Resource report: {"command_name": "deps", "command_success": true, "command_wall_clock_time": 0.89517766, "process_in_blocks": "0", "process_kernel_time": 0.151732, "process_mem_max_rss": "116146176", "process_out_blocks": "0", "process_user_time": 0.60441}
[0m09:45:43.523349 [debug] [MainThread]: Command `dbt deps` succeeded at 09:45:43.523282 after 0.90 seconds
[0m09:45:43.523550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086f7e70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108836eb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108982c30>]}
[0m09:45:43.523730 [debug] [MainThread]: Flushing usage events
[0m09:45:43.954652 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:55:27.897921 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1040bb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055d79d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055d7b10>]}


============================== 09:55:27.900318 | ae8e92b9-a726-48fa-9e2a-8d5679e43d65 ==============================
[0m09:55:27.900318 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:55:27.900551 [debug] [MainThread]: running dbt with arguments {'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'cache_selected_only': 'False', 'send_anonymous_usage_stats': 'True', 'log_cache_events': 'False', 'empty': 'False', 'introspect': 'True', 'warn_error': 'None', 'log_format': 'default', 'log_path': '/Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/logs', 'printer_width': '80', 'no_print': 'None', 'indirect_selection': 'eager', 'use_experimental_parser': 'False', 'quiet': 'False', 'fail_fast': 'False', 'target_path': 'None', 'write_json': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run --select sat_orders_v1', 'partial_parse': 'True', 'version_check': 'True', 'debug': 'False', 'profiles_dir': '/Users/vijaypalanichamy/.dbt', 'use_colors': 'True'}
[0m09:55:28.116109 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ae8e92b9-a726-48fa-9e2a-8d5679e43d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1048ef230>]}
[0m09:55:28.135635 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ae8e92b9-a726-48fa-9e2a-8d5679e43d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1060d79b0>]}
[0m09:55:28.136236 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m09:55:28.180544 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m09:55:28.180960 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m09:55:28.181154 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'ae8e92b9-a726-48fa-9e2a-8d5679e43d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106180c50>]}
[0m09:55:28.997186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ae8e92b9-a726-48fa-9e2a-8d5679e43d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067566c0>]}
[0m09:55:29.036597 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/manifest.json
[0m09:55:29.037671 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/semantic_manifest.json
[0m09:55:29.047295 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ae8e92b9-a726-48fa-9e2a-8d5679e43d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1069e9470>]}
[0m09:55:29.047467 [info ] [MainThread]: Found 16 models, 33 data tests, 3 sources, 866 macros
[0m09:55:29.047583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae8e92b9-a726-48fa-9e2a-8d5679e43d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107717ee0>]}
[0m09:55:29.048267 [info ] [MainThread]: 
[0m09:55:29.048383 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m09:55:29.048470 [info ] [MainThread]: 
[0m09:55:29.048634 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:55:29.048936 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_allianz'
[0m09:55:29.072633 [debug] [ThreadPool]: Using snowflake connection "list_allianz"
[0m09:55:29.072789 [debug] [ThreadPool]: On list_allianz: show terse schemas in database allianz
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz"} */
[0m09:55:29.072876 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:31.865161 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.792 seconds
[0m09:55:31.867884 [debug] [ThreadPool]: On list_allianz: Close
[0m09:55:31.944986 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_allianz, now list_allianz_datavault)
[0m09:55:31.946695 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_allianz_stage'
[0m09:55:31.962154 [debug] [ThreadPool]: Using snowflake connection "list_allianz_datavault"
[0m09:55:31.963420 [debug] [ThreadPool]: Using snowflake connection "list_allianz_stage"
[0m09:55:31.963887 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_allianz_validation'
[0m09:55:31.964047 [debug] [ThreadPool]: On list_allianz_datavault: show objects in allianz.datavault
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz_datavault"} */;
[0m09:55:31.964285 [debug] [ThreadPool]: On list_allianz_stage: show objects in allianz.stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz_stage"} */;
[0m09:55:31.965524 [debug] [ThreadPool]: Using snowflake connection "list_allianz_validation"
[0m09:55:31.965683 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:55:31.965813 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:31.965944 [debug] [ThreadPool]: On list_allianz_validation: show objects in allianz.validation
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz_validation"} */;
[0m09:55:31.966828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:55:34.346477 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.380 seconds
[0m09:55:34.349314 [debug] [ThreadPool]: On list_allianz_validation: Close
[0m09:55:34.408179 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 2.442 seconds
[0m09:55:34.411876 [debug] [ThreadPool]: On list_allianz_datavault: Close
[0m09:55:34.415101 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.449 seconds
[0m09:55:34.417523 [debug] [ThreadPool]: On list_allianz_stage: Close
[0m09:55:34.516816 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ae8e92b9-a726-48fa-9e2a-8d5679e43d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107754ad0>]}
[0m09:55:34.521011 [debug] [Thread-1 (]: Began running node model.dbt_project.sat_orders_v1
[0m09:55:34.521568 [info ] [Thread-1 (]: 1 of 1 START sql incremental model datavault.sat_orders_v1 ..................... [RUN]
[0m09:55:34.521958 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_allianz_datavault, now model.dbt_project.sat_orders_v1)
[0m09:55:34.522224 [debug] [Thread-1 (]: Began compiling node model.dbt_project.sat_orders_v1
[0m09:55:34.533480 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.sat_orders_v1"
[0m09:55:34.534606 [debug] [Thread-1 (]: Began executing node model.dbt_project.sat_orders_v1
[0m09:55:34.571003 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.sat_orders_v1"
[0m09:55:34.571231 [debug] [Thread-1 (]: On model.dbt_project.sat_orders_v1: select * from (
        -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.order_hk, a.DV_HASH_DIFF, a.order_id, a.quantity, a.amount, a.DV_CREATE_DATETIME, a.DV_LOAD_DATETIME, a.DV_RECORD_SOURCE
    FROM allianz.stage.stg_sap_orders_v0 AS a
    WHERE a.order_hk IS NOT NULL
),

unique_source_records AS (
    SELECT
        sd.order_hk, sd.DV_HASH_DIFF, sd.order_id, sd.quantity, sd.amount, sd.DV_CREATE_DATETIME, sd.DV_LOAD_DATETIME, sd.DV_RECORD_SOURCE
    FROM source_data AS sd

    QUALIFY sd.DV_HASH_DIFF !=
        LAG(sd.DV_HASH_DIFF, 1, CAST('FFFFFFFF' AS BINARY(16))) OVER (
            PARTITION BY sd.order_hk
            ORDER BY sd.DV_LOAD_DATETIME ASC,
                     sd.DV_CREATE_DATETIME ASC
        )
),

records_to_insert AS (
    SELECT usr.order_hk, usr.DV_HASH_DIFF, usr.order_id, usr.quantity, usr.amount, usr.DV_CREATE_DATETIME, usr.DV_LOAD_DATETIME, usr.DV_RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v1"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v1"} */
[0m09:55:34.571373 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:55:34.938618 [debug] [Thread-1 (]: Snowflake adapter: Snowflake query id: 01bec15b-0205-1f31-0003-e9f20001d01a
[0m09:55:34.939427 [debug] [Thread-1 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 11
invalid identifier 'A.ORDER_HK'
[0m09:55:34.940064 [debug] [Thread-1 (]: On model.dbt_project.sat_orders_v1: Close
[0m09:55:35.048227 [debug] [Thread-1 (]: Database Error in model sat_orders_v1 (models/datavault/sat/sat_orders_v1.sql)
  000904 (42000): SQL compilation error: error line 7 at position 11
  invalid identifier 'A.ORDER_HK'
[0m09:55:35.051002 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'ae8e92b9-a726-48fa-9e2a-8d5679e43d65', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9043c0>]}
[0m09:55:35.051884 [error] [Thread-1 (]: 1 of 1 ERROR creating sql incremental model datavault.sat_orders_v1 ............ [[31mERROR[0m in 0.53s]
[0m09:55:35.052541 [debug] [Thread-1 (]: Finished running node model.dbt_project.sat_orders_v1
[0m09:55:35.053066 [debug] [Thread-13 ]: Marking all children of 'model.dbt_project.sat_orders_v1' to be skipped because of status 'error'.  Reason: Database Error in model sat_orders_v1 (models/datavault/sat/sat_orders_v1.sql)
  000904 (42000): SQL compilation error: error line 7 at position 11
  invalid identifier 'A.ORDER_HK'.
[0m09:55:35.055244 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:55:35.055483 [debug] [MainThread]: Connection 'model.dbt_project.sat_orders_v1' was properly closed.
[0m09:55:35.055660 [debug] [MainThread]: Connection 'list_allianz_stage' was properly closed.
[0m09:55:35.055826 [debug] [MainThread]: Connection 'list_allianz_validation' was properly closed.
[0m09:55:35.056030 [info ] [MainThread]: 
[0m09:55:35.056255 [info ] [MainThread]: Finished running 1 incremental model in 0 hours 0 minutes and 6.01 seconds (6.01s).
[0m09:55:35.056734 [debug] [MainThread]: Command end result
[0m09:55:35.089690 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/manifest.json
[0m09:55:35.090639 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/semantic_manifest.json
[0m09:55:35.093218 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/run_results.json
[0m09:55:35.093348 [info ] [MainThread]: 
[0m09:55:35.093500 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:55:35.093611 [info ] [MainThread]: 
[0m09:55:35.093756 [error] [MainThread]: [31mFailure in model sat_orders_v1 (models/datavault/sat/sat_orders_v1.sql)[0m
[0m09:55:35.093882 [error] [MainThread]:   Database Error in model sat_orders_v1 (models/datavault/sat/sat_orders_v1.sql)
  000904 (42000): SQL compilation error: error line 7 at position 11
  invalid identifier 'A.ORDER_HK'
[0m09:55:35.093979 [info ] [MainThread]: 
[0m09:55:35.094093 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/datavault/sat/sat_orders_v1.sql
[0m09:55:35.094184 [info ] [MainThread]: 
[0m09:55:35.094305 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=1
[0m09:55:35.096023 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.22384, "process_in_blocks": "0", "process_kernel_time": 0.230778, "process_mem_max_rss": "181633024", "process_out_blocks": "0", "process_user_time": 1.868941}
[0m09:55:35.096204 [debug] [MainThread]: Command `dbt run` failed at 09:55:35.096170 after 7.22 seconds
[0m09:55:35.096343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d5a28f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d7c2060>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076c8950>]}
[0m09:55:35.096467 [debug] [MainThread]: Flushing usage events
[0m09:55:35.553245 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:58:07.052037 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1056e3620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bff9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bffb10>]}


============================== 09:58:07.053697 | e77121cf-e499-43f8-9e51-925a51858248 ==============================
[0m09:58:07.053697 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:58:07.053935 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'version_check': 'True', 'cache_selected_only': 'False', 'log_path': '/Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/logs', 'write_json': 'True', 'warn_error': 'None', 'use_colors': 'True', 'fail_fast': 'False', 'no_print': 'None', 'use_experimental_parser': 'False', 'quiet': 'False', 'introspect': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'static_parser': 'True', 'profiles_dir': '/Users/vijaypalanichamy/.dbt', 'partial_parse': 'True', 'indirect_selection': 'eager', 'send_anonymous_usage_stats': 'True', 'log_format': 'default', 'printer_width': '80', 'invocation_command': 'dbt run --select +sat_orders_v1', 'target_path': 'None', 'debug': 'False'}
[0m09:58:07.203551 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'e77121cf-e499-43f8-9e51-925a51858248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f17230>]}
[0m09:58:07.223291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'e77121cf-e499-43f8-9e51-925a51858248', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076fb9b0>]}
[0m09:58:07.223665 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m09:58:07.262380 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m09:58:07.316755 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m09:58:07.317078 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/staging/stg_sap_orders_v1.yaml
[0m09:58:07.317190 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/staging/stg_sap_orders_v1.sql
[0m09:58:07.317324 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/datavault/sat/sat_orders_v1.sql
[0m09:58:07.440149 [error] [MainThread]: Encountered an error:
Compilation Error
  dbt found two schema.yml entries for the same resource named stg_sap_orders_v0. Resources and their associated columns may only be described a single time. To fix this, remove the resource entry for stg_sap_orders_v0 in one of these files:
   - models/staging/stg_sap_orders_v1.yaml
  models/staging/stg_sap_orders_v0.yaml
[0m09:58:07.441335 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 0.41256642, "process_in_blocks": "0", "process_kernel_time": 0.103932, "process_mem_max_rss": "145686528", "process_out_blocks": "0", "process_user_time": 0.771511}
[0m09:58:07.441522 [debug] [MainThread]: Command `dbt run` failed at 09:58:07.441485 after 0.41 seconds
[0m09:58:07.441661 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb6750>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107eb6850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108b558b0>]}
[0m09:58:07.441777 [debug] [MainThread]: Flushing usage events
[0m09:58:07.933434 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m09:58:47.821559 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1035bf620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104adb9d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104adbb10>]}


============================== 09:58:47.823206 | 15f1b5cc-08e9-47be-8c6d-41da894bc873 ==============================
[0m09:58:47.823206 [info ] [MainThread]: Running with dbt=1.10.9
[0m09:58:47.823446 [debug] [MainThread]: running dbt with arguments {'use_colors': 'True', 'debug': 'False', 'quiet': 'False', 'target_path': 'None', 'use_experimental_parser': 'False', 'log_path': '/Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/logs', 'invocation_command': 'dbt run --select +sat_orders_v1', 'introspect': 'True', 'fail_fast': 'False', 'profiles_dir': '/Users/vijaypalanichamy/.dbt', 'log_cache_events': 'False', 'warn_error': 'None', 'printer_width': '80', 'static_parser': 'True', 'cache_selected_only': 'False', 'version_check': 'True', 'send_anonymous_usage_stats': 'True', 'partial_parse': 'True', 'write_json': 'True', 'log_format': 'default', 'indirect_selection': 'eager', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'no_print': 'None'}
[0m09:58:47.967856 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '15f1b5cc-08e9-47be-8c6d-41da894bc873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103df3230>]}
[0m09:58:47.986774 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '15f1b5cc-08e9-47be-8c6d-41da894bc873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055d79b0>]}
[0m09:58:47.987074 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m09:58:48.025940 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m09:58:48.077370 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 2 files added, 1 files changed.
[0m09:58:48.077658 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/staging/stg_sap_orders_v1.yaml
[0m09:58:48.077770 [debug] [MainThread]: Partial parsing: added file: dbt_project://models/staging/stg_sap_orders_v1.sql
[0m09:58:48.077893 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/datavault/sat/sat_orders_v1.sql
[0m09:58:48.248073 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '15f1b5cc-08e9-47be-8c6d-41da894bc873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d6ef50>]}
[0m09:58:48.286813 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/manifest.json
[0m09:58:48.287703 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/semantic_manifest.json
[0m09:58:48.293642 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '15f1b5cc-08e9-47be-8c6d-41da894bc873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105aa4410>]}
[0m09:58:48.293804 [info ] [MainThread]: Found 17 models, 34 data tests, 3 sources, 866 macros
[0m09:58:48.293926 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15f1b5cc-08e9-47be-8c6d-41da894bc873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b290f0>]}
[0m09:58:48.294661 [info ] [MainThread]: 
[0m09:58:48.294780 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m09:58:48.294866 [info ] [MainThread]: 
[0m09:58:48.295026 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m09:58:48.296500 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_allianz'
[0m09:58:48.301420 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_allianz'
[0m09:58:48.314972 [debug] [ThreadPool]: Using snowflake connection "list_allianz"
[0m09:58:48.315182 [debug] [ThreadPool]: Using snowflake connection "list_allianz"
[0m09:58:48.315291 [debug] [ThreadPool]: On list_allianz: show terse schemas in database allianz
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz"} */
[0m09:58:48.315405 [debug] [ThreadPool]: On list_allianz: show terse schemas in database allianz
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz"} */
[0m09:58:48.315504 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:48.315592 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:50.971883 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.656 seconds
[0m09:58:50.974709 [debug] [ThreadPool]: On list_allianz: Close
[0m09:58:50.975244 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.660 seconds
[0m09:58:50.978023 [debug] [ThreadPool]: On list_allianz: Close
[0m09:58:51.067065 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_allianz, now list_allianz_stage)
[0m09:58:51.067943 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_allianz, now list_allianz_datavault)
[0m09:58:51.073538 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_allianz_validation'
[0m09:58:51.090594 [debug] [ThreadPool]: Using snowflake connection "list_allianz_datavault"
[0m09:58:51.091210 [debug] [ThreadPool]: Using snowflake connection "list_allianz_stage"
[0m09:58:51.092948 [debug] [ThreadPool]: Using snowflake connection "list_allianz_validation"
[0m09:58:51.093170 [debug] [ThreadPool]: On list_allianz_datavault: show objects in allianz.datavault
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz_datavault"} */;
[0m09:58:51.093346 [debug] [ThreadPool]: On list_allianz_stage: show objects in allianz.stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz_stage"} */;
[0m09:58:51.093506 [debug] [ThreadPool]: On list_allianz_validation: show objects in allianz.validation
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz_validation"} */;
[0m09:58:51.093659 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:58:51.093804 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m09:58:51.093937 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m09:58:53.467788 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 2.374 seconds
[0m09:58:53.471691 [debug] [ThreadPool]: On list_allianz_datavault: Close
[0m09:58:53.474495 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 2.381 seconds
[0m09:58:53.476507 [debug] [ThreadPool]: On list_allianz_validation: Close
[0m09:58:53.477315 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 2.383 seconds
[0m09:58:53.480149 [debug] [ThreadPool]: On list_allianz_stage: Close
[0m09:58:53.586107 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '15f1b5cc-08e9-47be-8c6d-41da894bc873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c007380>]}
[0m09:58:53.589271 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_sap_orders_v1
[0m09:58:53.589864 [info ] [Thread-1 (]: 1 of 2 START sql table model stage.stg_sap_orders_v1 ........................... [RUN]
[0m09:58:53.590268 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_allianz_stage, now model.dbt_project.stg_sap_orders_v1)
[0m09:58:53.590544 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_sap_orders_v1
[0m09:58:53.597606 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_sap_orders_v1"
[0m09:58:53.598458 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_sap_orders_v1
[0m09:58:53.626694 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.stg_sap_orders_v1"
[0m09:58:53.626979 [debug] [Thread-1 (]: On model.dbt_project.stg_sap_orders_v1: select * from (
        

with source_data as (
    select 
        ORDERID as order_id
        , CUSTOMERID as customer_id
        , PRODUCTID as product_id
        , QTY as quantity
        , ORDERVALES as amount
        , source
        , SYSDATE() as stg_load_ts
        , CAST(SHA2_BINARY(order_id) as BINARY(32)) as order_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(source || order_id || quantity || amount) as BINARY(32)) as DV_HASH_DIFF
    from 
        ALLIANZ.SOURCE.SAP_ORDERS
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.stg_sap_orders_v1"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.stg_sap_orders_v1"} */
[0m09:58:53.627137 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m09:58:54.678817 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 1.051 seconds
[0m09:58:54.695150 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.stg_sap_orders_v1"
[0m09:58:54.695870 [debug] [Thread-1 (]: On model.dbt_project.stg_sap_orders_v1: select * from (
        select
    
      
    cast(null as integer)
     as order_id, 
      
    cast(null as integer)
     as customer_id, 
      
    cast(null as TEXT)
     as product_id, 
      
    cast(null as integer)
     as quantity, 
      
    cast(null as integer)
     as amount, 
      
    cast(null as TEXT)
     as source, 
      
    cast(null as timestamp_ntz)
     as stg_load_ts, 
      
    cast(null as binary)
     as order_hk, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE, 
      
    cast(null as binary)
     as DV_HASH_DIFF
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.stg_sap_orders_v1"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.stg_sap_orders_v1"} */
[0m09:58:55.022751 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.326 seconds
[0m09:58:55.043784 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_sap_orders_v1"
[0m09:58:55.045802 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.stg_sap_orders_v1"
[0m09:58:55.046121 [debug] [Thread-1 (]: On model.dbt_project.stg_sap_orders_v1: create or replace transient table allianz.stage.stg_sap_orders_v1
    
  (
    order_id integer,
    customer_id integer,
    product_id TEXT,
    quantity integer,
    amount integer,
    source TEXT,
    stg_load_ts timestamp_ntz,
    order_hk binary,
    DV_LOAD_DATETIME timestamp_ntz,
    DV_RECORD_SOURCE TEXT,
    DV_HASH_DIFF binary
    
    )

    
    
    
    as (
    select order_id, customer_id, product_id, quantity, amount, source, stg_load_ts, order_hk, DV_LOAD_DATETIME, DV_RECORD_SOURCE, DV_HASH_DIFF
    from (
        

with source_data as (
    select 
        ORDERID as order_id
        , CUSTOMERID as customer_id
        , PRODUCTID as product_id
        , QTY as quantity
        , ORDERVALES as amount
        , source
        , SYSDATE() as stg_load_ts
        , CAST(SHA2_BINARY(order_id) as BINARY(32)) as order_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(source || order_id || quantity || amount) as BINARY(32)) as DV_HASH_DIFF
    from 
        ALLIANZ.SOURCE.SAP_ORDERS
)

select * from source_data
    ) as model_subq
    )

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.stg_sap_orders_v1"} */;
[0m09:58:56.217220 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.170 seconds
[0m09:58:56.241460 [debug] [Thread-1 (]: On model.dbt_project.stg_sap_orders_v1: Close
[0m09:58:56.326560 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15f1b5cc-08e9-47be-8c6d-41da894bc873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c697ad0>]}
[0m09:58:56.327724 [info ] [Thread-1 (]: 1 of 2 OK created sql table model stage.stg_sap_orders_v1 ...................... [[32mSUCCESS 1[0m in 2.73s]
[0m09:58:56.328426 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_sap_orders_v1
[0m09:58:56.329311 [debug] [Thread-2 (]: Began running node model.dbt_project.sat_orders_v1
[0m09:58:56.329803 [info ] [Thread-2 (]: 2 of 2 START sql incremental model datavault.sat_orders_v1 ..................... [RUN]
[0m09:58:56.330487 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_allianz_datavault, now model.dbt_project.sat_orders_v1)
[0m09:58:56.330899 [debug] [Thread-2 (]: Began compiling node model.dbt_project.sat_orders_v1
[0m09:58:56.341746 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.sat_orders_v1"
[0m09:58:56.342475 [debug] [Thread-2 (]: Began executing node model.dbt_project.sat_orders_v1
[0m09:58:56.367800 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_orders_v1"
[0m09:58:56.368095 [debug] [Thread-2 (]: On model.dbt_project.sat_orders_v1: select * from (
        -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.order_hk, a.DV_HASH_DIFF, a.order_id, a.quantity, a.amount, a.DV_CREATE_DATETIME, a.DV_LOAD_DATETIME, a.DV_RECORD_SOURCE
    FROM allianz.stage.stg_sap_orders_v1 AS a
    WHERE a.order_hk IS NOT NULL
),

unique_source_records AS (
    SELECT
        sd.order_hk, sd.DV_HASH_DIFF, sd.order_id, sd.quantity, sd.amount, sd.DV_CREATE_DATETIME, sd.DV_LOAD_DATETIME, sd.DV_RECORD_SOURCE
    FROM source_data AS sd

    QUALIFY sd.DV_HASH_DIFF !=
        LAG(sd.DV_HASH_DIFF, 1, CAST('FFFFFFFF' AS BINARY(16))) OVER (
            PARTITION BY sd.order_hk
            ORDER BY sd.DV_LOAD_DATETIME ASC,
                     sd.DV_CREATE_DATETIME ASC
        )
),

records_to_insert AS (
    SELECT usr.order_hk, usr.DV_HASH_DIFF, usr.order_id, usr.quantity, usr.amount, usr.DV_CREATE_DATETIME, usr.DV_LOAD_DATETIME, usr.DV_RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v1"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v1"} */
[0m09:58:56.368291 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m09:58:56.675697 [debug] [Thread-2 (]: Snowflake adapter: Snowflake query id: 01bec15e-0205-188c-0003-e9f20001f01e
[0m09:58:56.676517 [debug] [Thread-2 (]: Snowflake adapter: Snowflake error: 000904 (42000): SQL compilation error: error line 7 at position 73
invalid identifier 'A.DV_CREATE_DATETIME'
[0m09:58:56.677221 [debug] [Thread-2 (]: On model.dbt_project.sat_orders_v1: Close
[0m09:58:56.780489 [debug] [Thread-2 (]: Database Error in model sat_orders_v1 (models/datavault/sat/sat_orders_v1.sql)
  000904 (42000): SQL compilation error: error line 7 at position 73
  invalid identifier 'A.DV_CREATE_DATETIME'
[0m09:58:56.781479 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15f1b5cc-08e9-47be-8c6d-41da894bc873', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c351d30>]}
[0m09:58:56.782287 [error] [Thread-2 (]: 2 of 2 ERROR creating sql incremental model datavault.sat_orders_v1 ............ [[31mERROR[0m in 0.45s]
[0m09:58:56.782783 [debug] [Thread-2 (]: Finished running node model.dbt_project.sat_orders_v1
[0m09:58:56.783392 [debug] [Thread-13 ]: Marking all children of 'model.dbt_project.sat_orders_v1' to be skipped because of status 'error'.  Reason: Database Error in model sat_orders_v1 (models/datavault/sat/sat_orders_v1.sql)
  000904 (42000): SQL compilation error: error line 7 at position 73
  invalid identifier 'A.DV_CREATE_DATETIME'.
[0m09:58:56.786007 [debug] [MainThread]: Connection 'master' was properly closed.
[0m09:58:56.786411 [debug] [MainThread]: Connection 'model.dbt_project.stg_sap_orders_v1' was properly closed.
[0m09:58:56.786662 [debug] [MainThread]: Connection 'model.dbt_project.sat_orders_v1' was properly closed.
[0m09:58:56.786878 [debug] [MainThread]: Connection 'list_allianz_validation' was properly closed.
[0m09:58:56.787136 [info ] [MainThread]: 
[0m09:58:56.787400 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 8.49 seconds (8.49s).
[0m09:58:56.788242 [debug] [MainThread]: Command end result
[0m09:58:56.822144 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/manifest.json
[0m09:58:56.823175 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/semantic_manifest.json
[0m09:58:56.825759 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/run_results.json
[0m09:58:56.825888 [info ] [MainThread]: 
[0m09:58:56.826037 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m09:58:56.826156 [info ] [MainThread]: 
[0m09:58:56.826307 [error] [MainThread]: [31mFailure in model sat_orders_v1 (models/datavault/sat/sat_orders_v1.sql)[0m
[0m09:58:56.826441 [error] [MainThread]:   Database Error in model sat_orders_v1 (models/datavault/sat/sat_orders_v1.sql)
  000904 (42000): SQL compilation error: error line 7 at position 73
  invalid identifier 'A.DV_CREATE_DATETIME'
[0m09:58:56.826547 [info ] [MainThread]: 
[0m09:58:56.826670 [info ] [MainThread]:   compiled code at target/compiled/dbt_project/models/datavault/sat/sat_orders_v1.sql
[0m09:58:56.826769 [info ] [MainThread]: 
[0m09:58:56.826882 [info ] [MainThread]: Done. PASS=1 WARN=0 ERROR=1 SKIP=0 NO-OP=0 TOTAL=2
[0m09:58:56.828103 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 9.029793, "process_in_blocks": "0", "process_kernel_time": 0.230164, "process_mem_max_rss": "190676992", "process_out_blocks": "0", "process_user_time": 1.5064}
[0m09:58:56.828287 [debug] [MainThread]: Command `dbt run` failed at 09:58:56.828249 after 9.03 seconds
[0m09:58:56.828435 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106fee490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cea7380>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b765d0>]}
[0m09:58:56.828571 [debug] [MainThread]: Flushing usage events
[0m09:58:57.286344 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m10:00:56.339010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1100fb620>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c279d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111c27b10>]}


============================== 10:00:56.340668 | fb1148ac-6005-47ad-b0be-cd1c85e4b1e8 ==============================
[0m10:00:56.340668 [info ] [MainThread]: Running with dbt=1.10.9
[0m10:00:56.340899 [debug] [MainThread]: running dbt with arguments {'log_cache_events': 'False', 'debug': 'False', 'send_anonymous_usage_stats': 'True', 'target_path': 'None', 'log_format': 'default', 'use_colors': 'True', 'no_print': 'None', 'profiles_dir': '/Users/vijaypalanichamy/.dbt', 'partial_parse': 'True', 'version_check': 'True', 'warn_error': 'None', 'quiet': 'False', 'fail_fast': 'False', 'use_experimental_parser': 'False', 'indirect_selection': 'eager', 'static_parser': 'True', 'invocation_command': 'dbt run --select +sat_orders_v1', 'printer_width': '80', 'log_path': '/Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/logs', 'introspect': 'True', 'write_json': 'True', 'warn_error_options': 'WarnErrorOptionsV2(error=[], warn=[], silence=[])', 'empty': 'False', 'cache_selected_only': 'False'}
[0m10:00:56.488193 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fb1148ac-6005-47ad-b0be-cd1c85e4b1e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110b3f230>]}
[0m10:00:56.506660 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fb1148ac-6005-47ad-b0be-cd1c85e4b1e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1131ef9b0>]}
[0m10:00:56.506970 [info ] [MainThread]: Registered adapter: snowflake=1.10.0
[0m10:00:56.546440 [debug] [MainThread]: checksum: 6543b8b248ceda473ef0d611849d5d909085b6b714afa9b515e9635faea7af23, vars: {}, profile: , target: , version: 1.10.9
[0m10:00:56.600895 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 3 files changed.
[0m10:00:56.601237 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/staging/stg_sap_orders_v1.yaml
[0m10:00:56.601388 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/datavault/sat/sat_orders_v1.sql
[0m10:00:56.601487 [debug] [MainThread]: Partial parsing: updated file: dbt_project://models/staging/stg_sap_orders_v1.sql
[0m10:00:56.771008 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fb1148ac-6005-47ad-b0be-cd1c85e4b1e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113b92450>]}
[0m10:00:56.808353 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/manifest.json
[0m10:00:56.809188 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/semantic_manifest.json
[0m10:00:56.815182 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fb1148ac-6005-47ad-b0be-cd1c85e4b1e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1138c4410>]}
[0m10:00:56.815345 [info ] [MainThread]: Found 17 models, 34 data tests, 3 sources, 866 macros
[0m10:00:56.815461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb1148ac-6005-47ad-b0be-cd1c85e4b1e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114da2350>]}
[0m10:00:56.816212 [info ] [MainThread]: 
[0m10:00:56.816330 [info ] [MainThread]: Concurrency: 10 threads (target='dev')
[0m10:00:56.816415 [info ] [MainThread]: 
[0m10:00:56.816575 [debug] [MainThread]: Acquiring new snowflake connection 'master'
[0m10:00:56.818040 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_allianz'
[0m10:00:56.822841 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_allianz'
[0m10:00:56.840109 [debug] [ThreadPool]: Using snowflake connection "list_allianz"
[0m10:00:56.840354 [debug] [ThreadPool]: Using snowflake connection "list_allianz"
[0m10:00:56.840468 [debug] [ThreadPool]: On list_allianz: show terse schemas in database allianz
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz"} */
[0m10:00:56.840581 [debug] [ThreadPool]: On list_allianz: show terse schemas in database allianz
    limit 10000
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz"} */
[0m10:00:56.840683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:00:56.840775 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:00:59.309689 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.469 seconds
[0m10:00:59.312230 [debug] [ThreadPool]: On list_allianz: Close
[0m10:00:59.424663 [debug] [ThreadPool]: SQL status: SUCCESS 6 in 2.584 seconds
[0m10:00:59.427594 [debug] [ThreadPool]: On list_allianz: Close
[0m10:00:59.533523 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_allianz, now list_allianz_datavault)
[0m10:00:59.537458 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_allianz, now list_allianz_stage)
[0m10:00:59.549060 [debug] [ThreadPool]: Using snowflake connection "list_allianz_datavault"
[0m10:00:59.549467 [debug] [ThreadPool]: Using snowflake connection "list_allianz_stage"
[0m10:00:59.549751 [debug] [ThreadPool]: Acquiring new snowflake connection 'list_allianz_validation'
[0m10:00:59.549902 [debug] [ThreadPool]: On list_allianz_datavault: show objects in allianz.datavault
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz_datavault"} */;
[0m10:00:59.550086 [debug] [ThreadPool]: On list_allianz_stage: show objects in allianz.stage
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz_stage"} */;
[0m10:00:59.551373 [debug] [ThreadPool]: Using snowflake connection "list_allianz_validation"
[0m10:00:59.551523 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:00:59.551649 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m10:00:59.551778 [debug] [ThreadPool]: On list_allianz_validation: show objects in allianz.validation
    limit 10000
    

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "connection_name": "list_allianz_validation"} */;
[0m10:00:59.553417 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m10:01:02.025861 [debug] [ThreadPool]: SQL status: SUCCESS 11 in 2.474 seconds
[0m10:01:02.029522 [debug] [ThreadPool]: On list_allianz_datavault: Close
[0m10:01:02.573262 [debug] [ThreadPool]: SQL status: SUCCESS 2 in 3.020 seconds
[0m10:01:02.577305 [debug] [ThreadPool]: On list_allianz_validation: Close
[0m10:01:02.607040 [debug] [ThreadPool]: SQL status: SUCCESS 3 in 3.055 seconds
[0m10:01:02.608829 [debug] [ThreadPool]: On list_allianz_stage: Close
[0m10:01:02.702363 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fb1148ac-6005-47ad-b0be-cd1c85e4b1e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114fae820>]}
[0m10:01:02.705565 [debug] [Thread-1 (]: Began running node model.dbt_project.stg_sap_orders_v1
[0m10:01:02.706197 [info ] [Thread-1 (]: 1 of 2 START sql table model stage.stg_sap_orders_v1 ........................... [RUN]
[0m10:01:02.706635 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_allianz_datavault, now model.dbt_project.stg_sap_orders_v1)
[0m10:01:02.706981 [debug] [Thread-1 (]: Began compiling node model.dbt_project.stg_sap_orders_v1
[0m10:01:02.716322 [debug] [Thread-1 (]: Writing injected SQL for node "model.dbt_project.stg_sap_orders_v1"
[0m10:01:02.717212 [debug] [Thread-1 (]: Began executing node model.dbt_project.stg_sap_orders_v1
[0m10:01:02.749880 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.stg_sap_orders_v1"
[0m10:01:02.750149 [debug] [Thread-1 (]: On model.dbt_project.stg_sap_orders_v1: select * from (
        

with source_data as (
    select 
        ORDERID as order_id
        , CUSTOMERID as customer_id
        , PRODUCTID as product_id
        , QTY as quantity
        , ORDERVALES as amount
        , source
        , CAST(SHA2_BINARY(order_id) as BINARY(32)) as order_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(source || order_id || quantity || amount) as BINARY(32)) as DV_HASH_DIFF
    from 
        ALLIANZ.SOURCE.SAP_ORDERS
)

select * from source_data
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.stg_sap_orders_v1"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.stg_sap_orders_v1"} */
[0m10:01:02.750314 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m10:01:03.535146 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.784 seconds
[0m10:01:03.551440 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.stg_sap_orders_v1"
[0m10:01:03.552039 [debug] [Thread-1 (]: On model.dbt_project.stg_sap_orders_v1: select * from (
        select
    
      
    cast(null as integer)
     as order_id, 
      
    cast(null as integer)
     as customer_id, 
      
    cast(null as TEXT)
     as product_id, 
      
    cast(null as integer)
     as quantity, 
      
    cast(null as integer)
     as amount, 
      
    cast(null as TEXT)
     as source, 
      
    cast(null as binary)
     as order_hk, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE, 
      
    cast(null as binary)
     as DV_HASH_DIFF
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.stg_sap_orders_v1"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.stg_sap_orders_v1"} */
[0m10:01:03.621262 [debug] [Thread-1 (]: SQL status: SUCCESS 0 in 0.069 seconds
[0m10:01:03.637647 [debug] [Thread-1 (]: Writing runtime sql for node "model.dbt_project.stg_sap_orders_v1"
[0m10:01:03.638930 [debug] [Thread-1 (]: Using snowflake connection "model.dbt_project.stg_sap_orders_v1"
[0m10:01:03.639158 [debug] [Thread-1 (]: On model.dbt_project.stg_sap_orders_v1: create or replace transient table allianz.stage.stg_sap_orders_v1
    
  (
    order_id integer,
    customer_id integer,
    product_id TEXT,
    quantity integer,
    amount integer,
    source TEXT,
    order_hk binary,
    DV_LOAD_DATETIME timestamp_ntz,
    DV_RECORD_SOURCE TEXT,
    DV_HASH_DIFF binary
    
    )

    
    
    
    as (
    select order_id, customer_id, product_id, quantity, amount, source, order_hk, DV_LOAD_DATETIME, DV_RECORD_SOURCE, DV_HASH_DIFF
    from (
        

with source_data as (
    select 
        ORDERID as order_id
        , CUSTOMERID as customer_id
        , PRODUCTID as product_id
        , QTY as quantity
        , ORDERVALES as amount
        , source
        , CAST(SHA2_BINARY(order_id) as BINARY(32)) as order_hk
        , SYSDATE() as DV_LOAD_DATETIME
        , source as DV_RECORD_SOURCE
        , CAST(SHA2_BINARY(source || order_id || quantity || amount) as BINARY(32)) as DV_HASH_DIFF
    from 
        ALLIANZ.SOURCE.SAP_ORDERS
)

select * from source_data
    ) as model_subq
    )

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.stg_sap_orders_v1"} */;
[0m10:01:04.970024 [debug] [Thread-1 (]: SQL status: SUCCESS 1 in 1.331 seconds
[0m10:01:04.980496 [debug] [Thread-1 (]: On model.dbt_project.stg_sap_orders_v1: Close
[0m10:01:05.084366 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb1148ac-6005-47ad-b0be-cd1c85e4b1e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117056210>]}
[0m10:01:05.084817 [info ] [Thread-1 (]: 1 of 2 OK created sql table model stage.stg_sap_orders_v1 ...................... [[32mSUCCESS 1[0m in 2.38s]
[0m10:01:05.085415 [debug] [Thread-1 (]: Finished running node model.dbt_project.stg_sap_orders_v1
[0m10:01:05.086091 [debug] [Thread-2 (]: Began running node model.dbt_project.sat_orders_v1
[0m10:01:05.086560 [info ] [Thread-2 (]: 2 of 2 START sql incremental model datavault.sat_orders_v1 ..................... [RUN]
[0m10:01:05.086992 [debug] [Thread-2 (]: Re-using an available connection from the pool (formerly list_allianz_stage, now model.dbt_project.sat_orders_v1)
[0m10:01:05.087283 [debug] [Thread-2 (]: Began compiling node model.dbt_project.sat_orders_v1
[0m10:01:05.095613 [debug] [Thread-2 (]: Writing injected SQL for node "model.dbt_project.sat_orders_v1"
[0m10:01:05.096393 [debug] [Thread-2 (]: Began executing node model.dbt_project.sat_orders_v1
[0m10:01:05.116216 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_orders_v1"
[0m10:01:05.116484 [debug] [Thread-2 (]: On model.dbt_project.sat_orders_v1: select * from (
        -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.order_hk, a.DV_HASH_DIFF, a.order_id, a.quantity, a.amount, a.DV_LOAD_DATETIME, a.DV_RECORD_SOURCE
    FROM allianz.stage.stg_sap_orders_v1 AS a
    WHERE a.order_hk IS NOT NULL
),

unique_source_records AS (
    SELECT
        sd.order_hk, sd.DV_HASH_DIFF, sd.order_id, sd.quantity, sd.amount, sd.DV_LOAD_DATETIME, sd.DV_RECORD_SOURCE
    FROM source_data AS sd

    QUALIFY sd.DV_HASH_DIFF !=
        LAG(sd.DV_HASH_DIFF, 1, CAST('FFFFFFFF' AS BINARY(16))) OVER (
            PARTITION BY sd.order_hk
            ORDER BY sd.DV_LOAD_DATETIME ASC,
                     sd.DV_LOAD_DATETIME ASC
        )
),

records_to_insert AS (
    SELECT usr.order_hk, usr.DV_HASH_DIFF, usr.order_id, usr.quantity, usr.amount, usr.DV_LOAD_DATETIME, usr.DV_RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v1"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v1"} */
[0m10:01:05.116621 [debug] [Thread-2 (]: Opening a new connection, currently in state closed
[0m10:01:05.994825 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.878 seconds
[0m10:01:05.998900 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_orders_v1"
[0m10:01:05.999417 [debug] [Thread-2 (]: On model.dbt_project.sat_orders_v1: select * from (
        select
    
      
    cast(null as binary)
     as order_hk, 
      
    cast(null as timestamp_ntz)
     as DV_LOAD_DATETIME, 
      
    cast(null as TEXT)
     as DV_RECORD_SOURCE, 
      
    cast(null as binary)
     as DV_HASH_DIFF, 
      
    cast(null as integer)
     as order_id, 
      
    cast(null as integer)
     as quantity, 
      
    cast(null as integer)
     as amount
    ) as __dbt_sbq
    where false
    limit 0
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v1"} */
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v1"} */
[0m10:01:06.056565 [debug] [Thread-2 (]: SQL status: SUCCESS 0 in 0.057 seconds
[0m10:01:06.060154 [debug] [Thread-2 (]: Writing runtime sql for node "model.dbt_project.sat_orders_v1"
[0m10:01:06.063209 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_orders_v1"
[0m10:01:06.063619 [debug] [Thread-2 (]: On model.dbt_project.sat_orders_v1: create or replace transient table allianz.datavault.sat_orders_v1
    
  (
    order_hk binary,
    DV_LOAD_DATETIME timestamp_ntz,
    DV_RECORD_SOURCE TEXT,
    DV_HASH_DIFF binary,
    order_id integer,
    quantity integer,
    amount integer
    
    )

    
    
    
    as (
    select order_hk, DV_LOAD_DATETIME, DV_RECORD_SOURCE, DV_HASH_DIFF, order_id, quantity, amount
    from (
        -- Generated by AutomateDV (formerly known as dbtvault)

    

WITH source_data AS (
    SELECT a.order_hk, a.DV_HASH_DIFF, a.order_id, a.quantity, a.amount, a.DV_LOAD_DATETIME, a.DV_RECORD_SOURCE
    FROM allianz.stage.stg_sap_orders_v1 AS a
    WHERE a.order_hk IS NOT NULL
),

unique_source_records AS (
    SELECT
        sd.order_hk, sd.DV_HASH_DIFF, sd.order_id, sd.quantity, sd.amount, sd.DV_LOAD_DATETIME, sd.DV_RECORD_SOURCE
    FROM source_data AS sd

    QUALIFY sd.DV_HASH_DIFF !=
        LAG(sd.DV_HASH_DIFF, 1, CAST('FFFFFFFF' AS BINARY(16))) OVER (
            PARTITION BY sd.order_hk
            ORDER BY sd.DV_LOAD_DATETIME ASC,
                     sd.DV_LOAD_DATETIME ASC
        )
),

records_to_insert AS (
    SELECT usr.order_hk, usr.DV_HASH_DIFF, usr.order_id, usr.quantity, usr.amount, usr.DV_LOAD_DATETIME, usr.DV_RECORD_SOURCE
    FROM unique_source_records AS usr
)

SELECT * FROM records_to_insert
    ) as model_subq
    )

/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v1"} */;
[0m10:01:07.106890 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 1.043 seconds
[0m10:01:07.117436 [debug] [Thread-2 (]: Applying DROP to: allianz.datavault.sat_orders_v1__dbt_tmp
[0m10:01:07.124208 [debug] [Thread-2 (]: Using snowflake connection "model.dbt_project.sat_orders_v1"
[0m10:01:07.124586 [debug] [Thread-2 (]: On model.dbt_project.sat_orders_v1: drop view if exists allianz.datavault.sat_orders_v1__dbt_tmp cascade
/* {"app": "dbt", "dbt_version": "1.10.9", "profile_name": "allianz_dbt_assignment", "target_name": "dev", "node_id": "model.dbt_project.sat_orders_v1"} */
[0m10:01:07.244674 [debug] [Thread-2 (]: SQL status: SUCCESS 1 in 0.120 seconds
[0m10:01:07.249170 [debug] [Thread-2 (]: On model.dbt_project.sat_orders_v1: Close
[0m10:01:07.327914 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fb1148ac-6005-47ad-b0be-cd1c85e4b1e8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116643e30>]}
[0m10:01:07.329760 [info ] [Thread-2 (]: 2 of 2 OK created sql incremental model datavault.sat_orders_v1 ................ [[32mSUCCESS 1[0m in 2.24s]
[0m10:01:07.330642 [debug] [Thread-2 (]: Finished running node model.dbt_project.sat_orders_v1
[0m10:01:07.331957 [debug] [MainThread]: Connection 'master' was properly closed.
[0m10:01:07.332159 [debug] [MainThread]: Connection 'model.dbt_project.stg_sap_orders_v1' was properly closed.
[0m10:01:07.332313 [debug] [MainThread]: Connection 'model.dbt_project.sat_orders_v1' was properly closed.
[0m10:01:07.332451 [debug] [MainThread]: Connection 'list_allianz_validation' was properly closed.
[0m10:01:07.332635 [info ] [MainThread]: 
[0m10:01:07.332850 [info ] [MainThread]: Finished running 1 incremental model, 1 table model in 0 hours 0 minutes and 10.52 seconds (10.52s).
[0m10:01:07.333400 [debug] [MainThread]: Command end result
[0m10:01:07.363230 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/manifest.json
[0m10:01:07.364200 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/semantic_manifest.json
[0m10:01:07.366908 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/vijaypalanichamy/Documents/GitHub/Projects/Allianz/4_dbt_project/target/run_results.json
[0m10:01:07.367059 [info ] [MainThread]: 
[0m10:01:07.367223 [info ] [MainThread]: [32mCompleted successfully[0m
[0m10:01:07.367334 [info ] [MainThread]: 
[0m10:01:07.367454 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 NO-OP=0 TOTAL=2
[0m10:01:07.368896 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 11.054022, "process_in_blocks": "0", "process_kernel_time": 0.24979, "process_mem_max_rss": "191823872", "process_out_blocks": "0", "process_user_time": 1.526672}
[0m10:01:07.369099 [debug] [MainThread]: Command `dbt run` succeeded at 10:01:07.369060 after 11.05 seconds
[0m10:01:07.369252 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11687e0d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1161e1d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1139066d0>]}
[0m10:01:07.369393 [debug] [MainThread]: Flushing usage events
[0m10:01:07.833273 [debug] [MainThread]: An error was encountered while trying to flush usage events
